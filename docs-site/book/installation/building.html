<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Building from Source - MIDIMon Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Transform MIDI controllers into advanced macro pads with RGB feedback and timing-based triggers">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">MIDIMon Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/amiable-dev/midimon" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/amiable-dev/midimon/edit/main/docs-site/src/src/installation/building.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="building-midimon-from-source"><a class="header" href="#building-midimon-from-source">Building MIDIMon from Source</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>This guide covers building MIDIMon from source code on any supported platform. Whether you're developing new features, customizing behavior, or just want to run the latest code, this guide walks through the complete build process.</p>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<h3 id="rust-toolchain"><a class="header" href="#rust-toolchain">Rust Toolchain</a></h3>
<p>MIDIMon requires Rust 1.70.0 or later.</p>
<h4 id="installing-rust"><a class="header" href="#installing-rust">Installing Rust</a></h4>
<p>The recommended way to install Rust is via <strong>rustup</strong>, the official Rust toolchain installer:</p>
<pre><code class="language-bash"># macOS/Linux
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Windows (PowerShell)
# Download and run: https://win.rustup.rs/
</code></pre>
<p>Follow the installation prompts. The installer will:</p>
<ol>
<li>Install <code>rustc</code> (Rust compiler)</li>
<li>Install <code>cargo</code> (Rust package manager and build tool)</li>
<li>Configure your shell environment</li>
</ol>
<p><strong>After installation</strong>, reload your shell:</p>
<pre><code class="language-bash"># macOS/Linux
source $HOME/.cargo/env

# Windows: Close and reopen terminal
</code></pre>
<p><strong>Verify installation</strong>:</p>
<pre><code class="language-bash">rustc --version  # Should show: rustc 1.75.0 (or later)
cargo --version  # Should show: cargo 1.75.0 (or later)
</code></pre>
<h4 id="updating-rust"><a class="header" href="#updating-rust">Updating Rust</a></h4>
<p>Keep your toolchain up to date:</p>
<pre><code class="language-bash">rustup update
</code></pre>
<h2 id="workspace-architecture-v020"><a class="header" href="#workspace-architecture-v020">Workspace Architecture (v0.2.0+)</a></h2>
<p>MIDIMon uses a <strong>Cargo workspace</strong> with three packages since v0.2.0:</p>
<h3 id="package-structure"><a class="header" href="#package-structure">Package Structure</a></h3>
<ol>
<li>
<p><strong>midimon-core</strong> - Pure Rust engine library</p>
<ul>
<li>Zero UI dependencies (no colored output, pure logic)</li>
<li>Public API for embedding in other applications</li>
<li>30+ public types exported</li>
<li>Event processing, mapping engine, action execution</li>
</ul>
</li>
<li>
<p><strong>midimon-daemon</strong> - CLI daemon + diagnostic tools</p>
<ul>
<li>Main <code>midimon</code> binary (daemon service)</li>
<li><code>midimonctl</code> - CLI control tool (v1.0.0+)</li>
<li>6 diagnostic binaries:
<ul>
<li><code>midi_diagnostic</code> - MIDI event viewer</li>
<li><code>led_diagnostic</code> - LED testing tool</li>
<li><code>led_tester</code> - Interactive LED control</li>
<li><code>pad_mapper</code> - Note number mapper</li>
<li><code>test_midi</code> - Port connectivity test</li>
<li><code>midi_simulator</code> - MIDI event simulator (testing)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>midimon</strong> (root) - Backward compatibility layer</p>
<ul>
<li>Re-exports midimon-core types</li>
<li>For existing v0.1.0 tests only</li>
<li>New code should use midimon-core directly</li>
</ul>
</li>
</ol>
<h3 id="when-to-use-each-package"><a class="header" href="#when-to-use-each-package">When to Use Each Package</a></h3>
<ul>
<li><strong>Use midimon-core</strong>: Embed MIDIMon in your application</li>
<li><strong>Use midimon-daemon</strong>: Run as standalone CLI/daemon</li>
<li><strong>Use midimon (root)</strong>: Only for backward compatibility</li>
</ul>
<h3 id="public-api-example"><a class="header" href="#public-api-example">Public API Example</a></h3>
<pre><code class="language-rust">use midimon_core::{Config, MappingEngine, EventProcessor, ActionExecutor};

let config = Config::load("config.toml")?;
let mut engine = MappingEngine::new();
// Process events, execute actions...</code></pre>
<h3 id="platform-specific-dependencies"><a class="header" href="#platform-specific-dependencies">Platform-Specific Dependencies</a></h3>
<h4 id="macos"><a class="header" href="#macos">macOS</a></h4>
<p><strong>Required</strong>:</p>
<ul>
<li><strong>Xcode Command Line Tools</strong>: Provides compilers and linkers
<pre><code class="language-bash">xcode-select --install
</code></pre>
</li>
</ul>
<p><strong>Optional (for Maschine Mikro MK3)</strong>:</p>
<ul>
<li><strong>Native Instruments Drivers</strong>: Required for HID/LED support
<ul>
<li>Download from <a href="https://www.native-instruments.com/en/support/downloads/">Native Instruments</a></li>
<li>Install via Native Access</li>
</ul>
</li>
</ul>
<p><strong>Verify</strong>:</p>
<pre><code class="language-bash"># Check compiler
clang --version

# Check USB device (if connected)
system_profiler SPUSBDataType | grep -i mikro
</code></pre>
<h4 id="linux-ubuntudebian"><a class="header" href="#linux-ubuntudebian">Linux (Ubuntu/Debian)</a></h4>
<p><strong>Required</strong>:</p>
<pre><code class="language-bash">sudo apt update
sudo apt install -y \
    build-essential \
    pkg-config \
    libasound2-dev \
    libudev-dev \
    libusb-1.0-0-dev
</code></pre>
<p><strong>For Fedora/RHEL</strong>:</p>
<pre><code class="language-bash">sudo dnf install -y \
    gcc \
    pkg-config \
    alsa-lib-devel \
    systemd-devel \
    libusbx-devel
</code></pre>
<p><strong>For Arch Linux</strong>:</p>
<pre><code class="language-bash">sudo pacman -S base-devel alsa-lib systemd-libs libusb
</code></pre>
<p><strong>udev rules</strong> (for HID access without sudo):</p>
<p>Create <code>/etc/udev/rules.d/50-midimon.rules</code>:</p>
<pre><code class="language-bash">sudo tee /etc/udev/rules.d/50-midimon.rules &lt;&lt; 'EOF'
# Native Instruments Maschine Mikro MK3
SUBSYSTEM=="usb", ATTRS{idVendor}=="17cc", ATTRS{idProduct}=="1600", MODE="0666", GROUP="plugdev"

# Generic MIDI devices
SUBSYSTEM=="usb", ATTRS{bInterfaceClass}=="01", ATTRS{bInterfaceSubClass}=="03", MODE="0666", GROUP="plugdev"
EOF

sudo udevadm control --reload-rules
sudo udevadm trigger
</code></pre>
<p>Add your user to the <code>plugdev</code> group:</p>
<pre><code class="language-bash">sudo usermod -a -G plugdev $USER
# Log out and back in for changes to take effect
</code></pre>
<h4 id="windows"><a class="header" href="#windows">Windows</a></h4>
<p><strong>Required</strong>:</p>
<ul>
<li>
<p><strong>Microsoft C++ Build Tools</strong>: For compiling native dependencies</p>
<ul>
<li>Download: <a href="https://visualstudio.microsoft.com/downloads/">Visual Studio Build Tools</a></li>
<li>Install "Desktop development with C++" workload</li>
</ul>
<p>OR</p>
<ul>
<li>Full Visual Studio (Community edition is free)</li>
</ul>
</li>
</ul>
<p><strong>Optional</strong>:</p>
<ul>
<li><strong>Native Instruments Drivers</strong>: For Maschine Mikro MK3 support
<ul>
<li>Download from <a href="https://www.native-instruments.com/en/support/downloads/">Native Instruments</a></li>
<li>Install via Native Access</li>
</ul>
</li>
</ul>
<p><strong>Verify</strong>:</p>
<pre><code class="language-powershell"># Check MSVC compiler
where cl

# Check Rust
rustc --version
cargo --version
</code></pre>
<h2 id="cloning-the-repository"><a class="header" href="#cloning-the-repository">Cloning the Repository</a></h2>
<h3 id="via-git"><a class="header" href="#via-git">Via Git</a></h3>
<pre><code class="language-bash"># HTTPS (recommended for most users)
git clone https://github.com/yourusername/midimon.git
cd midimon

# SSH (if you have SSH keys configured)
git clone git@github.com:yourusername/midimon.git
cd midimon
</code></pre>
<h3 id="verify-repository-contents"><a class="header" href="#verify-repository-contents">Verify Repository Contents</a></h3>
<pre><code class="language-bash">ls -la

# Expected files/directories:
# - Cargo.toml     (Rust project manifest)
# - Cargo.lock     (Dependency lock file)
# - src/           (Source code)
# - config.toml    (Example configuration)
# - README.md      (Project readme)
# - docs/          (Documentation)
</code></pre>
<h2 id="build-commands"><a class="header" href="#build-commands">Build Commands</a></h2>
<h3 id="workspace-builds-v020"><a class="header" href="#workspace-builds-v020">Workspace Builds (v0.2.0+)</a></h3>
<p>Build the entire workspace (all 3 packages in parallel):</p>
<pre><code class="language-bash"># Development build
cargo build --workspace

# Release build (optimized)
cargo build --release --workspace
</code></pre>
<p><strong>Build times</strong> (workspace):</p>
<ul>
<li>Clean build: ~12s (was 15-20s in v0.1.0)</li>
<li>Incremental: &lt;2s</li>
<li>Parallel compilation across all packages</li>
</ul>
<h3 id="package-specific-builds"><a class="header" href="#package-specific-builds">Package-Specific Builds</a></h3>
<p>Build individual packages for faster iteration:</p>
<pre><code class="language-bash"># Core engine only
cargo build --package midimon-core
cargo build -p midimon-core  # Short form

# Daemon + tools
cargo build -p midimon-daemon

# Compatibility layer
cargo build -p midimon

# Specific binary
cargo build --release --bin midimon
cargo build --release --bin midimonctl
cargo build --release --bin midi_diagnostic
</code></pre>
<h3 id="running-binaries"><a class="header" href="#running-binaries">Running Binaries</a></h3>
<pre><code class="language-bash"># Main daemon
cargo run --release --bin midimon 2

# Daemon control
cargo run --release --bin midimonctl status

# Diagnostic tool
cargo run --release --bin midi_diagnostic 2
</code></pre>
<h3 id="debug-build"><a class="header" href="#debug-build">Debug Build</a></h3>
<p>Fastest compilation, includes debug symbols, no optimization:</p>
<pre><code class="language-bash">cargo build
</code></pre>
<p><strong>Output</strong>: <code>target/debug/midimon</code> (~10-20MB binary)</p>
<p><strong>When to use</strong>:</p>
<ul>
<li>Development and testing</li>
<li>Debugging with <code>lldb</code>/<code>gdb</code></li>
<li>Frequent recompilation</li>
</ul>
<p><strong>Performance</strong>: ~20-30% slower than release builds</p>
<h3 id="release-build"><a class="header" href="#release-build">Release Build</a></h3>
<p>Optimized compilation, stripped debug symbols, smaller binary:</p>
<pre><code class="language-bash">cargo build --release
</code></pre>
<p><strong>Output</strong>: <code>target/release/midimon</code> (~3-5MB binary)</p>
<p><strong>When to use</strong>:</p>
<ul>
<li>Production use</li>
<li>Performance-critical applications</li>
<li>Distribution</li>
</ul>
<p><strong>Build time</strong>: 12s clean, &lt;2s incremental (workspace)</p>
<p><strong>Performance</strong>: Full optimization, &lt;1ms MIDI latency</p>
<h3 id="clean-build"><a class="header" href="#clean-build">Clean Build</a></h3>
<p>Remove all build artifacts and start fresh:</p>
<pre><code class="language-bash"># Clean build artifacts
cargo clean

# Then rebuild
cargo build --release
</code></pre>
<p><strong>When to use</strong>:</p>
<ul>
<li>After updating dependencies</li>
<li>Troubleshooting build issues</li>
<li>Freeing disk space (build artifacts can be 1-2GB)</li>
</ul>
<h3 id="check-only-no-binary"><a class="header" href="#check-only-no-binary">Check Only (No Binary)</a></h3>
<p>Verify code compiles without producing a binary:</p>
<pre><code class="language-bash">cargo check
</code></pre>
<p><strong>Fastest</strong> way to verify code correctness during development. Use this for quick iteration.</p>
<h3 id="run-directly"><a class="header" href="#run-directly">Run Directly</a></h3>
<p>Build and run in one command:</p>
<pre><code class="language-bash"># Debug mode
cargo run

# Release mode (recommended)
cargo run --release

# With arguments
cargo run --release -- 2 --led reactive
</code></pre>
<p>Note the <code>--</code> separator between cargo arguments and program arguments.</p>
<h2 id="build-optimization"><a class="header" href="#build-optimization">Build Optimization</a></h2>
<h3 id="release-profile-configuration"><a class="header" href="#release-profile-configuration">Release Profile Configuration</a></h3>
<p>MIDIMon's <code>Cargo.toml</code> includes optimized release settings:</p>
<pre><code class="language-toml">[profile.release]
opt-level = 3        # Maximum optimization
lto = true           # Link-Time Optimization (smaller binary, longer build)
codegen-units = 1    # Single codegen unit (better optimization)
strip = true         # Strip debug symbols (smaller binary)
panic = 'abort'      # Abort on panic (smaller binary, no unwinding)
</code></pre>
<p><strong>Results</strong>:</p>
<ul>
<li>Binary size: ~3-5MB (vs ~15-20MB without optimization)</li>
<li>Startup time: &lt;100ms</li>
<li>MIDI latency: &lt;1ms</li>
<li>Memory usage: 5-10MB</li>
</ul>
<h3 id="custom-optimization-levels"><a class="header" href="#custom-optimization-levels">Custom Optimization Levels</a></h3>
<p>Override optimization for specific dependencies:</p>
<pre><code class="language-toml"># In Cargo.toml
[profile.dev.package.midir]
opt-level = 3  # Optimize MIDI library even in debug builds
</code></pre>
<h3 id="faster-debug-builds"><a class="header" href="#faster-debug-builds">Faster Debug Builds</a></h3>
<p>Trade optimization for compile speed during development:</p>
<pre><code class="language-toml"># In Cargo.toml
[profile.dev]
opt-level = 1        # Basic optimization
debug = true         # Keep debug symbols
incremental = true   # Enable incremental compilation
</code></pre>
<h3 id="parallel-compilation"><a class="header" href="#parallel-compilation">Parallel Compilation</a></h3>
<p>Cargo uses all CPU cores by default. To limit:</p>
<pre><code class="language-bash"># Use 4 cores
cargo build -j 4

# Use 1 core (debugging build issues)
cargo build -j 1
</code></pre>
<h2 id="cross-compilation"><a class="header" href="#cross-compilation">Cross-Compilation</a></h2>
<h3 id="macos-universal-binary-intel--apple-silicon"><a class="header" href="#macos-universal-binary-intel--apple-silicon">macOS: Universal Binary (Intel + Apple Silicon)</a></h3>
<p>Build a single binary that runs on both architectures:</p>
<pre><code class="language-bash"># Install targets
rustup target add x86_64-apple-darwin
rustup target add aarch64-apple-darwin

# Build for both
cargo build --release --target x86_64-apple-darwin
cargo build --release --target aarch64-apple-darwin

# Create universal binary
lipo -create \
    target/x86_64-apple-darwin/release/midimon \
    target/aarch64-apple-darwin/release/midimon \
    -output target/release/midimon-universal

# Verify
file target/release/midimon-universal
# Output: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64]
</code></pre>
<h3 id="linux-cross-compile-for-different-architectures"><a class="header" href="#linux-cross-compile-for-different-architectures">Linux: Cross-Compile for Different Architectures</a></h3>
<pre><code class="language-bash"># Install target
rustup target add aarch64-unknown-linux-gnu

# Install cross-compiler (Ubuntu/Debian)
sudo apt install gcc-aarch64-linux-gnu

# Build
cargo build --release --target aarch64-unknown-linux-gnu
</code></pre>
<h3 id="windows-cross-compile-from-linux"><a class="header" href="#windows-cross-compile-from-linux">Windows: Cross-Compile from Linux</a></h3>
<p>Using the <code>cross</code> tool:</p>
<pre><code class="language-bash"># Install cross
cargo install cross

# Build for Windows
cross build --release --target x86_64-pc-windows-gnu
</code></pre>
<h2 id="dependency-management"><a class="header" href="#dependency-management">Dependency Management</a></h2>
<h3 id="updating-dependencies"><a class="header" href="#updating-dependencies">Updating Dependencies</a></h3>
<pre><code class="language-bash"># Update all dependencies to latest compatible versions
cargo update

# Check for outdated dependencies
cargo outdated

# Update specific dependency
cargo update -p midir
</code></pre>
<h3 id="dependency-audit"><a class="header" href="#dependency-audit">Dependency Audit</a></h3>
<p>Check for security vulnerabilities:</p>
<pre><code class="language-bash"># Install cargo-audit
cargo install cargo-audit

# Run audit
cargo audit
</code></pre>
<h3 id="vendoring-dependencies-offline-builds"><a class="header" href="#vendoring-dependencies-offline-builds">Vendoring Dependencies (Offline Builds)</a></h3>
<p>For building without internet access:</p>
<pre><code class="language-bash"># Download all dependencies
cargo vendor

# Configure to use vendored deps
mkdir -p .cargo
cat &gt; .cargo/config.toml &lt;&lt; 'EOF'
[source.crates-io]
replace-with = "vendored-sources"

[source.vendored-sources]
directory = "vendor"
EOF

# Now cargo build works offline
cargo build --release
</code></pre>
<h2 id="binary-size-optimization"><a class="header" href="#binary-size-optimization">Binary Size Optimization</a></h2>
<h3 id="size-comparison"><a class="header" href="#size-comparison">Size Comparison</a></h3>
<pre><code class="language-bash"># Default release build
cargo build --release
ls -lh target/release/midimon
# ~3-5MB

# Further optimization
cargo build --release --features "optimize-size"
ls -lh target/release/midimon
# ~2-3MB
</code></pre>
<h3 id="extreme-size-reduction"><a class="header" href="#extreme-size-reduction">Extreme Size Reduction</a></h3>
<p>Add to <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">[profile.release-min]
inherits = "release"
opt-level = "z"      # Optimize for size
lto = true
codegen-units = 1
strip = true
panic = 'abort'
</code></pre>
<p>Build with:</p>
<pre><code class="language-bash">cargo build --profile release-min
</code></pre>
<p>Result: ~1-2MB binary (may be slightly slower)</p>
<h3 id="analyze-binary-size"><a class="header" href="#analyze-binary-size">Analyze Binary Size</a></h3>
<pre><code class="language-bash"># Install cargo-bloat
cargo install cargo-bloat

# Analyze
cargo bloat --release --crates
cargo bloat --release -n 20  # Show top 20 functions by size
</code></pre>
<h2 id="development-builds"><a class="header" href="#development-builds">Development Builds</a></h2>
<h3 id="watch-mode-auto-rebuild-on-changes"><a class="header" href="#watch-mode-auto-rebuild-on-changes">Watch Mode (Auto-Rebuild on Changes)</a></h3>
<pre><code class="language-bash"># Install cargo-watch
cargo install cargo-watch

# Auto-rebuild on save
cargo watch -x check
cargo watch -x 'run -- 2'
cargo watch -x 'test'
</code></pre>
<h3 id="build-with-specific-features"><a class="header" href="#build-with-specific-features">Build with Specific Features</a></h3>
<pre><code class="language-bash"># Build with all features
cargo build --all-features

# Build with specific feature
cargo build --features "midi-learn"

# Build without default features
cargo build --no-default-features
</code></pre>
<h3 id="build-examples-and-binaries"><a class="header" href="#build-examples-and-binaries">Build Examples and Binaries</a></h3>
<p>MIDIMon includes diagnostic tools:</p>
<pre><code class="language-bash"># Build all binaries
cargo build --release --bins

# Build specific binary
cargo build --release --bin midi_diagnostic

# List available binaries
ls target/release/midi_*
# midi_diagnostic
# led_diagnostic
# led_tester
# pad_mapper
# test_midi
</code></pre>
<h2 id="testing-builds"><a class="header" href="#testing-builds">Testing Builds</a></h2>
<h3 id="run-tests"><a class="header" href="#run-tests">Run Tests</a></h3>
<pre><code class="language-bash"># Run all tests
cargo test

# Run tests with output
cargo test -- --nocapture

# Run specific test
cargo test test_event_processor

# Run tests with release optimizations
cargo test --release
</code></pre>
<h3 id="run-benchmarks"><a class="header" href="#run-benchmarks">Run Benchmarks</a></h3>
<pre><code class="language-bash"># Install cargo-criterion
cargo install cargo-criterion

# Run benchmarks
cargo bench
</code></pre>
<h3 id="integration-tests"><a class="header" href="#integration-tests">Integration Tests</a></h3>
<pre><code class="language-bash"># Run only integration tests
cargo test --test '*'

# Run with real MIDI device (requires hardware)
cargo test --test integration_midi -- --ignored
</code></pre>
<h2 id="troubleshooting-build-issues"><a class="header" href="#troubleshooting-build-issues">Troubleshooting Build Issues</a></h2>
<h3 id="common-errors"><a class="header" href="#common-errors">Common Errors</a></h3>
<h4 id="error-linker-cc-not-found"><a class="header" href="#error-linker-cc-not-found">Error: "linker 'cc' not found"</a></h4>
<p><strong>Cause</strong>: Missing C compiler</p>
<p><strong>Solution</strong>:</p>
<ul>
<li><strong>macOS</strong>: <code>xcode-select --install</code></li>
<li><strong>Linux</strong>: <code>sudo apt install build-essential</code></li>
<li><strong>Windows</strong>: Install Visual Studio Build Tools</li>
</ul>
<hr />
<h4 id="error-could-not-compile-hidapi"><a class="header" href="#error-could-not-compile-hidapi">Error: "could not compile 'hidapi'"</a></h4>
<p><strong>Cause</strong>: Missing USB/HID development libraries</p>
<p><strong>Solution</strong>:</p>
<ul>
<li><strong>macOS</strong>: Install Xcode Command Line Tools</li>
<li><strong>Linux</strong>: <code>sudo apt install libudev-dev libusb-1.0-0-dev</code></li>
<li><strong>Windows</strong>: Install Windows SDK</li>
</ul>
<hr />
<h4 id="error-failed-to-fetch-dependencies"><a class="header" href="#error-failed-to-fetch-dependencies">Error: "failed to fetch dependencies"</a></h4>
<p><strong>Cause</strong>: Network issues or outdated index</p>
<p><strong>Solution</strong>:</p>
<pre><code class="language-bash"># Update cargo index
cargo update

# Or manually remove and re-fetch
rm -rf ~/.cargo/registry/index
cargo build
</code></pre>
<hr />
<h4 id="error-out-of-disk-space"><a class="header" href="#error-out-of-disk-space">Error: "out of disk space"</a></h4>
<p><strong>Cause</strong>: Build artifacts consuming too much space</p>
<p><strong>Solution</strong>:</p>
<pre><code class="language-bash"># Clean all build artifacts
cargo clean

# Clean entire cargo cache (frees 1-5GB)
rm -rf ~/.cargo/registry/cache
rm -rf ~/.cargo/registry/src
</code></pre>
<hr />
<h3 id="incremental-build-issues"><a class="header" href="#incremental-build-issues">Incremental Build Issues</a></h3>
<p>If incremental builds produce errors:</p>
<pre><code class="language-bash"># Disable incremental compilation
CARGO_INCREMENTAL=0 cargo build --release

# Or add to ~/.cargo/config.toml:
[build]
incremental = false
</code></pre>
<h3 id="dependency-conflicts"><a class="header" href="#dependency-conflicts">Dependency Conflicts</a></h3>
<p>If cargo reports conflicting dependencies:</p>
<pre><code class="language-bash"># Show dependency tree
cargo tree

# Show why a dependency is included
cargo tree -i &lt;dependency-name&gt;

# Update all dependencies
cargo update
</code></pre>
<h2 id="build-performance-tips"><a class="header" href="#build-performance-tips">Build Performance Tips</a></h2>
<h3 id="parallel-compilation-1"><a class="header" href="#parallel-compilation-1">Parallel Compilation</a></h3>
<p>Use all CPU cores:</p>
<pre><code class="language-bash"># Set in ~/.cargo/config.toml
[build]
jobs = 8  # Or number of cores
</code></pre>
<h3 id="use-faster-linker"><a class="header" href="#use-faster-linker">Use Faster Linker</a></h3>
<h4 id="macos-1"><a class="header" href="#macos-1">macOS</a></h4>
<pre><code class="language-bash"># Install zld (faster linker)
brew install michaeleisel/zld/zld

# Configure in .cargo/config.toml
[target.x86_64-apple-darwin]
rustflags = ["-C", "link-arg=-fuse-ld=/usr/local/bin/zld"]

[target.aarch64-apple-darwin]
rustflags = ["-C", "link-arg=-fuse-ld=/opt/homebrew/bin/zld"]
</code></pre>
<h4 id="linux"><a class="header" href="#linux">Linux</a></h4>
<pre><code class="language-bash"># Install mold (very fast linker)
sudo apt install mold  # Ubuntu 22.04+
# or download from: https://github.com/rui314/mold

# Configure in .cargo/config.toml
[target.x86_64-unknown-linux-gnu]
linker = "clang"
rustflags = ["-C", "link-arg=-fuse-ld=mold"]
</code></pre>
<p><strong>Result</strong>: 2-3x faster linking (especially for incremental builds)</p>
<h3 id="use-sccache-shared-compilation-cache"><a class="header" href="#use-sccache-shared-compilation-cache">Use sccache (Shared Compilation Cache)</a></h3>
<pre><code class="language-bash"># Install sccache
cargo install sccache

# Configure
export RUSTC_WRAPPER=sccache

# Check stats
sccache --show-stats
</code></pre>
<p>Speeds up rebuilds across multiple projects.</p>
<h2 id="distribution"><a class="header" href="#distribution">Distribution</a></h2>
<h3 id="creating-release-artifacts"><a class="header" href="#creating-release-artifacts">Creating Release Artifacts</a></h3>
<pre><code class="language-bash"># Build optimized binary
cargo build --release

# Copy to distribution directory
mkdir -p dist
cp target/release/midimon dist/
cp config.toml dist/config.example.toml
cp README.md dist/

# Create tarball
cd dist
tar czf midimon-v0.1.0-macos-aarch64.tar.gz *
</code></pre>
<h3 id="code-signing-macos"><a class="header" href="#code-signing-macos">Code Signing (macOS)</a></h3>
<p>For distribution outside the App Store:</p>
<pre><code class="language-bash"># Sign the binary
codesign --force --deep --sign "Developer ID Application: Your Name" \
    target/release/midimon

# Verify signature
codesign -dv --verbose=4 target/release/midimon

# Notarize (requires paid Apple Developer account)
xcrun notarytool submit midimon.zip \
    --keychain-profile "AC_PASSWORD" \
    --wait
</code></pre>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<p>After building successfully:</p>
<ol>
<li><strong>Run the binary</strong>: <code>./target/release/midimon</code></li>
<li><strong>Configure mappings</strong>: Edit <code>config.toml</code></li>
<li><strong>Read documentation</strong>:
<ul>
<li><a href="macos.html">macOS Installation</a></li>
<li><a href="../getting-started/first-mapping.html">First Mapping</a></li>
<li><a href="../configuration/overview.html">Configuration Overview</a></li>
</ul>
</li>
</ol>
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><a href="https://doc.rust-lang.org/cargo/">Cargo Book</a> - Complete cargo documentation</li>
<li><a href="https://doc.rust-lang.org/nightly/rustc/platform-support.html">Rust Platform Support</a> - All supported targets</li>
<li><a href="../reference/cli-commands.html">CLI Commands</a> - Running the binary with options</li>
</ul>
<hr />
<p><strong>Last Updated</strong>: November 11, 2025
<strong>Rust Version</strong>: 1.70.0+ required, 1.75.0+ recommended</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../installation/windows.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../getting-started/quick-start.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../installation/windows.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../getting-started/quick-start.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>

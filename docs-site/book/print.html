<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>MIDIMon Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="Transform MIDI controllers into advanced macro pads with RGB feedback and timing-based triggers">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">MIDIMon Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/amiable-dev/midimon" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><strong>Transform any MIDI controller into an advanced, context-aware macro pad with professional-grade feedback and timing-based triggers.</strong></p>
<p>MIDIMon is a powerful Rust-based MIDI controller mapping system that goes beyond simple note-to-key bindings. It provides velocity sensitivity, long press detection, double-tap, chord recognition, and full RGB LED feedback for modern workflows.</p>
<h2 id="key-features"><a class="header" href="#key-features">Key Features</a></h2>
<h3 id="core-capabilities"><a class="header" href="#core-capabilities">Core Capabilities</a></h3>
<ul>
<li><strong>4 Core Triggers</strong>: Note, Velocity Range, Encoder, Control Change</li>
<li><strong>5 Advanced Triggers</strong>: Long Press, Double-Tap, Chord, Aftertouch, Pitch Bend</li>
<li><strong>10 Action Types</strong>: Keystroke, Text, Launch, Shell, Volume Control, and more</li>
<li><strong>10 LED Schemes</strong>: Reactive, Rainbow, Pulse, Breathing, and custom patterns</li>
<li><strong>Multi-Mode System</strong>: Switch between mapping sets on the fly</li>
<li><strong>Device Profile Support</strong>: Load Native Instruments Controller Editor configurations</li>
</ul>
<h3 id="performance"><a class="header" href="#performance">Performance</a></h3>
<ul>
<li>Response latency: <strong>&lt;1ms</strong> typical</li>
<li>Memory footprint: <strong>5-10MB</strong></li>
<li>CPU usage: <strong>&lt;1%</strong> idle, <strong>&lt;5%</strong> active</li>
<li>Binary size: <strong>3-5MB</strong> (optimized)</li>
</ul>
<h2 id="who-is-midimon-for"><a class="header" href="#who-is-midimon-for">Who is MIDIMon For?</a></h2>
<h3 id="music-producers"><a class="header" href="#music-producers">Music Producers</a></h3>
<p>Control DAWs, plugins, and effects with velocity-sensitive, multi-layer mappings.</p>
<h3 id="software-developers"><a class="header" href="#software-developers">Software Developers</a></h3>
<p>Streamline coding workflows with mode-based hotkey systems and build tool shortcuts.</p>
<h3 id="content-creators"><a class="header" href="#content-creators">Content Creators</a></h3>
<p>Manage streaming, recording, and editing with physical MIDI controls.</p>
<h3 id="power-users"><a class="header" href="#power-users">Power Users</a></h3>
<p>Replace expensive macro pads with affordable MIDI controllers that do more.</p>
<h2 id="why-midimon"><a class="header" href="#why-midimon">Why MIDIMon?</a></h2>
<p>Unlike existing MIDI mapping tools, MIDIMon provides:</p>
<ul>
<li><strong>Advanced Timing</strong>: Long press, double-tap, chord detection out of the box</li>
<li><strong>Velocity Sensitivity</strong>: Different actions for soft/medium/hard pad hits</li>
<li><strong>Full RGB Feedback</strong>: Not just on/off LEDs, but animated schemes and reactive color</li>
<li><strong>Modern Architecture</strong>: Fast Rust core, hot-reload config (coming soon), cross-platform</li>
<li><strong>Open Source</strong>: Fully customizable, extensible, community-driven</li>
</ul>
<h2 id="quick-example"><a class="header" href="#quick-example">Quick Example</a></h2>
<pre><code class="language-toml"># Press pad lightly for copy, hard for paste
[[modes.mappings]]
trigger = { type = "VelocityRange", note = 36 }
soft = { action = { type = "Keystroke", key = "C", modifiers = ["Cmd"] } }
hard = { action = { type = "Keystroke", key = "V", modifiers = ["Cmd"] } }

# Hold for 2 seconds to open terminal
[[modes.mappings]]
trigger = { type = "LongPress", note = 37, duration_ms = 2000 }
action = { type = "Launch", path = "/Applications/Utilities/Terminal.app" }
</code></pre>
<h2 id="platform-support"><a class="header" href="#platform-support">Platform Support</a></h2>
<ul>
<li><strong>macOS</strong>: Full support (11+ Big Sur, Apple Silicon + Intel)</li>
<li><strong>Linux</strong>: Planned for Phase 4 (Q4 2025)</li>
<li><strong>Windows</strong>: Planned for Phase 4 (Q4 2025)</li>
</ul>
<h2 id="device-compatibility"><a class="header" href="#device-compatibility">Device Compatibility</a></h2>
<ul>
<li><strong>Fully Supported</strong>: Native Instruments Maschine Mikro MK3 (RGB LEDs, HID access)</li>
<li><strong>MIDI-Only Support</strong>: Any USB MIDI controller with basic LED feedback</li>
<li><strong>Coming Soon</strong>: Launchpad, APC Mini, Korg nanoKontrol, and more</li>
</ul>
<h2 id="get-started"><a class="header" href="#get-started">Get Started</a></h2>
<p>Ready to dive in? Check out the <a href="getting-started/quick-start.html">Quick Start Guide</a> or <a href="installation/macos.html">Installation Instructions</a>.</p>
<h2 id="project-status"><a class="header" href="#project-status">Project Status</a></h2>
<p>MIDIMon is currently at <strong>v0.1.0-monolithic</strong> (pre-1.0 software). The core features are stable and production-ready, but the API may change before v1.0.0.</p>
<p>See the <a href="resources/roadmap.html">Roadmap</a> for planned features and timeline.</p>
<h2 id="community"><a class="header" href="#community">Community</a></h2>
<ul>
<li><strong>GitHub</strong>: <a href="https://github.com/amiable-dev/midimon">https://github.com/amiable-dev/midimon</a></li>
<li><strong>Discussions</strong>: <a href="https://github.com/amiable-dev/midimon/discussions">https://github.com/amiable-dev/midimon/discussions</a></li>
<li><strong>Issues</strong>: <a href="https://github.com/amiable-dev/midimon/issues">https://github.com/amiable-dev/midimon/issues</a></li>
</ul>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>MIDIMon is open source software licensed under the <strong>MIT License</strong>. See <a href="https://github.com/amiable-dev/midimon/blob/main/LICENSE">LICENSE</a> for details.</p>
<hr />
<p><strong>Next</strong>: <a href="installation/macos.html">Install MIDIMon</a> | <a href="getting-started/quick-start.html">Quick Start</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="macos-installation-guide"><a class="header" href="#macos-installation-guide">macOS Installation Guide</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>This guide walks through installing and configuring MIDIMon on macOS, from installing prerequisites to running your first mapping. The process takes approximately 15-20 minutes.</p>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<h3 id="1-rust-toolchain"><a class="header" href="#1-rust-toolchain">1. Rust Toolchain</a></h3>
<p>MIDIMon is written in Rust and requires the Rust compiler and Cargo build system.</p>
<p><strong>Check if Rust is already installed</strong>:</p>
<pre><code class="language-bash">rustc --version
cargo --version
</code></pre>
<p>If you see version numbers (e.g., <code>rustc 1.75.0</code>), skip to step 2.</p>
<p><strong>Install Rust using rustup</strong>:</p>
<pre><code class="language-bash">curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
</code></pre>
<p>Follow the prompts and select the default installation. Then reload your shell:</p>
<pre><code class="language-bash">source $HOME/.cargo/env
</code></pre>
<p><strong>Verify installation</strong>:</p>
<pre><code class="language-bash">rustc --version  # Should show: rustc 1.75.0 (or later)
cargo --version  # Should show: cargo 1.75.0 (or later)
</code></pre>
<h3 id="2-native-instruments-drivers-for-maschine-mikro-mk3"><a class="header" href="#2-native-instruments-drivers-for-maschine-mikro-mk3">2. Native Instruments Drivers (for Maschine Mikro MK3)</a></h3>
<p>If using a Maschine Mikro MK3, install Native Instruments drivers for full RGB LED support.</p>
<p><strong>Download and install</strong>:</p>
<ol>
<li>Visit <a href="https://www.native-instruments.com/en/support/downloads/">Native Instruments Downloads</a></li>
<li>Download <strong>Native Access</strong> (the NI installation manager)</li>
<li>Install Native Access and sign in (free account)</li>
<li>In Native Access, install:
<ul>
<li><strong>Maschine</strong> software (includes drivers)</li>
<li><strong>Controller Editor</strong> (for creating custom profiles, optional)</li>
</ul>
</li>
</ol>
<p><strong>Verify driver installation</strong>:</p>
<pre><code class="language-bash">system_profiler SPUSBDataType | grep -i maschine
</code></pre>
<p>You should see output like:</p>
<pre><code>Maschine Mikro MK3:
  Product ID: 0x1600
  Vendor ID: 0x17cc  (Native Instruments)
</code></pre>
<h3 id="3-xcode-command-line-tools"><a class="header" href="#3-xcode-command-line-tools">3. Xcode Command Line Tools</a></h3>
<p>Required for compiling native dependencies:</p>
<pre><code class="language-bash">xcode-select --install
</code></pre>
<p>If already installed, you'll see: "command line tools are already installed".</p>
<h2 id="building-midimon-from-source"><a class="header" href="#building-midimon-from-source">Building MIDIMon from Source</a></h2>
<h3 id="1-clone-the-repository"><a class="header" href="#1-clone-the-repository">1. Clone the Repository</a></h3>
<pre><code class="language-bash"># Choose a location for the project
cd ~/projects  # or wherever you keep code

# Clone the repository
git clone https://github.com/yourusername/midimon.git
cd midimon
</code></pre>
<h3 id="2-build-the-project"><a class="header" href="#2-build-the-project">2. Build the Project</a></h3>
<p><strong>Debug build</strong> (faster compilation, larger binary, includes debug symbols):</p>
<pre><code class="language-bash">cargo build
</code></pre>
<p><strong>Release build</strong> (recommended for regular use):</p>
<pre><code class="language-bash">cargo build --release
</code></pre>
<p>The release build takes 2-5 minutes on modern hardware and produces an optimized binary (~3-5MB) in <code>target/release/midimon</code>.</p>
<p><strong>Build output</strong>:</p>
<pre><code>   Compiling midimon v0.1.0 (/Users/you/projects/midimon)
    Finished release [optimized] target(s) in 2m 34s
</code></pre>
<h3 id="3-verify-the-build"><a class="header" href="#3-verify-the-build">3. Verify the Build</a></h3>
<pre><code class="language-bash"># List MIDI ports (should show connected devices)
cargo run --release

# Or use the binary directly
./target/release/midimon
</code></pre>
<p>Expected output:</p>
<pre><code>Available MIDI input ports:
0: USB MIDI Device
1: IAC Driver Bus 1
2: Maschine Mikro MK3 - Input
</code></pre>
<h2 id="setting-up-configuration"><a class="header" href="#setting-up-configuration">Setting Up Configuration</a></h2>
<h3 id="1-create-configtoml"><a class="header" href="#1-create-configtoml">1. Create config.toml</a></h3>
<p>MIDIMon looks for <code>config.toml</code> in the project root directory.</p>
<p><strong>Create a minimal config</strong>:</p>
<pre><code class="language-bash">cat &gt; config.toml &lt;&lt; 'EOF'
[device]
name = "Mikro"
auto_connect = true

[[modes]]
name = "Default"
color = "blue"

[[modes.mappings]]
description = "Test mapping - Copy"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "c"
modifiers = ["cmd"]

[[global_mappings]]
description = "Emergency exit (hold pad 0 for 3 seconds)"
[global_mappings.trigger]
type = "LongPress"
note = 0
hold_duration_ms = 3000
[global_mappings.action]
type = "Shell"
command = "killall midimon"
EOF
</code></pre>
<p>This creates a basic configuration with:</p>
<ul>
<li>One mode (Default)</li>
<li>One test mapping (pad 12 = Cmd+C)</li>
<li>One emergency exit (hold pad 0 to quit)</li>
</ul>
<h3 id="2-find-your-note-numbers"><a class="header" href="#2-find-your-note-numbers">2. Find Your Note Numbers</a></h3>
<p>If you don't know which MIDI note numbers your pads send:</p>
<pre><code class="language-bash">cargo run --bin pad_mapper
</code></pre>
<p>Press each pad and write down the note numbers. Update your <code>config.toml</code> with the correct values.</p>
<h2 id="configuring-macos-permissions"><a class="header" href="#configuring-macos-permissions">Configuring macOS Permissions</a></h2>
<h3 id="input-monitoring-permission-required-for-hidled-control"><a class="header" href="#input-monitoring-permission-required-for-hidled-control">Input Monitoring Permission (Required for HID/LED Control)</a></h3>
<p>macOS requires explicit permission for applications to access HID devices like the Maschine Mikro MK3.</p>
<p><strong>Grant permission</strong>:</p>
<ol>
<li>
<p>Run MIDIMon once:</p>
<pre><code class="language-bash">cargo run --release 2
</code></pre>
</li>
<li>
<p>macOS will show a permission dialog: <strong>"midimon would like to receive keystrokes from any application"</strong></p>
</li>
<li>
<p>Click <strong>Open System Settings</strong> or manually navigate:</p>
<ul>
<li>Open <strong>System Settings</strong> → <strong>Privacy &amp; Security</strong> → <strong>Input Monitoring</strong></li>
<li>Find <code>midimon</code> (or <code>Terminal</code> if running via <code>cargo run</code>)</li>
<li>Toggle the switch to <strong>ON</strong></li>
</ul>
</li>
<li>
<p>Restart MIDIMon:</p>
<pre><code class="language-bash">cargo run --release 2
</code></pre>
</li>
</ol>
<p><strong>Verify HID access</strong>:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
<p>Look for:</p>
<pre><code>[DEBUG] HID device opened successfully
[DEBUG] LED controller initialized
</code></pre>
<p>If you see "HID device open failed", check:</p>
<ul>
<li>Input Monitoring permission is enabled</li>
<li>USB cable is connected</li>
<li>Native Instruments drivers are installed</li>
</ul>
<h3 id="accessibility-permission-optional-for-advanced-actions"><a class="header" href="#accessibility-permission-optional-for-advanced-actions">Accessibility Permission (Optional, for Advanced Actions)</a></h3>
<p>Some actions (e.g., controlling other apps programmatically) may require Accessibility permission:</p>
<ol>
<li>Go to <strong>System Settings</strong> → <strong>Privacy &amp; Security</strong> → <strong>Accessibility</strong></li>
<li>Click the <strong>+</strong> button</li>
<li>Navigate to <code>target/release/midimon</code> (or add <code>Terminal</code>)</li>
<li>Click <strong>Open</strong></li>
</ol>
<p>This is optional and only needed for specific advanced features.</p>
<h2 id="verifying-usb-connection"><a class="header" href="#verifying-usb-connection">Verifying USB Connection</a></h2>
<h3 id="check-usb-device-enumeration"><a class="header" href="#check-usb-device-enumeration">Check USB Device Enumeration</a></h3>
<pre><code class="language-bash">system_profiler SPUSBDataType | grep -i mikro
</code></pre>
<p>Expected output:</p>
<pre><code>Maschine Mikro MK3:
  Product ID: 0x1600
  Vendor ID: 0x17cc (Native Instruments)
  Serial Number: XXXXX
  Location ID: 0x14200000 / 5
</code></pre>
<h3 id="check-midi-connectivity"><a class="header" href="#check-midi-connectivity">Check MIDI Connectivity</a></h3>
<pre><code class="language-bash"># Open Audio MIDI Setup
open -a "Audio MIDI Setup"
</code></pre>
<p>In the <strong>MIDI Studio</strong> window (Window → Show MIDI Studio):</p>
<ul>
<li>You should see "Maschine Mikro MK3" listed</li>
<li>It should be connected (not grayed out)</li>
<li>Double-click to view its properties</li>
</ul>
<h3 id="test-midi-events"><a class="header" href="#test-midi-events">Test MIDI Events</a></h3>
<pre><code class="language-bash"># Run diagnostic tool
cargo run --bin midi_diagnostic 2
</code></pre>
<p>Press pads on your controller. You should see:</p>
<pre><code>[NoteOn] ch:0 note:12 vel:87
[NoteOff] ch:0 note:12 vel:0
</code></pre>
<p>If nothing appears:</p>
<ul>
<li>Check USB cable</li>
<li>Verify correct port number (try 0, 1, 2, etc.)</li>
<li>Restart the device</li>
<li>Check Audio MIDI Setup</li>
</ul>
<h2 id="running-midimon"><a class="header" href="#running-midimon">Running MIDIMon</a></h2>
<h3 id="basic-usage"><a class="header" href="#basic-usage">Basic Usage</a></h3>
<pre><code class="language-bash"># Auto-detect device (port 0)
cargo run --release 0

# Connect to specific port
cargo run --release 2

# With LED lighting
cargo run --release 2 --led reactive
</code></pre>
<h3 id="with-device-profile"><a class="header" href="#with-device-profile">With Device Profile</a></h3>
<p>If you have a <code>.ncmm3</code> profile from NI Controller Editor:</p>
<pre><code class="language-bash"># Auto-detect pad page
cargo run --release 2 --profile ~/Downloads/my-profile.ncmm3

# Force specific pad page (A-H)
cargo run --release 2 --profile my-profile.ncmm3 --pad-page H
</code></pre>
<h3 id="with-debug-logging"><a class="header" href="#with-debug-logging">With Debug Logging</a></h3>
<pre><code class="language-bash"># Enable verbose logging
DEBUG=1 cargo run --release 2
</code></pre>
<h3 id="available-led-schemes"><a class="header" href="#available-led-schemes">Available LED Schemes</a></h3>
<pre><code class="language-bash"># Reactive (velocity-based colors, default)
cargo run --release 2 --led reactive

# Rainbow gradient
cargo run --release 2 --led rainbow

# Breathing effect
cargo run --release 2 --led breathing

# Other schemes: pulse, wave, sparkle, vumeter, spiral, static, off
cargo run --release 2 --led wave
</code></pre>
<h2 id="optional-launchagent-setup-auto-start-on-login"><a class="header" href="#optional-launchagent-setup-auto-start-on-login">Optional: LaunchAgent Setup (Auto-Start on Login)</a></h2>
<p>To run MIDIMon automatically when you log in:</p>
<h3 id="1-create-launchagent-plist"><a class="header" href="#1-create-launchagent-plist">1. Create LaunchAgent plist</a></h3>
<pre><code class="language-bash">mkdir -p ~/Library/LaunchAgents

cat &gt; ~/Library/LaunchAgents/com.midimon.plist &lt;&lt; 'EOF'
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
    &lt;key&gt;Label&lt;/key&gt;
    &lt;string&gt;com.midimon&lt;/string&gt;

    &lt;key&gt;ProgramArguments&lt;/key&gt;
    &lt;array&gt;
        &lt;string&gt;/Users/YOURUSERNAME/projects/midimon/target/release/midimon&lt;/string&gt;
        &lt;string&gt;2&lt;/string&gt;
        &lt;string&gt;--led&lt;/string&gt;
        &lt;string&gt;reactive&lt;/string&gt;
    &lt;/array&gt;

    &lt;key&gt;RunAtLoad&lt;/key&gt;
    &lt;true/&gt;

    &lt;key&gt;KeepAlive&lt;/key&gt;
    &lt;false/&gt;

    &lt;key&gt;StandardOutPath&lt;/key&gt;
    &lt;string&gt;/tmp/midimon.log&lt;/string&gt;

    &lt;key&gt;StandardErrorPath&lt;/key&gt;
    &lt;string&gt;/tmp/midimon.err&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
EOF
</code></pre>
<p><strong>Replace <code>YOURUSERNAME</code></strong> with your actual username, and update the path to your binary.</p>
<h3 id="2-load-the-launchagent"><a class="header" href="#2-load-the-launchagent">2. Load the LaunchAgent</a></h3>
<pre><code class="language-bash">launchctl load ~/Library/LaunchAgents/com.midimon.plist
</code></pre>
<h3 id="3-verify-its-running"><a class="header" href="#3-verify-its-running">3. Verify It's Running</a></h3>
<pre><code class="language-bash">launchctl list | grep midimon
</code></pre>
<p>You should see:</p>
<pre><code>12345   0   com.midimon
</code></pre>
<h3 id="4-control-the-launchagent"><a class="header" href="#4-control-the-launchagent">4. Control the LaunchAgent</a></h3>
<pre><code class="language-bash"># Stop
launchctl unload ~/Library/LaunchAgents/com.midimon.plist

# Start
launchctl load ~/Library/LaunchAgents/com.midimon.plist

# Reload after changes
launchctl unload ~/Library/LaunchAgents/com.midimon.plist
launchctl load ~/Library/LaunchAgents/com.midimon.plist
</code></pre>
<h3 id="5-check-logs"><a class="header" href="#5-check-logs">5. Check Logs</a></h3>
<pre><code class="language-bash"># Standard output
tail -f /tmp/midimon.log

# Errors
tail -f /tmp/midimon.err
</code></pre>
<h2 id="post-installation-steps"><a class="header" href="#post-installation-steps">Post-Installation Steps</a></h2>
<h3 id="1-test-your-mappings"><a class="header" href="#1-test-your-mappings">1. Test Your Mappings</a></h3>
<p>Press pads on your controller and verify actions execute correctly.</p>
<p><strong>Test checklist</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"/>
Pad presses trigger actions</li>
<li><input disabled="" type="checkbox"/>
LEDs respond to presses (if using Mikro MK3)</li>
<li><input disabled="" type="checkbox"/>
Mode switching works (if configured)</li>
<li><input disabled="" type="checkbox"/>
Encoder controls work (if mapped)</li>
<li><input disabled="" type="checkbox"/>
Long press detection works</li>
<li><input disabled="" type="checkbox"/>
Double-tap detection works</li>
</ul>
<h3 id="2-customize-configtoml"><a class="header" href="#2-customize-configtoml">2. Customize config.toml</a></h3>
<p>Edit <code>config.toml</code> to add your own mappings. See:</p>
<ul>
<li><a href="installation/../getting-started/first-mapping.html">First Mapping Tutorial</a></li>
<li><a href="installation/../getting-started/modes.html">Modes Guide</a></li>
<li><a href="installation/../configuration/overview.html">Configuration Overview</a></li>
</ul>
<h3 id="3-create-device-profile-optional"><a class="header" href="#3-create-device-profile-optional">3. Create Device Profile (Optional)</a></h3>
<p>If you want custom pad layouts:</p>
<ol>
<li>Open <strong>Native Instruments Controller Editor</strong></li>
<li>Select <strong>Maschine Mikro MK3</strong></li>
<li>Edit pad pages (A-H)</li>
<li>Save as <code>.ncmm3</code> file</li>
<li>Use with <code>--profile</code> flag</li>
</ol>
<p>See <a href="installation/../DEVICE_PROFILES.html">Device Profiles Documentation</a> for details.</p>
<h2 id="platform-specific-notes"><a class="header" href="#platform-specific-notes">Platform-Specific Notes</a></h2>
<h3 id="macos-versions"><a class="header" href="#macos-versions">macOS Versions</a></h3>
<p><strong>Tested on</strong>:</p>
<ul>
<li>macOS Sonoma (14.x) - Full support</li>
<li>macOS Ventura (13.x) - Full support</li>
<li>macOS Monterey (12.x) - Full support</li>
</ul>
<p><strong>Known issues</strong>:</p>
<ul>
<li>macOS Big Sur (11.x) and earlier: HID shared device access may not work</li>
</ul>
<h3 id="apple-silicon-m1m2m3"><a class="header" href="#apple-silicon-m1m2m3">Apple Silicon (M1/M2/M3)</a></h3>
<p>MIDIMon works natively on Apple Silicon:</p>
<pre><code class="language-bash"># Build for current architecture
cargo build --release

# Binary will be ARM64 (aarch64) on M1/M2/M3
file target/release/midimon
# Output: target/release/midimon: Mach-O 64-bit executable arm64
</code></pre>
<p>No special configuration needed - all dependencies support ARM64.</p>
<h3 id="intel-macs"><a class="header" href="#intel-macs">Intel Macs</a></h3>
<p>Works identically to Apple Silicon. If you need a universal binary:</p>
<pre><code class="language-bash"># Build for both architectures
rustup target add x86_64-apple-darwin
rustup target add aarch64-apple-darwin

cargo build --release --target x86_64-apple-darwin
cargo build --release --target aarch64-apple-darwin

# Combine into universal binary
lipo -create \
    target/x86_64-apple-darwin/release/midimon \
    target/aarch64-apple-darwin/release/midimon \
    -output midimon-universal
</code></pre>
<h3 id="shared-device-access"><a class="header" href="#shared-device-access">Shared Device Access</a></h3>
<p>MIDIMon uses <code>macos-shared-device</code> feature in <code>hidapi</code> to allow concurrent access with NI Controller Editor. This means:</p>
<ul>
<li>✅ You can run MIDIMon and Controller Editor simultaneously</li>
<li>✅ Both can control LEDs without conflicts</li>
<li>✅ Both receive MIDI input</li>
</ul>
<p>This is enabled by default in <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">[dependencies]
hidapi = { version = "2.4", features = ["macos-shared-device"] }
</code></pre>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="build-errors"><a class="header" href="#build-errors">Build Errors</a></h3>
<p><strong>Error</strong>: <code>error: linker 'cc' not found</code></p>
<p><strong>Solution</strong>: Install Xcode Command Line Tools:</p>
<pre><code class="language-bash">xcode-select --install
</code></pre>
<hr />
<p><strong>Error</strong>: <code>error: could not compile 'hidapi'</code></p>
<p><strong>Solution</strong>: Update Rust and dependencies:</p>
<pre><code class="language-bash">rustup update
cargo clean
cargo build --release
</code></pre>
<hr />
<h3 id="runtime-errors"><a class="header" href="#runtime-errors">Runtime Errors</a></h3>
<p><strong>Error</strong>: <code>No MIDI input ports available</code></p>
<p><strong>Solution</strong>:</p>
<ol>
<li>Check USB connection</li>
<li>Open Audio MIDI Setup and verify device appears</li>
<li>Try different USB port</li>
<li>Restart device</li>
</ol>
<hr />
<p><strong>Error</strong>: <code>Failed to open HID device</code></p>
<p><strong>Solution</strong>:</p>
<ol>
<li>Grant Input Monitoring permission (see above)</li>
<li>Install Native Instruments drivers</li>
<li>Check USB cable and connection</li>
<li>Try running with sudo (not recommended long-term):
<pre><code class="language-bash">sudo ./target/release/midimon 2
</code></pre>
</li>
</ol>
<hr />
<p><strong>Error</strong>: <code>Permission denied (os error 13)</code></p>
<p><strong>Solution</strong>:</p>
<ol>
<li>Check Input Monitoring permission</li>
<li>Verify binary has correct permissions:
<pre><code class="language-bash">ls -l target/release/midimon
chmod +x target/release/midimon
</code></pre>
</li>
</ol>
<hr />
<h3 id="led-issues"><a class="header" href="#led-issues">LED Issues</a></h3>
<p><strong>LEDs not lighting up</strong>:</p>
<ol>
<li>Verify Native Instruments drivers installed</li>
<li>Check Input Monitoring permission</li>
<li>Test with different LED scheme:
<pre><code class="language-bash">cargo run --release 2 --led rainbow
</code></pre>
</li>
<li>Check DEBUG output:
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
</li>
</ol>
<p><strong>LEDs lighting wrong pads</strong>:</p>
<ol>
<li>Verify you're using a device profile</li>
<li>Check profile has correct note mappings</li>
<li>See <a href="installation/../DEVICE_PROFILES.html">Device Profiles</a></li>
<li>Use pad mapper to verify notes:
<pre><code class="language-bash">cargo run --bin pad_mapper
</code></pre>
</li>
</ol>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<p>Now that MIDIMon is installed and running:</p>
<ol>
<li><strong>Learn the Basics</strong>: Read <a href="installation/../getting-started/first-mapping.html">First Mapping Tutorial</a></li>
<li><strong>Configure Modes</strong>: See <a href="installation/../getting-started/modes.html">Modes Guide</a></li>
<li><strong>Explore Actions</strong>: Check <a href="installation/../reference/actions.html">Actions Reference</a></li>
<li><strong>Customize LEDs</strong>: Read <a href="installation/../LED_SYSTEM.html">LED System Documentation</a></li>
</ol>
<h2 id="getting-help"><a class="header" href="#getting-help">Getting Help</a></h2>
<p>If you encounter issues:</p>
<ol>
<li>Check <a href="installation/../troubleshooting/common-issues.html">Common Issues</a></li>
<li>Use <a href="installation/../troubleshooting/diagnostics.html">Diagnostic Tools</a></li>
<li>Enable debug logging: <code>DEBUG=1 cargo run --release 2</code></li>
<li>File an issue on GitHub with:
<ul>
<li>macOS version</li>
<li>Hardware (Intel/Apple Silicon)</li>
<li>Device model</li>
<li>Error messages</li>
<li>Output of <code>cargo --version</code> and <code>rustc --version</code></li>
</ul>
</li>
</ol>
<hr />
<p><strong>Last Updated</strong>: November 11, 2025
<strong>macOS Support</strong>: 12.0+ (Monterey and later)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-installation"><a class="header" href="#linux-installation">Linux Installation</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon"><a class="header" href="#coming-soon">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="installation/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="windows-installation"><a class="header" href="#windows-installation">Windows Installation</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-1"><a class="header" href="#coming-soon-1">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="installation/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="building-midimon-from-source-1"><a class="header" href="#building-midimon-from-source-1">Building MIDIMon from Source</a></h1>
<h2 id="overview-1"><a class="header" href="#overview-1">Overview</a></h2>
<p>This guide covers building MIDIMon from source code on any supported platform. Whether you're developing new features, customizing behavior, or just want to run the latest code, this guide walks through the complete build process.</p>
<h2 id="prerequisites-1"><a class="header" href="#prerequisites-1">Prerequisites</a></h2>
<h3 id="rust-toolchain"><a class="header" href="#rust-toolchain">Rust Toolchain</a></h3>
<p>MIDIMon requires Rust 1.70.0 or later.</p>
<h4 id="installing-rust"><a class="header" href="#installing-rust">Installing Rust</a></h4>
<p>The recommended way to install Rust is via <strong>rustup</strong>, the official Rust toolchain installer:</p>
<pre><code class="language-bash"># macOS/Linux
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Windows (PowerShell)
# Download and run: https://win.rustup.rs/
</code></pre>
<p>Follow the installation prompts. The installer will:</p>
<ol>
<li>Install <code>rustc</code> (Rust compiler)</li>
<li>Install <code>cargo</code> (Rust package manager and build tool)</li>
<li>Configure your shell environment</li>
</ol>
<p><strong>After installation</strong>, reload your shell:</p>
<pre><code class="language-bash"># macOS/Linux
source $HOME/.cargo/env

# Windows: Close and reopen terminal
</code></pre>
<p><strong>Verify installation</strong>:</p>
<pre><code class="language-bash">rustc --version  # Should show: rustc 1.75.0 (or later)
cargo --version  # Should show: cargo 1.75.0 (or later)
</code></pre>
<h4 id="updating-rust"><a class="header" href="#updating-rust">Updating Rust</a></h4>
<p>Keep your toolchain up to date:</p>
<pre><code class="language-bash">rustup update
</code></pre>
<h3 id="platform-specific-dependencies"><a class="header" href="#platform-specific-dependencies">Platform-Specific Dependencies</a></h3>
<h4 id="macos"><a class="header" href="#macos">macOS</a></h4>
<p><strong>Required</strong>:</p>
<ul>
<li><strong>Xcode Command Line Tools</strong>: Provides compilers and linkers
<pre><code class="language-bash">xcode-select --install
</code></pre>
</li>
</ul>
<p><strong>Optional (for Maschine Mikro MK3)</strong>:</p>
<ul>
<li><strong>Native Instruments Drivers</strong>: Required for HID/LED support
<ul>
<li>Download from <a href="https://www.native-instruments.com/en/support/downloads/">Native Instruments</a></li>
<li>Install via Native Access</li>
</ul>
</li>
</ul>
<p><strong>Verify</strong>:</p>
<pre><code class="language-bash"># Check compiler
clang --version

# Check USB device (if connected)
system_profiler SPUSBDataType | grep -i mikro
</code></pre>
<h4 id="linux-ubuntudebian"><a class="header" href="#linux-ubuntudebian">Linux (Ubuntu/Debian)</a></h4>
<p><strong>Required</strong>:</p>
<pre><code class="language-bash">sudo apt update
sudo apt install -y \
    build-essential \
    pkg-config \
    libasound2-dev \
    libudev-dev \
    libusb-1.0-0-dev
</code></pre>
<p><strong>For Fedora/RHEL</strong>:</p>
<pre><code class="language-bash">sudo dnf install -y \
    gcc \
    pkg-config \
    alsa-lib-devel \
    systemd-devel \
    libusbx-devel
</code></pre>
<p><strong>For Arch Linux</strong>:</p>
<pre><code class="language-bash">sudo pacman -S base-devel alsa-lib systemd-libs libusb
</code></pre>
<p><strong>udev rules</strong> (for HID access without sudo):</p>
<p>Create <code>/etc/udev/rules.d/50-midimon.rules</code>:</p>
<pre><code class="language-bash">sudo tee /etc/udev/rules.d/50-midimon.rules &lt;&lt; 'EOF'
# Native Instruments Maschine Mikro MK3
SUBSYSTEM=="usb", ATTRS{idVendor}=="17cc", ATTRS{idProduct}=="1600", MODE="0666", GROUP="plugdev"

# Generic MIDI devices
SUBSYSTEM=="usb", ATTRS{bInterfaceClass}=="01", ATTRS{bInterfaceSubClass}=="03", MODE="0666", GROUP="plugdev"
EOF

sudo udevadm control --reload-rules
sudo udevadm trigger
</code></pre>
<p>Add your user to the <code>plugdev</code> group:</p>
<pre><code class="language-bash">sudo usermod -a -G plugdev $USER
# Log out and back in for changes to take effect
</code></pre>
<h4 id="windows"><a class="header" href="#windows">Windows</a></h4>
<p><strong>Required</strong>:</p>
<ul>
<li>
<p><strong>Microsoft C++ Build Tools</strong>: For compiling native dependencies</p>
<ul>
<li>Download: <a href="https://visualstudio.microsoft.com/downloads/">Visual Studio Build Tools</a></li>
<li>Install "Desktop development with C++" workload</li>
</ul>
<p>OR</p>
<ul>
<li>Full Visual Studio (Community edition is free)</li>
</ul>
</li>
</ul>
<p><strong>Optional</strong>:</p>
<ul>
<li><strong>Native Instruments Drivers</strong>: For Maschine Mikro MK3 support
<ul>
<li>Download from <a href="https://www.native-instruments.com/en/support/downloads/">Native Instruments</a></li>
<li>Install via Native Access</li>
</ul>
</li>
</ul>
<p><strong>Verify</strong>:</p>
<pre><code class="language-powershell"># Check MSVC compiler
where cl

# Check Rust
rustc --version
cargo --version
</code></pre>
<h2 id="cloning-the-repository"><a class="header" href="#cloning-the-repository">Cloning the Repository</a></h2>
<h3 id="via-git"><a class="header" href="#via-git">Via Git</a></h3>
<pre><code class="language-bash"># HTTPS (recommended for most users)
git clone https://github.com/yourusername/midimon.git
cd midimon

# SSH (if you have SSH keys configured)
git clone git@github.com:yourusername/midimon.git
cd midimon
</code></pre>
<h3 id="verify-repository-contents"><a class="header" href="#verify-repository-contents">Verify Repository Contents</a></h3>
<pre><code class="language-bash">ls -la

# Expected files/directories:
# - Cargo.toml     (Rust project manifest)
# - Cargo.lock     (Dependency lock file)
# - src/           (Source code)
# - config.toml    (Example configuration)
# - README.md      (Project readme)
# - docs/          (Documentation)
</code></pre>
<h2 id="build-commands"><a class="header" href="#build-commands">Build Commands</a></h2>
<h3 id="debug-build"><a class="header" href="#debug-build">Debug Build</a></h3>
<p>Fastest compilation, includes debug symbols, no optimization:</p>
<pre><code class="language-bash">cargo build
</code></pre>
<p><strong>Output</strong>: <code>target/debug/midimon</code> (~10-20MB binary)</p>
<p><strong>When to use</strong>:</p>
<ul>
<li>Development and testing</li>
<li>Debugging with <code>lldb</code>/<code>gdb</code></li>
<li>Frequent recompilation</li>
</ul>
<p><strong>Performance</strong>: ~20-30% slower than release builds</p>
<h3 id="release-build"><a class="header" href="#release-build">Release Build</a></h3>
<p>Optimized compilation, stripped debug symbols, smaller binary:</p>
<pre><code class="language-bash">cargo build --release
</code></pre>
<p><strong>Output</strong>: <code>target/release/midimon</code> (~3-5MB binary)</p>
<p><strong>When to use</strong>:</p>
<ul>
<li>Production use</li>
<li>Performance-critical applications</li>
<li>Distribution</li>
</ul>
<p><strong>Build time</strong>: 2-5 minutes (first build), 30s-2m (incremental)</p>
<p><strong>Performance</strong>: Full optimization, &lt;1ms MIDI latency</p>
<h3 id="clean-build"><a class="header" href="#clean-build">Clean Build</a></h3>
<p>Remove all build artifacts and start fresh:</p>
<pre><code class="language-bash"># Clean build artifacts
cargo clean

# Then rebuild
cargo build --release
</code></pre>
<p><strong>When to use</strong>:</p>
<ul>
<li>After updating dependencies</li>
<li>Troubleshooting build issues</li>
<li>Freeing disk space (build artifacts can be 1-2GB)</li>
</ul>
<h3 id="check-only-no-binary"><a class="header" href="#check-only-no-binary">Check Only (No Binary)</a></h3>
<p>Verify code compiles without producing a binary:</p>
<pre><code class="language-bash">cargo check
</code></pre>
<p><strong>Fastest</strong> way to verify code correctness during development. Use this for quick iteration.</p>
<h3 id="run-directly"><a class="header" href="#run-directly">Run Directly</a></h3>
<p>Build and run in one command:</p>
<pre><code class="language-bash"># Debug mode
cargo run

# Release mode (recommended)
cargo run --release

# With arguments
cargo run --release -- 2 --led reactive
</code></pre>
<p>Note the <code>--</code> separator between cargo arguments and program arguments.</p>
<h2 id="build-optimization"><a class="header" href="#build-optimization">Build Optimization</a></h2>
<h3 id="release-profile-configuration"><a class="header" href="#release-profile-configuration">Release Profile Configuration</a></h3>
<p>MIDIMon's <code>Cargo.toml</code> includes optimized release settings:</p>
<pre><code class="language-toml">[profile.release]
opt-level = 3        # Maximum optimization
lto = true           # Link-Time Optimization (smaller binary, longer build)
codegen-units = 1    # Single codegen unit (better optimization)
strip = true         # Strip debug symbols (smaller binary)
panic = 'abort'      # Abort on panic (smaller binary, no unwinding)
</code></pre>
<p><strong>Results</strong>:</p>
<ul>
<li>Binary size: ~3-5MB (vs ~15-20MB without optimization)</li>
<li>Startup time: &lt;100ms</li>
<li>MIDI latency: &lt;1ms</li>
<li>Memory usage: 5-10MB</li>
</ul>
<h3 id="custom-optimization-levels"><a class="header" href="#custom-optimization-levels">Custom Optimization Levels</a></h3>
<p>Override optimization for specific dependencies:</p>
<pre><code class="language-toml"># In Cargo.toml
[profile.dev.package.midir]
opt-level = 3  # Optimize MIDI library even in debug builds
</code></pre>
<h3 id="faster-debug-builds"><a class="header" href="#faster-debug-builds">Faster Debug Builds</a></h3>
<p>Trade optimization for compile speed during development:</p>
<pre><code class="language-toml"># In Cargo.toml
[profile.dev]
opt-level = 1        # Basic optimization
debug = true         # Keep debug symbols
incremental = true   # Enable incremental compilation
</code></pre>
<h3 id="parallel-compilation"><a class="header" href="#parallel-compilation">Parallel Compilation</a></h3>
<p>Cargo uses all CPU cores by default. To limit:</p>
<pre><code class="language-bash"># Use 4 cores
cargo build -j 4

# Use 1 core (debugging build issues)
cargo build -j 1
</code></pre>
<h2 id="cross-compilation"><a class="header" href="#cross-compilation">Cross-Compilation</a></h2>
<h3 id="macos-universal-binary-intel--apple-silicon"><a class="header" href="#macos-universal-binary-intel--apple-silicon">macOS: Universal Binary (Intel + Apple Silicon)</a></h3>
<p>Build a single binary that runs on both architectures:</p>
<pre><code class="language-bash"># Install targets
rustup target add x86_64-apple-darwin
rustup target add aarch64-apple-darwin

# Build for both
cargo build --release --target x86_64-apple-darwin
cargo build --release --target aarch64-apple-darwin

# Create universal binary
lipo -create \
    target/x86_64-apple-darwin/release/midimon \
    target/aarch64-apple-darwin/release/midimon \
    -output target/release/midimon-universal

# Verify
file target/release/midimon-universal
# Output: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64]
</code></pre>
<h3 id="linux-cross-compile-for-different-architectures"><a class="header" href="#linux-cross-compile-for-different-architectures">Linux: Cross-Compile for Different Architectures</a></h3>
<pre><code class="language-bash"># Install target
rustup target add aarch64-unknown-linux-gnu

# Install cross-compiler (Ubuntu/Debian)
sudo apt install gcc-aarch64-linux-gnu

# Build
cargo build --release --target aarch64-unknown-linux-gnu
</code></pre>
<h3 id="windows-cross-compile-from-linux"><a class="header" href="#windows-cross-compile-from-linux">Windows: Cross-Compile from Linux</a></h3>
<p>Using the <code>cross</code> tool:</p>
<pre><code class="language-bash"># Install cross
cargo install cross

# Build for Windows
cross build --release --target x86_64-pc-windows-gnu
</code></pre>
<h2 id="dependency-management"><a class="header" href="#dependency-management">Dependency Management</a></h2>
<h3 id="updating-dependencies"><a class="header" href="#updating-dependencies">Updating Dependencies</a></h3>
<pre><code class="language-bash"># Update all dependencies to latest compatible versions
cargo update

# Check for outdated dependencies
cargo outdated

# Update specific dependency
cargo update -p midir
</code></pre>
<h3 id="dependency-audit"><a class="header" href="#dependency-audit">Dependency Audit</a></h3>
<p>Check for security vulnerabilities:</p>
<pre><code class="language-bash"># Install cargo-audit
cargo install cargo-audit

# Run audit
cargo audit
</code></pre>
<h3 id="vendoring-dependencies-offline-builds"><a class="header" href="#vendoring-dependencies-offline-builds">Vendoring Dependencies (Offline Builds)</a></h3>
<p>For building without internet access:</p>
<pre><code class="language-bash"># Download all dependencies
cargo vendor

# Configure to use vendored deps
mkdir -p .cargo
cat &gt; .cargo/config.toml &lt;&lt; 'EOF'
[source.crates-io]
replace-with = "vendored-sources"

[source.vendored-sources]
directory = "vendor"
EOF

# Now cargo build works offline
cargo build --release
</code></pre>
<h2 id="binary-size-optimization"><a class="header" href="#binary-size-optimization">Binary Size Optimization</a></h2>
<h3 id="size-comparison"><a class="header" href="#size-comparison">Size Comparison</a></h3>
<pre><code class="language-bash"># Default release build
cargo build --release
ls -lh target/release/midimon
# ~3-5MB

# Further optimization
cargo build --release --features "optimize-size"
ls -lh target/release/midimon
# ~2-3MB
</code></pre>
<h3 id="extreme-size-reduction"><a class="header" href="#extreme-size-reduction">Extreme Size Reduction</a></h3>
<p>Add to <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">[profile.release-min]
inherits = "release"
opt-level = "z"      # Optimize for size
lto = true
codegen-units = 1
strip = true
panic = 'abort'
</code></pre>
<p>Build with:</p>
<pre><code class="language-bash">cargo build --profile release-min
</code></pre>
<p>Result: ~1-2MB binary (may be slightly slower)</p>
<h3 id="analyze-binary-size"><a class="header" href="#analyze-binary-size">Analyze Binary Size</a></h3>
<pre><code class="language-bash"># Install cargo-bloat
cargo install cargo-bloat

# Analyze
cargo bloat --release --crates
cargo bloat --release -n 20  # Show top 20 functions by size
</code></pre>
<h2 id="development-builds"><a class="header" href="#development-builds">Development Builds</a></h2>
<h3 id="watch-mode-auto-rebuild-on-changes"><a class="header" href="#watch-mode-auto-rebuild-on-changes">Watch Mode (Auto-Rebuild on Changes)</a></h3>
<pre><code class="language-bash"># Install cargo-watch
cargo install cargo-watch

# Auto-rebuild on save
cargo watch -x check
cargo watch -x 'run -- 2'
cargo watch -x 'test'
</code></pre>
<h3 id="build-with-specific-features"><a class="header" href="#build-with-specific-features">Build with Specific Features</a></h3>
<pre><code class="language-bash"># Build with all features
cargo build --all-features

# Build with specific feature
cargo build --features "midi-learn"

# Build without default features
cargo build --no-default-features
</code></pre>
<h3 id="build-examples-and-binaries"><a class="header" href="#build-examples-and-binaries">Build Examples and Binaries</a></h3>
<p>MIDIMon includes diagnostic tools:</p>
<pre><code class="language-bash"># Build all binaries
cargo build --release --bins

# Build specific binary
cargo build --release --bin midi_diagnostic

# List available binaries
ls target/release/midi_*
# midi_diagnostic
# led_diagnostic
# led_tester
# pad_mapper
# test_midi
</code></pre>
<h2 id="testing-builds"><a class="header" href="#testing-builds">Testing Builds</a></h2>
<h3 id="run-tests"><a class="header" href="#run-tests">Run Tests</a></h3>
<pre><code class="language-bash"># Run all tests
cargo test

# Run tests with output
cargo test -- --nocapture

# Run specific test
cargo test test_event_processor

# Run tests with release optimizations
cargo test --release
</code></pre>
<h3 id="run-benchmarks"><a class="header" href="#run-benchmarks">Run Benchmarks</a></h3>
<pre><code class="language-bash"># Install cargo-criterion
cargo install cargo-criterion

# Run benchmarks
cargo bench
</code></pre>
<h3 id="integration-tests"><a class="header" href="#integration-tests">Integration Tests</a></h3>
<pre><code class="language-bash"># Run only integration tests
cargo test --test '*'

# Run with real MIDI device (requires hardware)
cargo test --test integration_midi -- --ignored
</code></pre>
<h2 id="troubleshooting-build-issues"><a class="header" href="#troubleshooting-build-issues">Troubleshooting Build Issues</a></h2>
<h3 id="common-errors"><a class="header" href="#common-errors">Common Errors</a></h3>
<h4 id="error-linker-cc-not-found"><a class="header" href="#error-linker-cc-not-found">Error: "linker 'cc' not found"</a></h4>
<p><strong>Cause</strong>: Missing C compiler</p>
<p><strong>Solution</strong>:</p>
<ul>
<li><strong>macOS</strong>: <code>xcode-select --install</code></li>
<li><strong>Linux</strong>: <code>sudo apt install build-essential</code></li>
<li><strong>Windows</strong>: Install Visual Studio Build Tools</li>
</ul>
<hr />
<h4 id="error-could-not-compile-hidapi"><a class="header" href="#error-could-not-compile-hidapi">Error: "could not compile 'hidapi'"</a></h4>
<p><strong>Cause</strong>: Missing USB/HID development libraries</p>
<p><strong>Solution</strong>:</p>
<ul>
<li><strong>macOS</strong>: Install Xcode Command Line Tools</li>
<li><strong>Linux</strong>: <code>sudo apt install libudev-dev libusb-1.0-0-dev</code></li>
<li><strong>Windows</strong>: Install Windows SDK</li>
</ul>
<hr />
<h4 id="error-failed-to-fetch-dependencies"><a class="header" href="#error-failed-to-fetch-dependencies">Error: "failed to fetch dependencies"</a></h4>
<p><strong>Cause</strong>: Network issues or outdated index</p>
<p><strong>Solution</strong>:</p>
<pre><code class="language-bash"># Update cargo index
cargo update

# Or manually remove and re-fetch
rm -rf ~/.cargo/registry/index
cargo build
</code></pre>
<hr />
<h4 id="error-out-of-disk-space"><a class="header" href="#error-out-of-disk-space">Error: "out of disk space"</a></h4>
<p><strong>Cause</strong>: Build artifacts consuming too much space</p>
<p><strong>Solution</strong>:</p>
<pre><code class="language-bash"># Clean all build artifacts
cargo clean

# Clean entire cargo cache (frees 1-5GB)
rm -rf ~/.cargo/registry/cache
rm -rf ~/.cargo/registry/src
</code></pre>
<hr />
<h3 id="incremental-build-issues"><a class="header" href="#incremental-build-issues">Incremental Build Issues</a></h3>
<p>If incremental builds produce errors:</p>
<pre><code class="language-bash"># Disable incremental compilation
CARGO_INCREMENTAL=0 cargo build --release

# Or add to ~/.cargo/config.toml:
[build]
incremental = false
</code></pre>
<h3 id="dependency-conflicts"><a class="header" href="#dependency-conflicts">Dependency Conflicts</a></h3>
<p>If cargo reports conflicting dependencies:</p>
<pre><code class="language-bash"># Show dependency tree
cargo tree

# Show why a dependency is included
cargo tree -i &lt;dependency-name&gt;

# Update all dependencies
cargo update
</code></pre>
<h2 id="build-performance-tips"><a class="header" href="#build-performance-tips">Build Performance Tips</a></h2>
<h3 id="parallel-compilation-1"><a class="header" href="#parallel-compilation-1">Parallel Compilation</a></h3>
<p>Use all CPU cores:</p>
<pre><code class="language-bash"># Set in ~/.cargo/config.toml
[build]
jobs = 8  # Or number of cores
</code></pre>
<h3 id="use-faster-linker"><a class="header" href="#use-faster-linker">Use Faster Linker</a></h3>
<h4 id="macos-1"><a class="header" href="#macos-1">macOS</a></h4>
<pre><code class="language-bash"># Install zld (faster linker)
brew install michaeleisel/zld/zld

# Configure in .cargo/config.toml
[target.x86_64-apple-darwin]
rustflags = ["-C", "link-arg=-fuse-ld=/usr/local/bin/zld"]

[target.aarch64-apple-darwin]
rustflags = ["-C", "link-arg=-fuse-ld=/opt/homebrew/bin/zld"]
</code></pre>
<h4 id="linux"><a class="header" href="#linux">Linux</a></h4>
<pre><code class="language-bash"># Install mold (very fast linker)
sudo apt install mold  # Ubuntu 22.04+
# or download from: https://github.com/rui314/mold

# Configure in .cargo/config.toml
[target.x86_64-unknown-linux-gnu]
linker = "clang"
rustflags = ["-C", "link-arg=-fuse-ld=mold"]
</code></pre>
<p><strong>Result</strong>: 2-3x faster linking (especially for incremental builds)</p>
<h3 id="use-sccache-shared-compilation-cache"><a class="header" href="#use-sccache-shared-compilation-cache">Use sccache (Shared Compilation Cache)</a></h3>
<pre><code class="language-bash"># Install sccache
cargo install sccache

# Configure
export RUSTC_WRAPPER=sccache

# Check stats
sccache --show-stats
</code></pre>
<p>Speeds up rebuilds across multiple projects.</p>
<h2 id="distribution"><a class="header" href="#distribution">Distribution</a></h2>
<h3 id="creating-release-artifacts"><a class="header" href="#creating-release-artifacts">Creating Release Artifacts</a></h3>
<pre><code class="language-bash"># Build optimized binary
cargo build --release

# Copy to distribution directory
mkdir -p dist
cp target/release/midimon dist/
cp config.toml dist/config.example.toml
cp README.md dist/

# Create tarball
cd dist
tar czf midimon-v0.1.0-macos-aarch64.tar.gz *
</code></pre>
<h3 id="code-signing-macos"><a class="header" href="#code-signing-macos">Code Signing (macOS)</a></h3>
<p>For distribution outside the App Store:</p>
<pre><code class="language-bash"># Sign the binary
codesign --force --deep --sign "Developer ID Application: Your Name" \
    target/release/midimon

# Verify signature
codesign -dv --verbose=4 target/release/midimon

# Notarize (requires paid Apple Developer account)
xcrun notarytool submit midimon.zip \
    --keychain-profile "AC_PASSWORD" \
    --wait
</code></pre>
<h2 id="next-steps-1"><a class="header" href="#next-steps-1">Next Steps</a></h2>
<p>After building successfully:</p>
<ol>
<li><strong>Run the binary</strong>: <code>./target/release/midimon</code></li>
<li><strong>Configure mappings</strong>: Edit <code>config.toml</code></li>
<li><strong>Read documentation</strong>:
<ul>
<li><a href="installation/macos.html">macOS Installation</a></li>
<li><a href="installation/../getting-started/first-mapping.html">First Mapping</a></li>
<li><a href="installation/../configuration/overview.html">Configuration Overview</a></li>
</ul>
</li>
</ol>
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><a href="https://doc.rust-lang.org/cargo/">Cargo Book</a> - Complete cargo documentation</li>
<li><a href="https://doc.rust-lang.org/nightly/rustc/platform-support.html">Rust Platform Support</a> - All supported targets</li>
<li><a href="installation/../reference/cli-commands.html">CLI Commands</a> - Running the binary with options</li>
</ul>
<hr />
<p><strong>Last Updated</strong>: November 11, 2025
<strong>Rust Version</strong>: 1.70.0+ required, 1.75.0+ recommended</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h1>
<p>Get MIDIMon up and running in under 5 minutes.</p>
<h2 id="prerequisites-2"><a class="header" href="#prerequisites-2">Prerequisites</a></h2>
<ul>
<li><strong>Rust toolchain</strong> (1.70+) - <a href="https://rustup.rs/">Install from rustup.rs</a></li>
<li><strong>Native Instruments Maschine Mikro MK3</strong> (or any MIDI controller)</li>
<li><strong>macOS</strong> (primary support - Linux/Windows planned for Q4 2025)</li>
</ul>
<h2 id="step-1-clone-and-build"><a class="header" href="#step-1-clone-and-build">Step 1: Clone and Build</a></h2>
<pre><code class="language-bash"># Clone the repository
git clone https://github.com/amiable-dev/midimon.git
cd midimon

# Build release binary (optimized, ~3-5MB)
cargo build --release
</code></pre>
<p>The release build takes 2-3 minutes and produces a highly optimized binary at <code>target/release/midimon</code>.</p>
<h2 id="step-2-connect-your-device"><a class="header" href="#step-2-connect-your-device">Step 2: Connect Your Device</a></h2>
<ol>
<li><strong>Plug in your MIDI controller</strong> via USB</li>
<li><strong>List available MIDI ports</strong>:</li>
</ol>
<pre><code class="language-bash">cargo run --release
</code></pre>
<p>You'll see output like:</p>
<pre><code>Available MIDI input ports:
  0: CoreMIDI - Mikro MK3 Public
  1: CoreMIDI - Mikro MK3 Private
  2: CoreMIDI - IAC Driver Bus 1

Select a port number to connect...
</code></pre>
<ol start="3">
<li><strong>Note the port number</strong> for your device (usually port <code>0</code> or <code>2</code> for Mikro MK3)</li>
</ol>
<h2 id="step-3-first-run"><a class="header" href="#step-3-first-run">Step 3: First Run</a></h2>
<p>Connect to your device:</p>
<pre><code class="language-bash">cargo run --release 2
</code></pre>
<p>(Replace <code>2</code> with your device's port number)</p>
<p>You should see:</p>
<pre><code>Connected to MIDI port 2: CoreMIDI - Mikro MK3 Public
Loaded config from: config.toml
Current mode: Default
Listening for MIDI events... (Press Ctrl+C to exit)
</code></pre>
<h2 id="step-4-test-your-first-mapping"><a class="header" href="#step-4-test-your-first-mapping">Step 4: Test Your First Mapping</a></h2>
<p>The included <code>config.toml</code> has a basic mapping:</p>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { Note = { note = 60, velocity_min = 0 } }
action = { Keystroke = { keys = ["Space"] } }
</code></pre>
<p><strong>Test it</strong>:</p>
<ol>
<li>Press the first pad (Note 60)</li>
<li>It should trigger a Space key press</li>
<li>LEDs should light up (if your device supports RGB)</li>
</ol>
<h2 id="step-5-enable-led-feedback-optional"><a class="header" href="#step-5-enable-led-feedback-optional">Step 5: Enable LED Feedback (Optional)</a></h2>
<p>If you have a Maschine Mikro MK3, enable reactive LED feedback:</p>
<pre><code class="language-bash">cargo run --release 2 --led reactive
</code></pre>
<p>Now pads will:</p>
<ul>
<li>Light up <strong>green</strong> for soft press (velocity 0-40)</li>
<li>Light up <strong>yellow</strong> for medium press (velocity 41-80)</li>
<li>Light up <strong>red</strong> for hard press (velocity 81-127)</li>
<li>Fade out over 1 second after release</li>
</ul>
<p>Try other LED schemes:</p>
<pre><code class="language-bash">cargo run --release 2 --led rainbow   # Rainbow wave animation
cargo run --release 2 --led pulse     # Pulsing brightness
cargo run --release 2 --led spiral    # Spiral pattern
</code></pre>
<p>See all schemes: <a href="getting-started/../configuration/led-feedback.html">LED Feedback Configuration</a></p>
<h2 id="step-6-customize-your-mappings"><a class="header" href="#step-6-customize-your-mappings">Step 6: Customize Your Mappings</a></h2>
<p>The default config is at <code>config.toml</code> in the project root. Edit it to add your own mappings:</p>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { Note = { note = 61, velocity_min = 0 } }
action = { Keystroke = { keys = ["Cmd", "T"] } }  # Open new tab
</code></pre>
<p>Reload the config:</p>
<ul>
<li><strong>Stop</strong> MIDIMon (Ctrl+C)</li>
<li><strong>Start</strong> it again: <code>cargo run --release 2</code></li>
</ul>
<blockquote>
<p><strong>Future</strong>: Hot-reloading (Phase 2+) will let you reload config without restarting</p>
</blockquote>
<h2 id="step-7-explore-advanced-features"><a class="header" href="#step-7-explore-advanced-features">Step 7: Explore Advanced Features</a></h2>
<h3 id="velocity-sensitivity"><a class="header" href="#velocity-sensitivity">Velocity Sensitivity</a></h3>
<p>Different actions based on how hard you hit the pad:</p>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { VelocityRange = { note = 62, min = 0, max = 40 } }
action = { Text = { text = "soft" } }

[[modes.mappings]]
trigger = { VelocityRange = { note = 62, min = 81, max = 127 } }
action = { Text = { text = "HARD" } }
</code></pre>
<h3 id="long-press-detection"><a class="header" href="#long-press-detection">Long Press Detection</a></h3>
<p>Hold a pad for 2 seconds to trigger a different action:</p>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { LongPress = { note = 63, velocity_min = 0, hold_ms = 2000 } }
action = { Shell = { command = "open -a Calculator" } }
</code></pre>
<h3 id="chord-detection"><a class="header" href="#chord-detection">Chord Detection</a></h3>
<p>Press multiple pads simultaneously (within 100ms):</p>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { NoteChord = { notes = [60, 64, 67], velocity_min = 0 } }
action = { Text = { text = "C Major Chord!" } }
</code></pre>
<h2 id="troubleshooting-1"><a class="header" href="#troubleshooting-1">Troubleshooting</a></h2>
<h3 id="device-not-found"><a class="header" href="#device-not-found">Device Not Found</a></h3>
<pre><code class="language-bash"># Check USB connection
system_profiler SPUSBDataType | grep -i mikro

# List MIDI ports again
cargo run --release

# Check Audio MIDI Setup
open -a "Audio MIDI Setup"
</code></pre>
<h3 id="leds-not-working"><a class="header" href="#leds-not-working">LEDs Not Working</a></h3>
<ol>
<li>Ensure Native Instruments drivers are installed</li>
<li>Grant <strong>Input Monitoring</strong> permissions:
<ul>
<li><strong>System Settings</strong> → <strong>Privacy &amp; Security</strong> → <strong>Input Monitoring</strong></li>
<li>Enable for your Terminal app</li>
</ul>
</li>
<li>Try different LED schemes: <code>--led reactive</code>, <code>--led rainbow</code></li>
<li>Check debug output: <code>DEBUG=1 cargo run --release 2</code></li>
</ol>
<h3 id="events-not-triggering"><a class="header" href="#events-not-triggering">Events Not Triggering</a></h3>
<ol>
<li><strong>Run diagnostics</strong> to verify MIDI events:
<pre><code class="language-bash">cargo run --bin midi_diagnostic 2
</code></pre>
</li>
<li><strong>Check note numbers</strong> match your config:
<pre><code class="language-bash">cargo run --bin pad_mapper
</code></pre>
</li>
<li><strong>Verify velocity thresholds</strong> aren't too restrictive</li>
<li><strong>Check mode</strong> - is the mapping in the current mode or global?</li>
</ol>
<h3 id="permission-denied-macos"><a class="header" href="#permission-denied-macos">Permission Denied (macOS)</a></h3>
<p>If you see "Permission denied" for HID devices:</p>
<ol>
<li><strong>System Settings</strong> → <strong>Privacy &amp; Security</strong> → <strong>Input Monitoring</strong></li>
<li>Add your Terminal app (Terminal.app, iTerm2, etc.)</li>
<li>Restart your terminal</li>
<li>Run MIDIMon again</li>
</ol>
<h2 id="next-steps-2"><a class="header" href="#next-steps-2">Next Steps</a></h2>
<ul>
<li><a href="getting-started/./first-mapping.html">Create Your First Mapping</a> - Step-by-step mapping tutorial</li>
<li><a href="getting-started/./modes.html">Understanding Modes</a> - Multi-mode workflow management</li>
<li><a href="getting-started/../configuration/overview.html">Configuration Overview</a> - Complete config reference</li>
<li><a href="getting-started/../configuration/examples.html">Example Configurations</a> - Pre-built configs</li>
</ul>
<h2 id="performance-1"><a class="header" href="#performance-1">Performance</a></h2>
<p>MIDIMon is highly optimized:</p>
<ul>
<li><strong>Response latency</strong>: &lt;1ms typical</li>
<li><strong>Memory usage</strong>: 5-10MB</li>
<li><strong>CPU usage</strong>: &lt;1% idle, &lt;5% active</li>
<li><strong>Binary size</strong>: ~3-5MB (release with LTO)</li>
</ul>
<h2 id="debug-mode"><a class="header" href="#debug-mode">Debug Mode</a></h2>
<p>Enable detailed logging for troubleshooting:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
<p>You'll see:</p>
<ul>
<li>MIDI event parsing details</li>
<li>Trigger matching logic</li>
<li>Action execution results</li>
<li>LED feedback commands</li>
<li>Error stack traces</li>
</ul>
<h2 id="getting-help-1"><a class="header" href="#getting-help-1">Getting Help</a></h2>
<ul>
<li><a href="getting-started/../troubleshooting/common-issues.html">Troubleshooting Guide</a></li>
<li><a href="getting-started/../troubleshooting/faq.html">FAQ</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
<li><a href="https://github.com/amiable-dev/midimon/issues">Report Issues</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="your-first-mapping"><a class="header" href="#your-first-mapping">Your First Mapping</a></h1>
<p>Learn how to create custom mappings by building a practical example step-by-step.</p>
<h2 id="what-youll-build"><a class="header" href="#what-youll-build">What You'll Build</a></h2>
<p>A simple pad mapping that opens Visual Studio Code when you press pad 1 (Note 60).</p>
<h2 id="understanding-mapping-structure"><a class="header" href="#understanding-mapping-structure">Understanding Mapping Structure</a></h2>
<p>Every mapping has two parts:</p>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { ... }  # What activates the mapping
action = { ... }   # What happens when activated
</code></pre>
<p>Think of it as: <strong>"When [trigger], do [action]"</strong></p>
<h2 id="step-1-open-your-config-file"><a class="header" href="#step-1-open-your-config-file">Step 1: Open Your Config File</a></h2>
<p>The config file is <code>config.toml</code> in your project root:</p>
<pre><code class="language-bash">cd /path/to/midimon
open config.toml  # macOS
# or
nano config.toml  # Terminal editor
</code></pre>
<h2 id="step-2-find-the-modes-section"><a class="header" href="#step-2-find-the-modes-section">Step 2: Find the Modes Section</a></h2>
<p>Scroll down to find the <code>[[modes]]</code> section. It looks like this:</p>
<pre><code class="language-toml">[[modes]]
name = "Default"
color = "blue"

[[modes.mappings]]
# Existing mappings here...
</code></pre>
<h2 id="step-3-add-your-mapping"><a class="header" href="#step-3-add-your-mapping">Step 3: Add Your Mapping</a></h2>
<p>Add this <strong>at the end</strong> of the <code>[[modes.mappings]]</code> section:</p>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { Note = { note = 60, velocity_min = 0 } }
action = { Launch = { app_path = "/Applications/Visual Studio Code.app" } }
</code></pre>
<p><strong>What this means</strong>:</p>
<ul>
<li><strong>trigger</strong>: When pad Note 60 is pressed (any velocity ≥0)</li>
<li><strong>action</strong>: Launch Visual Studio Code</li>
</ul>
<h2 id="step-4-save-and-reload"><a class="header" href="#step-4-save-and-reload">Step 4: Save and Reload</a></h2>
<ol>
<li><strong>Save</strong> the file (Cmd+S or Ctrl+O in nano)</li>
<li><strong>Stop</strong> MIDIMon if it's running (Ctrl+C)</li>
<li><strong>Restart</strong> it:</li>
</ol>
<pre><code class="language-bash">cargo run --release 2
</code></pre>
<h2 id="step-5-test-it"><a class="header" href="#step-5-test-it">Step 5: Test It</a></h2>
<p>Press the <strong>first pad</strong> (bottom-left on Mikro MK3). Visual Studio Code should launch!</p>
<h2 id="understanding-note-numbers"><a class="header" href="#understanding-note-numbers">Understanding Note Numbers</a></h2>
<p>How do you know which pad is Note 60?</p>
<h3 id="quick-reference-maschine-mikro-mk3"><a class="header" href="#quick-reference-maschine-mikro-mk3">Quick Reference (Maschine Mikro MK3)</a></h3>
<pre><code>Pad Layout (4x4 grid):
┌────┬────┬────┬────┐
│ 60 │ 61 │ 62 │ 63 │  Top row
├────┼────┼────┼────┤
│ 64 │ 65 │ 66 │ 67 │
├────┼────┼────┼────┤
│ 68 │ 69 │ 70 │ 71 │
└────┴────┴────┴────┘
   72   73   74   75    Bottom row
</code></pre>
<h3 id="find-note-numbers-for-any-device"><a class="header" href="#find-note-numbers-for-any-device">Find Note Numbers for Any Device</a></h3>
<p>Use the pad mapper tool:</p>
<pre><code class="language-bash">cargo run --bin pad_mapper
</code></pre>
<p>Then press each pad to see its note number.</p>
<h2 id="common-mapping-patterns"><a class="header" href="#common-mapping-patterns">Common Mapping Patterns</a></h2>
<h3 id="pattern-1-keyboard-shortcut"><a class="header" href="#pattern-1-keyboard-shortcut">Pattern 1: Keyboard Shortcut</a></h3>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { Note = { note = 61, velocity_min = 0 } }
action = { Keystroke = { keys = ["Cmd", "T"] } }  # New tab
</code></pre>
<h3 id="pattern-2-type-text"><a class="header" href="#pattern-2-type-text">Pattern 2: Type Text</a></h3>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { Note = { note = 62, velocity_min = 0 } }
action = { Text = { text = "user@example.com" } }
</code></pre>
<h3 id="pattern-3-run-shell-command"><a class="header" href="#pattern-3-run-shell-command">Pattern 3: Run Shell Command</a></h3>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { Note = { note = 63, velocity_min = 0 } }
action = { Shell = { command = "open -a Calculator" } }
</code></pre>
<h3 id="pattern-4-volume-control"><a class="header" href="#pattern-4-volume-control">Pattern 4: Volume Control</a></h3>
<pre><code class="language-toml">[[modes.mappings]]
trigger = { Note = { note = 64, velocity_min = 0 } }
action = { VolumeControl = "VolumeUp" }
</code></pre>
<h2 id="next-steps-3"><a class="header" href="#next-steps-3">Next Steps</a></h2>
<ul>
<li><a href="getting-started/./modes.html">Understanding Modes</a> - Create mode-based workflows</li>
<li><a href="getting-started/../configuration/overview.html">Configuration Overview</a> - Full config reference</li>
<li><a href="getting-started/../reference/trigger-types.html">All Trigger Types</a> - Complete trigger reference</li>
<li><a href="getting-started/../reference/action-types.html">All Action Types</a> - Complete action reference</li>
<li><a href="getting-started/../configuration/examples.html">Example Configurations</a> - Pre-built configs</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="midi-learn"><a class="header" href="#midi-learn">MIDI Learn</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-2"><a class="header" href="#coming-soon-2">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="getting-started/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="modes-context-switching-for-different-workflows"><a class="header" href="#modes-context-switching-for-different-workflows">Modes: Context Switching for Different Workflows</a></h1>
<h2 id="overview-2"><a class="header" href="#overview-2">Overview</a></h2>
<p>Modes are MIDIMon's system for context switching - they allow you to define completely different mapping sets for different workflows, all accessible from the same MIDI controller. Think of modes as "profiles" or "layers" that transform your controller's behavior based on what you're doing.</p>
<p>For example:</p>
<ul>
<li><strong>Default Mode</strong>: General productivity shortcuts (copy, paste, window switching)</li>
<li><strong>Developer Mode</strong>: IDE shortcuts, terminal commands, debugging tools</li>
<li><strong>Media Mode</strong>: Audio/video playback controls, screen capture, streaming tools</li>
</ul>
<p>Modes enable a single 16-pad controller to provide hundreds of distinct functions without reconfiguring anything.</p>
<h2 id="mode-architecture"><a class="header" href="#mode-architecture">Mode Architecture</a></h2>
<h3 id="mode-structure-in-configtoml"><a class="header" href="#mode-structure-in-configtoml">Mode Structure in config.toml</a></h3>
<p>Modes are defined in your <code>config.toml</code> using the <code>[[modes]]</code> array:</p>
<pre><code class="language-toml">[[modes]]
name = "Default"
color = "blue"

[[modes.mappings]]
description = "Copy text"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "c"
modifiers = ["cmd"]

[[modes.mappings]]
description = "Paste text"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Keystroke"
keys = "v"
modifiers = ["cmd"]

[[modes]]
name = "Developer"
color = "green"

[[modes.mappings]]
description = "Run tests"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Shell"
command = "cargo test"

[[modes.mappings]]
description = "Git commit"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Shell"
command = "git commit"
</code></pre>
<p><strong>Key Points</strong>:</p>
<ul>
<li>Each <code>[[modes]]</code> section defines a complete mode</li>
<li><code>name</code>: Displayed in console when switching modes</li>
<li><code>color</code>: LED feedback color theme (optional but recommended)</li>
<li><code>[[modes.mappings]]</code>: Array of triggers and actions for this mode</li>
</ul>
<h3 id="mode-colors-and-led-feedback"><a class="header" href="#mode-colors-and-led-feedback">Mode Colors and LED Feedback</a></h3>
<p>Each mode can have a distinct color theme for visual identification:</p>
<p><strong>Available Colors</strong>:</p>
<ul>
<li><code>blue</code> - Default mode (calm, general use)</li>
<li><code>green</code> - Development/productivity (focused work)</li>
<li><code>purple</code> - Media/creative (entertainment)</li>
<li><code>red</code> - Emergency/system (critical functions)</li>
<li><code>yellow</code> - Testing/debug (temporary mappings)</li>
<li><code>white</code> - Neutral (fallback)</li>
</ul>
<p><strong>How Colors Work</strong>:</p>
<pre><code class="language-toml">[[modes]]
name = "Default"
color = "blue"  # All pads in this mode default to blue when idle
</code></pre>
<p>When using the <code>reactive</code> lighting scheme:</p>
<ul>
<li>Idle pads show the mode's base color at dim brightness</li>
<li>Pressed pads light up with velocity-based colors (green/yellow/red)</li>
<li>Released pads fade back to the mode's base color</li>
</ul>
<p>When using static patterns (rainbow, wave, etc.):</p>
<ul>
<li>The mode color is used as the primary theme color</li>
<li>Pattern variations are tinted with the mode color</li>
</ul>
<h2 id="global-vs-mode-specific-mappings"><a class="header" href="#global-vs-mode-specific-mappings">Global vs Mode-Specific Mappings</a></h2>
<p>MIDIMon supports two types of mappings:</p>
<h3 id="mode-specific-mappings"><a class="header" href="#mode-specific-mappings">Mode-Specific Mappings</a></h3>
<p>Defined inside <code>[[modes.mappings]]</code>, these only work when that mode is active:</p>
<pre><code class="language-toml">[[modes]]
name = "Media"
color = "purple"

[[modes.mappings]]
description = "Play/Pause"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "space"
modifiers = []
</code></pre>
<p>This Play/Pause mapping only works in Media mode.</p>
<h3 id="global-mappings"><a class="header" href="#global-mappings">Global Mappings</a></h3>
<p>Defined in <code>[[global_mappings]]</code> at the top level, these work in ALL modes:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Emergency exit"
[global_mappings.trigger]
type = "LongPress"
note = 0
hold_duration_ms = 3000
[global_mappings.action]
type = "Shell"
command = "killall midimon"

[[global_mappings]]
description = "Volume up (always available)"
[global_mappings.trigger]
type = "EncoderTurn"
direction = "Clockwise"
[global_mappings.action]
type = "VolumeControl"
operation = "Up"
</code></pre>
<p><strong>Use Cases for Global Mappings</strong>:</p>
<ul>
<li>Emergency shutdown (long press escape)</li>
<li>Volume control (encoder always controls volume)</li>
<li>Mode switching (dedicated mode-change buttons)</li>
<li>System-wide shortcuts (screenshots, lock screen)</li>
</ul>
<p><strong>Priority Order</strong>:</p>
<ol>
<li>Mode-specific mappings are checked first</li>
<li>If no match, global mappings are checked</li>
<li>If still no match, the event is ignored</li>
</ol>
<p>This means mode-specific mappings can "override" global ones by using the same trigger.</p>
<h2 id="switching-between-modes"><a class="header" href="#switching-between-modes">Switching Between Modes</a></h2>
<p>There are three ways to switch modes:</p>
<h3 id="1-encoder-rotation"><a class="header" href="#1-encoder-rotation">1. Encoder Rotation</a></h3>
<p>The most common method - use your encoder as a mode selector:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Next mode (encoder clockwise)"
[global_mappings.trigger]
type = "EncoderTurn"
direction = "Clockwise"
[global_mappings.action]
type = "ModeChange"
mode = "next"

[[global_mappings]]
description = "Previous mode (encoder counter-clockwise)"
[global_mappings.trigger]
type = "EncoderTurn"
direction = "CounterClockwise"
[global_mappings.action]
type = "ModeChange"
mode = "previous"
</code></pre>
<p>This creates a circular mode selector:</p>
<ul>
<li>Turn clockwise: Default → Developer → Media → Default...</li>
<li>Turn counter-clockwise: Default → Media → Developer → Default...</li>
</ul>
<h3 id="2-dedicated-mode-buttons"><a class="header" href="#2-dedicated-mode-buttons">2. Dedicated Mode Buttons</a></h3>
<p>Assign specific pads to jump directly to modes:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Jump to Developer mode"
[global_mappings.trigger]
type = "Note"
note = 15  # Top-right pad
[global_mappings.action]
type = "ModeChange"
mode = "Developer"

[[global_mappings]]
description = "Jump to Media mode"
[global_mappings.trigger]
type = "Note"
note = 11  # Another pad
[global_mappings.action]
type = "ModeChange"
mode = "Media"
</code></pre>
<h3 id="3-chord-based-mode-switching"><a class="header" href="#3-chord-based-mode-switching">3. Chord-Based Mode Switching</a></h3>
<p>Use pad combinations for advanced mode switching:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Secret admin mode (pads 0+1+2 together)"
[global_mappings.trigger]
type = "NoteChord"
notes = [0, 1, 2]
chord_timeout_ms = 100
[global_mappings.action]
type = "ModeChange"
mode = "Admin"
</code></pre>
<p><strong>ModeChange Action Parameters</strong>:</p>
<ul>
<li><code>mode = "next"</code> - Cycle to next mode</li>
<li><code>mode = "previous"</code> - Cycle to previous mode</li>
<li><code>mode = "Default"</code> - Jump to specific mode by name (case-sensitive)</li>
<li><code>mode = 0</code> - Jump to mode by index (0-based)</li>
</ul>
<h2 id="practical-mode-examples"><a class="header" href="#practical-mode-examples">Practical Mode Examples</a></h2>
<h3 id="example-1-three-mode-general-setup"><a class="header" href="#example-1-three-mode-general-setup">Example 1: Three-Mode General Setup</a></h3>
<pre><code class="language-toml"># Mode 0: Default (General Productivity)
[[modes]]
name = "Default"
color = "blue"

[[modes.mappings]]
description = "Copy"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "c"
modifiers = ["cmd"]

[[modes.mappings]]
description = "Paste"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Keystroke"
keys = "v"
modifiers = ["cmd"]

[[modes.mappings]]
description = "Switch to next app"
[modes.mappings.trigger]
type = "Note"
note = 14
[modes.mappings.action]
type = "Keystroke"
keys = "tab"
modifiers = ["cmd"]

# Mode 1: Developer (Coding Tools)
[[modes]]
name = "Developer"
color = "green"

[[modes.mappings]]
description = "Run tests"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Shell"
command = "cargo test"

[[modes.mappings]]
description = "Build release"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Shell"
command = "cargo build --release"

[[modes.mappings]]
description = "Open terminal"
[modes.mappings.trigger]
type = "Note"
note = 14
[modes.mappings.action]
type = "Launch"
app = "Terminal"

# Mode 2: Media (Audio/Video Control)
[[modes]]
name = "Media"
color = "purple"

[[modes.mappings]]
description = "Play/Pause"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "space"
modifiers = []

[[modes.mappings]]
description = "Next track"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Keystroke"
keys = "right"
modifiers = ["cmd"]

[[modes.mappings]]
description = "Screenshot"
[modes.mappings.trigger]
type = "Note"
note = 14
[modes.mappings.action]
type = "Keystroke"
keys = "4"
modifiers = ["cmd", "shift"]

# Global: Mode switching and volume
[[global_mappings]]
description = "Next mode"
[global_mappings.trigger]
type = "EncoderTurn"
direction = "Clockwise"
[global_mappings.action]
type = "ModeChange"
mode = "next"

[[global_mappings]]
description = "Previous mode"
[global_mappings.trigger]
type = "EncoderTurn"
direction = "CounterClockwise"
[global_mappings.action]
type = "ModeChange"
mode = "previous"
</code></pre>
<h3 id="example-2-context-aware-developer-modes"><a class="header" href="#example-2-context-aware-developer-modes">Example 2: Context-Aware Developer Modes</a></h3>
<pre><code class="language-toml"># General development
[[modes]]
name = "Dev-General"
color = "green"

[[modes.mappings]]
description = "Save all"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "s"
modifiers = ["cmd", "alt"]

# Rust-specific
[[modes]]
name = "Dev-Rust"
color = "green"

[[modes.mappings]]
description = "cargo check"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Shell"
command = "cargo check"

[[modes.mappings]]
description = "cargo fmt"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Shell"
command = "cargo fmt"

# Python-specific
[[modes]]
name = "Dev-Python"
color = "green"

[[modes.mappings]]
description = "pytest"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Shell"
command = "pytest"

[[modes.mappings]]
description = "black format"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Shell"
command = "black ."
</code></pre>
<h3 id="example-3-velocity-sensitive-multi-mode"><a class="header" href="#example-3-velocity-sensitive-multi-mode">Example 3: Velocity-Sensitive Multi-Mode</a></h3>
<p>Combine modes with velocity detection for even more control:</p>
<pre><code class="language-toml">[[modes]]
name = "Advanced"
color = "yellow"

# Soft press: Small increase
[[modes.mappings]]
description = "Small volume up"
[modes.mappings.trigger]
type = "VelocityRange"
note = 12
min_velocity = 0
max_velocity = 40
[modes.mappings.action]
type = "Shell"
command = "osascript -e 'set volume output volume (output volume of (get volume settings) + 5)'"

# Hard press: Large increase
[[modes.mappings]]
description = "Large volume up"
[modes.mappings.trigger]
type = "VelocityRange"
note = 12
min_velocity = 81
max_velocity = 127
[modes.mappings.action]
type = "Shell"
command = "osascript -e 'set volume output volume (output volume of (get volume settings) + 20)'"
</code></pre>
<h2 id="mode-design-best-practices"><a class="header" href="#mode-design-best-practices">Mode Design Best Practices</a></h2>
<h3 id="1-use-descriptive-names"><a class="header" href="#1-use-descriptive-names">1. Use Descriptive Names</a></h3>
<pre><code class="language-toml"># Good: Clear what the mode does
[[modes]]
name = "Media-Playback"

# Bad: Ambiguous
[[modes]]
name = "Mode3"
</code></pre>
<h3 id="2-assign-consistent-color-themes"><a class="header" href="#2-assign-consistent-color-themes">2. Assign Consistent Color Themes</a></h3>
<pre><code class="language-toml"># Productivity modes: Blue family
[[modes]]
name = "Default"
color = "blue"

[[modes]]
name = "Email"
color = "blue"

# Development modes: Green family
[[modes]]
name = "Developer"
color = "green"

[[modes]]
name = "Testing"
color = "green"

# Creative modes: Purple/Magenta family
[[modes]]
name = "Media"
color = "purple"

[[modes]]
name = "Design"
color = "magenta"
</code></pre>
<h3 id="3-keep-mode-count-manageable"><a class="header" href="#3-keep-mode-count-manageable">3. Keep Mode Count Manageable</a></h3>
<p><strong>Recommended</strong>: 3-5 modes for most users</p>
<ul>
<li>Too few modes: You'll run out of pads for all your functions</li>
<li>Too many modes: You'll forget which mode you're in</li>
</ul>
<p><strong>Strategy</strong>: Group related functions into modes rather than creating a mode for every app.</p>
<h3 id="4-reserve-global-mappings-for-critical-functions"><a class="header" href="#4-reserve-global-mappings-for-critical-functions">4. Reserve Global Mappings for Critical Functions</a></h3>
<p>Only use <code>[[global_mappings]]</code> for:</p>
<ul>
<li>Mode switching itself</li>
<li>Emergency shutdowns</li>
<li>System-wide controls (volume, screen lock)</li>
<li>Functions that should work regardless of mode</li>
</ul>
<h3 id="5-use-mode-colors-for-visual-feedback"><a class="header" href="#5-use-mode-colors-for-visual-feedback">5. Use Mode Colors for Visual Feedback</a></h3>
<p>If your device supports LED feedback:</p>
<ul>
<li>Test each mode and verify the color matches the function</li>
<li>Use calming colors (blue, green) for frequent modes</li>
<li>Use attention-grabbing colors (red, yellow) for special modes</li>
</ul>
<h3 id="6-document-your-modes"><a class="header" href="#6-document-your-modes">6. Document Your Modes</a></h3>
<p>Add descriptions to help remember your layout:</p>
<pre><code class="language-toml">[[modes]]
name = "Developer"
color = "green"
# Description comments help future you remember the layout:
# Pad 0-3: Git commands (status, add, commit, push)
# Pad 4-7: Build commands (check, test, build, run)
# Pad 8-11: IDE shortcuts (format, refactor, debug, terminal)
# Pad 12-15: Project navigation (files, search, grep, docs)

[[modes.mappings]]
description = "Git status"
[modes.mappings.trigger]
type = "Note"
note = 0
[modes.mappings.action]
type = "Shell"
command = "git status"
</code></pre>
<h2 id="advanced-mode-techniques"><a class="header" href="#advanced-mode-techniques">Advanced Mode Techniques</a></h2>
<h3 id="mode-specific-timing-adjustments"><a class="header" href="#mode-specific-timing-adjustments">Mode-Specific Timing Adjustments</a></h3>
<p>Override advanced settings per mode:</p>
<pre><code class="language-toml">[advanced_settings]
chord_timeout_ms = 100
double_tap_timeout_ms = 300
hold_threshold_ms = 2000

[[modes]]
name = "Gaming"
color = "red"
# Gaming mode needs faster response
# (Note: Per-mode advanced settings not yet implemented,
#  but this is the planned syntax)
</code></pre>
<h3 id="conditional-mode-switching"><a class="header" href="#conditional-mode-switching">Conditional Mode Switching</a></h3>
<p>Combine with Conditional actions for smart mode switching:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Auto-switch to Dev mode if VS Code is active"
[global_mappings.trigger]
type = "Note"
note = 15
[global_mappings.action]
type = "Conditional"
condition = "ActiveApp"
value = "Visual Studio Code"
then_action = { type = "ModeChange", mode = "Developer" }
else_action = { type = "ModeChange", mode = "Default" }
</code></pre>
<h3 id="mode-sequences"><a class="header" href="#mode-sequences">Mode Sequences</a></h3>
<p>Chain mode changes with other actions:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Open Spotify and switch to Media mode"
[modes.mappings.trigger]
type = "Note"
note = 15
[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Launch", app = "Spotify" },
    { type = "Delay", duration_ms = 1000 },
    { type = "ModeChange", mode = "Media" }
]
</code></pre>
<h2 id="troubleshooting-modes"><a class="header" href="#troubleshooting-modes">Troubleshooting Modes</a></h2>
<h3 id="mode-not-switching"><a class="header" href="#mode-not-switching">Mode Not Switching</a></h3>
<p><strong>Symptoms</strong>: Encoder turns but mode doesn't change</p>
<p><strong>Checks</strong>:</p>
<ul>
<li>Verify <code>[[global_mappings]]</code> contains ModeChange actions</li>
<li>Check encoder is mapped correctly (use <code>cargo run --bin midi_diagnostic 2</code>)</li>
<li>Ensure mode names are spelled exactly as defined</li>
<li>Look for console output confirming mode changes</li>
</ul>
<p><strong>Debug</strong>:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
# Look for: "Mode changed: Default -&gt; Developer"
</code></pre>
<h3 id="mappings-not-working-in-mode"><a class="header" href="#mappings-not-working-in-mode">Mappings Not Working in Mode</a></h3>
<p><strong>Symptoms</strong>: Pad press does nothing in a specific mode</p>
<p><strong>Checks</strong>:</p>
<ul>
<li>Verify you're in the correct mode (check console output)</li>
<li>Confirm note numbers match (use <code>cargo run --bin pad_mapper</code>)</li>
<li>Check <code>[[modes.mappings]]</code> is properly nested under the mode</li>
<li>Ensure TOML syntax is valid</li>
</ul>
<p><strong>Test</strong>:</p>
<pre><code class="language-bash"># Add a simple test mapping to verify mode is active
[[modes.mappings]]
description = "Test mode active"
[modes.mappings.trigger]
type = "Note"
note = 0
[modes.mappings.action]
type = "Shell"
command = "echo 'Mode working!' | tee /dev/tty"
</code></pre>
<h3 id="conflicting-mappings"><a class="header" href="#conflicting-mappings">Conflicting Mappings</a></h3>
<p><strong>Symptoms</strong>: Unexpected action triggers</p>
<p><strong>Checks</strong>:</p>
<ul>
<li>Global mappings override mode mappings if using same trigger</li>
<li>Multiple modes might have similar triggers</li>
<li>Check for copy-paste errors in note numbers</li>
</ul>
<p><strong>Solution</strong>: Use unique note numbers for each function, or intentionally use the priority system:</p>
<pre><code class="language-toml"># Global: Emergency stop (works everywhere)
[[global_mappings]]
[global_mappings.trigger]
type = "LongPress"
note = 0

# Mode: Normal pad 0 function (only when not held)
[[modes.mappings]]
[modes.mappings.trigger]
type = "Note"
note = 0
</code></pre>
<h2 id="see-also-1"><a class="header" href="#see-also-1">See Also</a></h2>
<ul>
<li><a href="getting-started/first-mapping.html">First Mapping Tutorial</a> - Learn basic mapping syntax</li>
<li><a href="getting-started/../configuration/overview.html">Configuration Overview</a> - Complete config.toml structure</li>
<li><a href="getting-started/../reference/actions.html">Actions Reference</a> - All available actions including ModeChange</li>
<li><a href="getting-started/../LED_SYSTEM.html">LED System</a> - How mode colors work with LED feedback</li>
</ul>
<hr />
<p><strong>Last Updated</strong>: November 11, 2025
<strong>Implementation Status</strong>: Fully functional in current release</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration-overview"><a class="header" href="#configuration-overview">Configuration Overview</a></h1>
<h2 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h2>
<p>MIDIMon uses a single <code>config.toml</code> file to define all device settings, modes, mappings, and advanced behavior. This file uses TOML (Tom's Obvious, Minimal Language) - a human-friendly configuration format that's easy to read and edit.</p>
<p>This guide provides a comprehensive overview of the configuration structure, required sections, validation, and best practices.</p>
<h2 id="configuration-file-location"><a class="header" href="#configuration-file-location">Configuration File Location</a></h2>
<p>By default, MIDIMon looks for <code>config.toml</code> in the current working directory:</p>
<pre><code class="language-bash"># Current directory
./config.toml

# Or specify a custom location
midimon --config /path/to/my-config.toml
</code></pre>
<p><strong>Tip</strong>: Keep your <code>config.toml</code> in the project root directory for simplicity.</p>
<h2 id="toml-syntax-basics"><a class="header" href="#toml-syntax-basics">TOML Syntax Basics</a></h2>
<p>If you're new to TOML, here are the essentials:</p>
<pre><code class="language-toml"># Comments start with #

# Simple key-value pairs
name = "My Device"
port = 2

# Booleans
auto_connect = true
debug = false

# Numbers
velocity = 127
timeout_ms = 300

# Strings (use quotes)
description = "This is a description"

# Arrays
notes = [12, 13, 14, 15]
modifiers = ["cmd", "shift"]

# Tables (sections)
[section_name]
key = "value"

# Array of tables (repeated sections)
[[modes]]
name = "Mode 1"

[[modes]]
name = "Mode 2"
</code></pre>
<p><strong>Key Points</strong>:</p>
<ul>
<li>Use <code>=</code> for assignment</li>
<li>Use <code>[]</code> for sections (tables)</li>
<li>Use <code>[[]]</code> for repeating sections (arrays of tables)</li>
<li>Strings must be in quotes</li>
<li>Comments use <code>#</code></li>
</ul>
<h2 id="configuration-structure-diagram"><a class="header" href="#configuration-structure-diagram">Configuration Structure Diagram</a></h2>
<pre><code>config.toml
├── [device]                    # Device identification (optional)
│   ├── name
│   └── auto_connect
│
├── [advanced_settings]         # Timing thresholds (optional)
│   ├── chord_timeout_ms
│   ├── double_tap_timeout_ms
│   └── hold_threshold_ms
│
├── [[modes]]                   # Mode definitions (required, 1+)
│   ├── name
│   ├── color
│   └── [[modes.mappings]]      # Mode-specific mappings
│       ├── description
│       ├── [trigger]
│       └── [action]
│
└── [[global_mappings]]         # Global mappings (optional)
    ├── description
    ├── [trigger]
    └── [action]
</code></pre>
<h2 id="required-vs-optional-sections"><a class="header" href="#required-vs-optional-sections">Required vs Optional Sections</a></h2>
<h3 id="required-sections"><a class="header" href="#required-sections">Required Sections</a></h3>
<p><strong>Minimum viable config</strong>:</p>
<pre><code class="language-toml"># At least one mode is REQUIRED
[[modes]]
name = "Default"

# At least one mapping (either in modes or global) is REQUIRED
[[modes.mappings]]
description = "Example mapping"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "a"
modifiers = []
</code></pre>
<p>Without these, MIDIMon will start but won't do anything useful.</p>
<h3 id="optional-sections"><a class="header" href="#optional-sections">Optional Sections</a></h3>
<p>These enhance functionality but aren't required:</p>
<pre><code class="language-toml"># Optional: Device identification
[device]
name = "Mikro"
auto_connect = true

# Optional: Timing customization
[advanced_settings]
chord_timeout_ms = 100
double_tap_timeout_ms = 300
hold_threshold_ms = 2000

# Optional: Global mappings (work in all modes)
[[global_mappings]]
description = "Volume control"
[global_mappings.trigger]
type = "EncoderTurn"
direction = "Clockwise"
[global_mappings.action]
type = "VolumeControl"
operation = "Up"
</code></pre>
<h2 id="section-breakdown"><a class="header" href="#section-breakdown">Section Breakdown</a></h2>
<h3 id="device-section"><a class="header" href="#device-section">[device] Section</a></h3>
<p>Optional section for device identification:</p>
<pre><code class="language-toml">[device]
name = "Mikro"           # Friendly name (used in logs)
auto_connect = true      # Automatically connect to device on startup
</code></pre>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>name</code> (string): Device name for logging/display</li>
<li><code>auto_connect</code> (boolean): If true, auto-connect to first available MIDI device</li>
</ul>
<p><strong>Default behavior</strong> (if omitted): No auto-connect, manual port selection required.</p>
<h3 id="advanced_settings-section"><a class="header" href="#advanced_settings-section">[advanced_settings] Section</a></h3>
<p>Optional timing customization:</p>
<pre><code class="language-toml">[advanced_settings]
chord_timeout_ms = 100          # Max time between notes in a chord
double_tap_timeout_ms = 300     # Max time between taps for double-tap
hold_threshold_ms = 2000        # Min hold time for long press
</code></pre>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>chord_timeout_ms</code> (u64): Milliseconds to wait for additional notes in a chord (default: 100)</li>
<li><code>double_tap_timeout_ms</code> (u64): Maximum time between two taps to count as double-tap (default: 300)</li>
<li><code>hold_threshold_ms</code> (u64): Minimum hold duration for long press trigger (default: 2000)</li>
</ul>
<p><strong>Defaults</strong> (if omitted):</p>
<pre><code class="language-toml">chord_timeout_ms = 100
double_tap_timeout_ms = 300
hold_threshold_ms = 2000
</code></pre>
<p><strong>Use cases</strong>:</p>
<ul>
<li>Increase <code>chord_timeout_ms</code> for slower chord playing (e.g., 200-300ms)</li>
<li>Decrease <code>double_tap_timeout_ms</code> for faster double-tap detection (e.g., 200ms)</li>
<li>Adjust <code>hold_threshold_ms</code> for longer/shorter long-press (e.g., 1000-3000ms)</li>
</ul>
<h3 id="modes-section"><a class="header" href="#modes-section">[[modes]] Section</a></h3>
<p>Defines a mode with its mappings. <strong>At least one mode is required.</strong></p>
<pre><code class="language-toml">[[modes]]
name = "Default"              # Mode name (required, unique)
color = "blue"                # LED color theme (optional)

[[modes.mappings]]            # Mode-specific mappings (array)
description = "Copy"          # Human-readable description (optional)
[modes.mappings.trigger]      # Trigger definition (required)
type = "Note"
note = 12
[modes.mappings.action]       # Action definition (required)
type = "Keystroke"
keys = "c"
modifiers = ["cmd"]
</code></pre>
<p><strong>Mode Parameters</strong>:</p>
<ul>
<li><code>name</code> (string, required): Unique mode identifier</li>
<li><code>color</code> (string, optional): LED theme color (blue, green, purple, red, yellow, white)</li>
</ul>
<p><strong>Mapping Parameters</strong>:</p>
<ul>
<li><code>description</code> (string, optional): Human-readable description (useful for documentation)</li>
<li><code>trigger</code> (table, required): Defines what event triggers this mapping</li>
<li><code>action</code> (table, required): Defines what happens when triggered</li>
</ul>
<p><strong>Multiple modes</strong>:</p>
<pre><code class="language-toml">[[modes]]
name = "Default"
# ... mappings ...

[[modes]]
name = "Developer"
# ... mappings ...

[[modes]]
name = "Media"
# ... mappings ...
</code></pre>
<h3 id="global_mappings-section"><a class="header" href="#global_mappings-section">[[global_mappings]] Section</a></h3>
<p>Optional mappings that work in ALL modes:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Emergency exit"
[global_mappings.trigger]
type = "LongPress"
note = 0
hold_duration_ms = 3000
[global_mappings.action]
type = "Shell"
command = "killall midimon"

[[global_mappings]]
description = "Volume up"
[global_mappings.trigger]
type = "EncoderTurn"
direction = "Clockwise"
[global_mappings.action]
type = "VolumeControl"
operation = "Up"
</code></pre>
<p><strong>Use cases</strong>:</p>
<ul>
<li>Emergency shutdown</li>
<li>Mode switching</li>
<li>Volume control</li>
<li>System-wide shortcuts (screenshot, lock screen)</li>
</ul>
<p><strong>Priority</strong>: Global mappings are checked after mode-specific mappings. If a mode-specific mapping matches the same trigger, it takes precedence.</p>
<h2 id="triggers-and-actions"><a class="header" href="#triggers-and-actions">Triggers and Actions</a></h2>
<p>Every mapping consists of a <strong>trigger</strong> (what event to detect) and an <strong>action</strong> (what to do when triggered).</p>
<h3 id="common-trigger-types"><a class="header" href="#common-trigger-types">Common Trigger Types</a></h3>
<pre><code class="language-toml"># Basic note on/off
[trigger]
type = "Note"
note = 12

# Velocity-sensitive
[trigger]
type = "VelocityRange"
note = 12
min_velocity = 0
max_velocity = 40

# Long press
[trigger]
type = "LongPress"
note = 12
hold_duration_ms = 2000

# Double-tap
[trigger]
type = "DoubleTap"
note = 12
double_tap_timeout_ms = 300

# Chord (multiple notes together)
[trigger]
type = "NoteChord"
notes = [12, 13, 14]
chord_timeout_ms = 100

# Encoder rotation
[trigger]
type = "EncoderTurn"
direction = "Clockwise"  # or "CounterClockwise"

# Control change
[trigger]
type = "CC"
cc_number = 1
</code></pre>
<p>See <a href="configuration/../reference/triggers.html">Triggers Reference</a> for complete list.</p>
<h3 id="common-action-types"><a class="header" href="#common-action-types">Common Action Types</a></h3>
<pre><code class="language-toml"># Keyboard shortcut
[action]
type = "Keystroke"
keys = "c"
modifiers = ["cmd"]

# Type text
[action]
type = "Text"
text = "Hello, world!"

# Open application
[action]
type = "Launch"
app = "Terminal"

# Run shell command
[action]
type = "Shell"
command = "cargo test"

# Volume control
[action]
type = "VolumeControl"
operation = "Up"  # Up, Down, Mute, Set

# Change mode
[action]
type = "ModeChange"
mode = "next"  # next, previous, or mode name

# Sequence of actions
[action]
type = "Sequence"
actions = [
    { type = "Launch", app = "Spotify" },
    { type = "Delay", duration_ms = 1000 },
    { type = "Keystroke", keys = "space", modifiers = [] }
]
</code></pre>
<p>See <a href="configuration/../reference/actions.html">Actions Reference</a> for complete list.</p>
<h2 id="minimal-configuration-example"><a class="header" href="#minimal-configuration-example">Minimal Configuration Example</a></h2>
<p>The simplest possible working config:</p>
<pre><code class="language-toml">[[modes]]
name = "Default"

[[modes.mappings]]
description = "Test"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "a"
modifiers = []
</code></pre>
<p><strong>What this does</strong>:</p>
<ul>
<li>Creates one mode called "Default"</li>
<li>Pressing pad 12 types "A"</li>
</ul>
<h2 id="full-configuration-example"><a class="header" href="#full-configuration-example">Full Configuration Example</a></h2>
<p>A complete, production-ready config:</p>
<pre><code class="language-toml"># Device configuration
[device]
name = "Mikro"
auto_connect = true

# Advanced timing settings
[advanced_settings]
chord_timeout_ms = 100
double_tap_timeout_ms = 300
hold_threshold_ms = 2000

# Mode 1: General productivity
[[modes]]
name = "Default"
color = "blue"

[[modes.mappings]]
description = "Copy"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "c"
modifiers = ["cmd"]

[[modes.mappings]]
description = "Paste"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Keystroke"
keys = "v"
modifiers = ["cmd"]

[[modes.mappings]]
description = "Switch app"
[modes.mappings.trigger]
type = "Note"
note = 14
[modes.mappings.action]
type = "Keystroke"
keys = "tab"
modifiers = ["cmd"]

# Mode 2: Development
[[modes]]
name = "Developer"
color = "green"

[[modes.mappings]]
description = "Run tests"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Shell"
command = "cargo test"

[[modes.mappings]]
description = "Build release"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Shell"
command = "cargo build --release"

# Mode 3: Media control
[[modes]]
name = "Media"
color = "purple"

[[modes.mappings]]
description = "Play/Pause"
[modes.mappings.trigger]
type = "Note"
note = 12
[modes.mappings.action]
type = "Keystroke"
keys = "space"
modifiers = []

[[modes.mappings]]
description = "Next track"
[modes.mappings.trigger]
type = "Note"
note = 13
[modes.mappings.action]
type = "Keystroke"
keys = "right"
modifiers = ["cmd"]

# Global mappings (work in all modes)
[[global_mappings]]
description = "Emergency exit (hold 3 seconds)"
[global_mappings.trigger]
type = "LongPress"
note = 0
hold_duration_ms = 3000
[global_mappings.action]
type = "Shell"
command = "killall midimon"

[[global_mappings]]
description = "Next mode"
[global_mappings.trigger]
type = "EncoderTurn"
direction = "Clockwise"
[global_mappings.action]
type = "ModeChange"
mode = "next"

[[global_mappings]]
description = "Previous mode"
[global_mappings.trigger]
type = "EncoderTurn"
direction = "CounterClockwise"
[global_mappings.action]
type = "ModeChange"
mode = "previous"

[[global_mappings]]
description = "Volume up"
[global_mappings.trigger]
type = "Note"
note = 15
[global_mappings.action]
type = "VolumeControl"
operation = "Up"

[[global_mappings]]
description = "Volume down"
[global_mappings.trigger]
type = "Note"
note = 11
[global_mappings.action]
type = "VolumeControl"
operation = "Down"
</code></pre>
<h2 id="configuration-validation"><a class="header" href="#configuration-validation">Configuration Validation</a></h2>
<h3 id="loading-process"><a class="header" href="#loading-process">Loading Process</a></h3>
<p>When MIDIMon starts, it:</p>
<ol>
<li><strong>Locates</strong> <code>config.toml</code></li>
<li><strong>Parses</strong> TOML syntax</li>
<li><strong>Validates</strong> structure and values</li>
<li><strong>Compiles</strong> triggers and actions</li>
<li><strong>Initializes</strong> mapping engine</li>
</ol>
<h3 id="common-validation-errors"><a class="header" href="#common-validation-errors">Common Validation Errors</a></h3>
<h4 id="syntax-error"><a class="header" href="#syntax-error">Syntax Error</a></h4>
<p><strong>Error</strong>:</p>
<pre><code>TOML parse error: expected `=`, but found `:`
</code></pre>
<p><strong>Cause</strong>: Invalid TOML syntax (e.g., using <code>:</code> instead of <code>=</code>)</p>
<p><strong>Fix</strong>: Check TOML syntax rules, ensure proper formatting</p>
<hr />
<h4 id="missing-required-field"><a class="header" href="#missing-required-field">Missing Required Field</a></h4>
<p><strong>Error</strong>:</p>
<pre><code>Missing field `type` in trigger definition
</code></pre>
<p><strong>Cause</strong>: Trigger or action missing required <code>type</code> field</p>
<p><strong>Fix</strong>: Add required fields:</p>
<pre><code class="language-toml">[trigger]
type = "Note"  # Required
note = 12      # Required for Note trigger
</code></pre>
<hr />
<h4 id="invalid-field-value"><a class="header" href="#invalid-field-value">Invalid Field Value</a></h4>
<p><strong>Error</strong>:</p>
<pre><code>Invalid trigger type: 'NotePress' (expected: Note, VelocityRange, LongPress, ...)
</code></pre>
<p><strong>Cause</strong>: Typo or unsupported value</p>
<p><strong>Fix</strong>: Check spelling, refer to <a href="configuration/../reference/triggers.html">Triggers Reference</a></p>
<hr />
<h4 id="mode-name-conflict"><a class="header" href="#mode-name-conflict">Mode Name Conflict</a></h4>
<p><strong>Error</strong>:</p>
<pre><code>Duplicate mode name: 'Default'
</code></pre>
<p><strong>Cause</strong>: Two modes with the same name</p>
<p><strong>Fix</strong>: Ensure each mode has a unique name</p>
<hr />
<h4 id="no-mappings-defined"><a class="header" href="#no-mappings-defined">No Mappings Defined</a></h4>
<p><strong>Warning</strong> (not an error, but MIDIMon won't do anything):</p>
<pre><code>Warning: No mappings defined. Controller won't trigger any actions.
</code></pre>
<p><strong>Fix</strong>: Add at least one mapping in a mode or global_mappings</p>
<h3 id="validation-checklist"><a class="header" href="#validation-checklist">Validation Checklist</a></h3>
<p>Before running MIDIMon, verify:</p>
<ul>
<li><input disabled="" type="checkbox"/>
TOML syntax is valid (use <code>cargo check</code> or online TOML validator)</li>
<li><input disabled="" type="checkbox"/>
At least one <code>[[modes]]</code> section exists</li>
<li><input disabled="" type="checkbox"/>
Each mode has a unique <code>name</code></li>
<li><input disabled="" type="checkbox"/>
At least one mapping exists (in modes or global)</li>
<li><input disabled="" type="checkbox"/>
Every mapping has both <code>trigger</code> and <code>action</code></li>
<li><input disabled="" type="checkbox"/>
All trigger/action types are spelled correctly</li>
<li><input disabled="" type="checkbox"/>
Note numbers match your device (use <code>pad_mapper</code> to verify)</li>
<li><input disabled="" type="checkbox"/>
File is saved as UTF-8 (not UTF-16 or other encoding)</li>
</ul>
<h2 id="configuration-tips-and-best-practices"><a class="header" href="#configuration-tips-and-best-practices">Configuration Tips and Best Practices</a></h2>
<h3 id="1-use-comments-liberally"><a class="header" href="#1-use-comments-liberally">1. Use Comments Liberally</a></h3>
<pre><code class="language-toml"># ===================================
# MODE 1: General Productivity
# ===================================
[[modes]]
name = "Default"
color = "blue"

# Pad layout:
# 12=Copy  13=Paste  14=Undo  15=Redo
# 8=Save   9=Open    10=Find  11=App Switch
# 4=Cut    5=Select  6=Delete 7=Screenshot
# 0=Escape 1=Enter   2=Tab    3=Space

[[modes.mappings]]
description = "Copy (Pad 12)"
# ... trigger and action ...
</code></pre>
<h3 id="2-group-related-mappings"><a class="header" href="#2-group-related-mappings">2. Group Related Mappings</a></h3>
<pre><code class="language-toml"># Clipboard operations
[[modes.mappings]]
description = "Copy"
# ... copy mapping ...

[[modes.mappings]]
description = "Cut"
# ... cut mapping ...

[[modes.mappings]]
description = "Paste"
# ... paste mapping ...

# Navigation
[[modes.mappings]]
description = "Next tab"
# ... next tab ...
</code></pre>
<h3 id="3-use-descriptive-names"><a class="header" href="#3-use-descriptive-names">3. Use Descriptive Names</a></h3>
<pre><code class="language-toml"># Good: Clear and specific
[[modes]]
name = "Development-Rust"

# Bad: Ambiguous
[[modes]]
name = "Mode2"
</code></pre>
<h3 id="4-test-incrementally"><a class="header" href="#4-test-incrementally">4. Test Incrementally</a></h3>
<p>When building a complex config:</p>
<ol>
<li>Start with one mode and one mapping</li>
<li>Test it works</li>
<li>Add more mappings one at a time</li>
<li>Test after each addition</li>
</ol>
<h3 id="5-keep-a-backup"><a class="header" href="#5-keep-a-backup">5. Keep a Backup</a></h3>
<pre><code class="language-bash"># Before major changes
cp config.toml config.toml.backup

# Or use version control
git add config.toml
git commit -m "Add media mode mappings"
</code></pre>
<h3 id="6-use-variables-for-consistency"><a class="header" href="#6-use-variables-for-consistency">6. Use Variables (for consistency)</a></h3>
<p>While TOML doesn't have variables, you can use comments to document repeated values:</p>
<pre><code class="language-toml"># Standard velocity ranges (document once, use everywhere):
# Soft: 0-40
# Medium: 41-80
# Hard: 81-127

[[modes.mappings]]
description = "Soft press"
[modes.mappings.trigger]
type = "VelocityRange"
note = 12
min_velocity = 0    # Soft range
max_velocity = 40
# ... action ...

[[modes.mappings]]
description = "Hard press"
[modes.mappings.trigger]
type = "VelocityRange"
note = 12
min_velocity = 81   # Hard range
max_velocity = 127
# ... action ...
</code></pre>
<h2 id="configuration-hot-reloading-future-feature"><a class="header" href="#configuration-hot-reloading-future-feature">Configuration Hot-Reloading (Future Feature)</a></h2>
<p><strong>Note</strong>: Config hot-reloading is not yet implemented in the current version. To reload config changes:</p>
<pre><code class="language-bash"># Current workaround: Restart MIDIMon
killall midimon
./target/release/midimon 2
</code></pre>
<p><strong>Planned feature</strong> (Phase 2):</p>
<ul>
<li>Watch <code>config.toml</code> for changes</li>
<li>Automatically reload without restarting</li>
<li>Validate before applying (no downtime on errors)</li>
</ul>
<h2 id="see-also-2"><a class="header" href="#see-also-2">See Also</a></h2>
<ul>
<li><a href="configuration/../getting-started/modes.html">Modes Guide</a> - Deep dive into modes</li>
<li><a href="configuration/../reference/triggers.html">Triggers Reference</a> - All trigger types</li>
<li><a href="configuration/../reference/actions.html">Actions Reference</a> - All action types</li>
<li><a href="configuration/../getting-started/first-mapping.html">First Mapping Tutorial</a> - Step-by-step guide</li>
<li><a href="https://toml.io/">TOML Specification</a> - Official TOML documentation</li>
</ul>
<h2 id="troubleshooting-2"><a class="header" href="#troubleshooting-2">Troubleshooting</a></h2>
<h3 id="config-not-loading"><a class="header" href="#config-not-loading">Config Not Loading</a></h3>
<p><strong>Problem</strong>: MIDIMon says "Config file not found"</p>
<p><strong>Solutions</strong>:</p>
<pre><code class="language-bash"># Check file exists
ls -la config.toml

# Check current directory
pwd

# Specify full path
./midimon --config /full/path/to/config.toml
</code></pre>
<hr />
<h3 id="syntax-errors"><a class="header" href="#syntax-errors">Syntax Errors</a></h3>
<p><strong>Problem</strong>: "TOML parse error"</p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>Validate TOML syntax online: https://www.toml-lint.com/</li>
<li>Check quotes, brackets, and indentation</li>
<li>Look for typos in section names</li>
</ol>
<hr />
<h3 id="mappings-not-working"><a class="header" href="#mappings-not-working">Mappings Not Working</a></h3>
<p><strong>Problem</strong>: Config loads but pads don't trigger actions</p>
<p><strong>Debug steps</strong>:</p>
<pre><code class="language-bash"># 1. Verify note numbers
cargo run --bin pad_mapper

# 2. Enable debug logging
DEBUG=1 cargo run --release 2

# 3. Check MIDI events
cargo run --bin midi_diagnostic 2
</code></pre>
<p>See <a href="configuration/../troubleshooting/common-issues.html">Common Issues</a> for more troubleshooting.</p>
<hr />
<p><strong>Last Updated</strong>: November 11, 2025
<strong>Config Version</strong>: 0.1 (current implementation)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="triggers-reference"><a class="header" href="#triggers-reference">Triggers Reference</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-3"><a class="header" href="#coming-soon-3">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="configuration/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="actions-reference"><a class="header" href="#actions-reference">Actions Reference</a></h1>
<p>Actions define what happens when a trigger condition is met. MIDIMon supports a rich set of action types that can be composed in powerful ways.</p>
<h2 id="quick-reference"><a class="header" href="#quick-reference">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Action Type</th><th>Description</th><th>Complexity</th></tr></thead><tbody>
<tr><td><a href="configuration/actions.html#keystroke">Keystroke</a></td><td>Send keyboard shortcuts</td><td>Simple</td></tr>
<tr><td><a href="configuration/actions.html#text">Text</a></td><td>Type text strings</td><td>Simple</td></tr>
<tr><td><a href="configuration/actions.html#launch">Launch</a></td><td>Open applications</td><td>Simple</td></tr>
<tr><td><a href="configuration/actions.html#shell">Shell</a></td><td>Execute shell commands</td><td>Simple</td></tr>
<tr><td><a href="configuration/actions.html#sequence">Sequence</a></td><td>Chain multiple actions</td><td>Moderate</td></tr>
<tr><td><a href="configuration/actions.html#delay">Delay</a></td><td>Add timing control</td><td>Simple</td></tr>
<tr><td><a href="configuration/actions.html#mouseclickcode%3E">MouseClick</a></td><td>Simulate mouse clicks</td><td>Simple</td></tr>
<tr><td><a href="configuration/actions.html#repeat">Repeat</a></td><td>Repeat actions N times</td><td>Moderate</td></tr>
<tr><td><a href="configuration/actions.html#conditional">Conditional</a></td><td>Conditional execution</td><td>Advanced</td></tr>
</tbody></table>
</div>
<h2 id="simple-actions"><a class="header" href="#simple-actions">Simple Actions</a></h2>
<h3 id="keystroke"><a class="header" href="#keystroke">Keystroke</a></h3>
<p>Send keyboard shortcuts with modifiers. The most common action type for productivity workflows.</p>
<pre><code class="language-toml"># Single key
[modes.mappings.action]
type = "Keystroke"
keys = "space"

# With modifiers
[modes.mappings.action]
type = "Keystroke"
keys = "c"
modifiers = ["cmd"]  # Cmd+C

# Multiple modifiers
[modes.mappings.action]
type = "Keystroke"
keys = "t"
modifiers = ["cmd", "shift"]  # Cmd+Shift+T
</code></pre>
<p><strong>Available Modifiers</strong>:</p>
<ul>
<li><code>cmd</code> / <code>command</code> / <code>meta</code> - Command key (macOS) / Windows key</li>
<li><code>ctrl</code> / <code>control</code> - Control key</li>
<li><code>alt</code> / <code>option</code> - Alt/Option key</li>
<li><code>shift</code> - Shift key</li>
</ul>
<p><strong>Special Keys</strong>:</p>
<ul>
<li>Navigation: <code>up</code>, <code>down</code>, <code>left</code>, <code>right</code>, <code>home</code>, <code>end</code>, <code>pageup</code>, <code>pagedown</code></li>
<li>Editing: <code>backspace</code>, <code>delete</code>, <code>tab</code>, <code>return</code>, <code>enter</code>, <code>escape</code>, <code>esc</code></li>
<li>Function: <code>f1</code> through <code>f12</code></li>
<li>Other: <code>space</code></li>
</ul>
<h3 id="text"><a class="header" href="#text">Text</a></h3>
<p>Type arbitrary text strings with full Unicode support. Uses keyboard simulation to type character-by-character, making it reliable for Unicode and complex text.</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Text"
text = "Hello, World!"
</code></pre>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Email signatures and contact information</li>
<li>Code snippets and boilerplate</li>
<li>Commonly used phrases and templates</li>
<li>Form auto-fill with saved data</li>
<li>Multi-language text input</li>
<li>Text expansion (abbreviation → full text)</li>
</ul>
<p><strong>Advanced Examples</strong>:</p>
<p><strong>Multi-line Code Snippet</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Text"
text = """
fn main() {
    println!(\"Hello, World!\");
}
"""
</code></pre>
<p><strong>Email Signature</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Text"
text = """
Best regards,
John Doe
Senior Developer
john@example.com
"""
</code></pre>
<p><strong>Unicode and Emoji</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Text"
text = "✅ Task completed! 🎉"
</code></pre>
<p><strong>Special Characters</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Text"
text = "!@#$%^&amp;*()_+-=[]{}|;':\",./&lt;&gt;?"
</code></pre>
<p><strong>Slow Typing for Laggy UIs</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Text", text = "user" },
    { type = "Delay", ms = 100 },
    { type = "Text", text = "name" },
    { type = "Delay", ms = 100 },
    { type = "Text", text = "123" }
]
</code></pre>
<p><strong>TOML String Escaping Tips</strong>:</p>
<ul>
<li>Escape quotes: <code>"He said \"hello\""</code></li>
<li>Multiline strings: <code>"""Line 1\nLine 2"""</code></li>
<li>Literal strings (no escaping): <code>'C:\Users\file.txt'</code></li>
<li>Backslashes: Double them <code>\\</code> or use literal strings</li>
</ul>
<p><strong>Platform Behavior</strong>:</p>
<ul>
<li>Does NOT use clipboard (leaves clipboard unchanged)</li>
<li>Types character-by-character via keyboard simulation</li>
<li>Respects active keyboard layout</li>
<li>Requires text input focus in target app</li>
</ul>
<p><strong>Troubleshooting</strong>:</p>
<ul>
<li>If text doesn't type: Ensure app has input focus</li>
<li>If Unicode fails: Check app supports UTF-8</li>
<li>If too fast: Use Sequence with Delay actions</li>
<li>If wrong characters: Check keyboard layout or escape TOML strings</li>
</ul>
<h3 id="launch"><a class="header" href="#launch">Launch</a></h3>
<p>Open applications by name or path. Simple, cross-platform application launcher.</p>
<p><strong>Basic Usage</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Launch"
app = "Terminal"  # macOS application name
</code></pre>
<p><strong>Full Path</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Launch"
app = "/Applications/Utilities/Terminal.app"
</code></pre>
<p><strong>Script Execution</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Launch"
app = "/Users/username/scripts/backup.sh"  # Must have execute permissions (chmod +x)
</code></pre>
<p><strong>Multiple Apps (Streaming Setup)</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Launch", app = "OBS" },
    { type = "Delay", ms = 2000 },  # Wait for OBS to load
    { type = "Launch", app = "Discord" },
    { type = "Delay", ms = 1000 },
    { type = "Launch", app = "Spotify" }
]
</code></pre>
<p><strong>Development Environment</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Launch", app = "Visual Studio Code" },
    { type = "Delay", ms = 1500 },
    { type = "Launch", app = "Terminal" },
    { type = "Delay", ms = 500 },
    { type = "Launch", app = "Safari" }
]
</code></pre>
<p><strong>Platform Behavior</strong>:</p>
<ul>
<li><strong>macOS</strong>: Uses <code>open -a</code> command
<ul>
<li>App names: "Safari", "Visual Studio Code", "Logic Pro"</li>
<li>Full paths: "/Applications/Safari.app"</li>
<li>If running, brings to front (doesn't launch duplicate)</li>
</ul>
</li>
<li><strong>Linux</strong>: Direct executable launch
<ul>
<li>Requires full path or executable in $PATH</li>
<li>Typically launches new instance even if running</li>
</ul>
</li>
<li><strong>Windows</strong>: Uses <code>cmd /C start</code> command
<ul>
<li>Accepts app names or paths</li>
<li>Uses file associations</li>
</ul>
</li>
</ul>
<p><strong>Troubleshooting</strong>:</p>
<ul>
<li>Test manually: <code>open -a "App Name"</code> (macOS) or <code>which app-name</code> (Linux)</li>
<li>Enable debug logging: <code>DEBUG=1 cargo run --release 2</code></li>
<li>Use full paths if app names don't work</li>
<li>Ensure scripts have execute permissions: <code>chmod +x script.sh</code></li>
</ul>
<h3 id="shell"><a class="header" href="#shell">Shell</a></h3>
<p>Execute arbitrary shell commands. Provides full system access.</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Shell"
command = "git status"
</code></pre>
<p><strong>Common Examples</strong>:</p>
<pre><code class="language-toml"># Git operations
command = "git add . &amp;&amp; git commit -m 'quick save'"

# System info
command = "system_profiler SPUSBDataType | grep -i mikro"

# File operations
command = "open ~/Downloads"

# AppleScript (macOS)
command = "osascript -e 'display notification \"MIDI triggered!\"'"
</code></pre>
<h2 id="timing--flow-control"><a class="header" href="#timing--flow-control">Timing &amp; Flow Control</a></h2>
<h3 id="delay"><a class="header" href="#delay">Delay</a></h3>
<p>Add pauses between actions in sequences.</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Delay"
ms = 500  # 500 milliseconds
</code></pre>
<p><strong>Typical Uses</strong>:</p>
<ul>
<li>Wait for UI to load</li>
<li>Slow down rapid automation</li>
<li>Add deliberate pacing to sequences</li>
</ul>
<h3 id="sequence"><a class="header" href="#sequence">Sequence</a></h3>
<p>Execute multiple actions in order. Automatic 50ms delay between actions.</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Keystroke", keys = "space", modifiers = ["cmd"] },  # Spotlight
    { type = "Delay", ms = 200 },  # Wait for Spotlight
    { type = "Text", text = "Terminal" },
    { type = "Keystroke", keys = "return" }  # Launch
]
</code></pre>
<p><strong>Design Patterns</strong>:</p>
<p><strong>1. Application Launcher</strong>:</p>
<pre><code class="language-toml">type = "Sequence"
actions = [
    { type = "Keystroke", keys = "space", modifiers = ["cmd"] },
    { type = "Delay", ms = 100 },
    { type = "Text", text = "VS Code" },
    { type = "Keystroke", keys = "return" }
]
</code></pre>
<p><strong>2. File Workflow</strong>:</p>
<pre><code class="language-toml">type = "Sequence"
actions = [
    { type = "Keystroke", keys = "s", modifiers = ["cmd"] },  # Save
    { type = "Delay", ms = 100 },
    { type = "Keystroke", keys = "w", modifiers = ["cmd"] },  # Close
    { type = "Delay", ms = 50 },
    { type = "Keystroke", keys = "down" },  # Next file
    { type = "Keystroke", keys = "return" }  # Open
]
</code></pre>
<p><strong>3. Git Workflow</strong>:</p>
<pre><code class="language-toml">type = "Sequence"
actions = [
    { type = "Shell", command = "git add -A" },
    { type = "Delay", ms = 100 },
    { type = "Shell", command = "git commit -m 'quick save'" },
    { type = "Delay", ms = 100 },
    { type = "Shell", command = "git push" }
]
</code></pre>
<h3 id="repeat"><a class="header" href="#repeat">Repeat</a></h3>
<p>Repeat an action (or sequence) multiple times.</p>
<pre><code class="language-toml"># Simple repeat: scroll down 10 times
[modes.mappings.action]
type = "Repeat"
count = 10
action = { type = "Keystroke", keys = "down" }
</code></pre>
<p><strong>With Delay Between Iterations</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Repeat"
count = 5
delay_between_ms = 200  # 200ms between each press
action = { type = "Keystroke", keys = "down" }
</code></pre>
<p><strong>Repeat a Sequence</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Repeat"
count = 3
delay_between_ms = 1000
action = {
    type = "Sequence",
    actions = [
        { type = "Keystroke", keys = "down" },  # Select next item
        { type = "Delay", ms = 100 },
        { type = "Keystroke", keys = "return" },  # Open
        { type = "Delay", ms = 500 },
        { type = "Keystroke", keys = "w", modifiers = ["cmd"] }  # Close
    ]
}
</code></pre>
<p><strong>Error Handling</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Repeat"
count = 3
delay_between_ms = 2000
stop_on_error = true  # Stop if any iteration fails
action = { type = "Launch", app = "Xcode" }
</code></pre>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>count</code> (required): Number of repetitions (0 = no-op, 1 = run once)</li>
<li><code>action</code> (required): Action to repeat</li>
<li><code>delay_between_ms</code> (optional): Delay between iterations (not after last)</li>
<li><code>stop_on_error</code> (optional): Stop on first failure (default: false)</li>
</ul>
<p><strong>Edge Cases</strong>:</p>
<ul>
<li><code>count = 0</code> is valid (no-op)</li>
<li><code>count = 1</code> executes once with no delay</li>
<li>Nested repeats multiply: 10 outer × 5 inner = 50 total</li>
<li>Large counts (&gt;1000) may appear as hang</li>
<li>Blocking operation - cannot interrupt</li>
</ul>
<p><strong>Use Cases</strong>:</p>
<ol>
<li><strong>Pagination</strong>: Scroll through long lists</li>
<li><strong>Batch Processing</strong>: Repeat workflow on multiple items</li>
<li><strong>Velocity Mapping</strong>: Different repeat counts for soft/medium/hard presses</li>
<li><strong>Retry Logic</strong>: Try launching app multiple times</li>
</ol>
<h2 id="mouse-actions"><a class="header" href="#mouse-actions">Mouse Actions</a></h2>
<h3 id="mouseclick"><a class="header" href="#mouseclick">MouseClick</a></h3>
<p>Simulate mouse clicks with optional positioning.</p>
<pre><code class="language-toml"># Click at current cursor position
[modes.mappings.action]
type = "MouseClick"
button = "Left"

# Click at specific coordinates
[modes.mappings.action]
type = "MouseClick"
button = "Right"
x = 500
y = 300
</code></pre>
<p><strong>Button Options</strong>: <code>Left</code>, <code>Right</code>, <code>Middle</code></p>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Click UI elements at fixed positions</li>
<li>Context menu automation</li>
<li>Drag-and-drop workflows (with sequences)</li>
</ul>
<h2 id="advanced-actions"><a class="header" href="#advanced-actions">Advanced Actions</a></h2>
<h3 id="conditional"><a class="header" href="#conditional">Conditional</a></h3>
<p>Execute actions based on runtime conditions (app state, time, modifiers).</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Conditional"
conditions = [
    { type = "AppRunning", bundle_id = "com.apple.Logic" }
]
operator = "And"
then_action = { type = "Keystroke", keys = "space" }
else_action = { type = "Launch", app = "Logic Pro" }
</code></pre>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>conditions</code> (array): Array of condition objects</li>
<li><code>operator</code> (string, optional): "And" or "Or" (default: "And")</li>
<li><code>then_action</code> (object): Action when conditions are true</li>
<li><code>else_action</code> (object, optional): Action when conditions are false</li>
</ul>
<p><strong>Condition Types</strong>:</p>
<p><strong>AppRunning / AppNotRunning</strong> - Check if app is running:</p>
<pre><code class="language-toml">{ type = "AppRunning", bundle_id = "com.spotify.client" }
{ type = "AppNotRunning", bundle_id = "com.microsoft.VSCode" }
</code></pre>
<p><strong>TimeRange</strong> - Check current time:</p>
<pre><code class="language-toml">{ type = "TimeRange", start = "09:00", end = "17:00" }  # 24-hour format
</code></pre>
<p><strong>DayOfWeek</strong> - Check day of week:</p>
<pre><code class="language-toml">{ type = "DayOfWeek", days = ["Mon", "Tue", "Wed", "Thu", "Fri"] }
</code></pre>
<p><strong>ModifierPressed</strong> - Check if modifier key is held:</p>
<pre><code class="language-toml">{ type = "ModifierPressed", modifier = "Shift" }  # Shift, Ctrl, Cmd, Alt
</code></pre>
<p><strong>ModeActive</strong> - Check active mode:</p>
<pre><code class="language-toml">{ type = "ModeActive", mode = 1 }  # Zero-based index
</code></pre>
<p><strong>Example - Time-based launcher</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Conditional"
conditions = [
    { type = "TimeRange", start = "09:00", end = "17:00" },
    { type = "DayOfWeek", days = ["Mon", "Tue", "Wed", "Thu", "Fri"] }
]
operator = "And"
then_action = { type = "Launch", app = "Slack" }  # Work app
else_action = { type = "Launch", app = "Discord" }  # Personal app
</code></pre>
<p><strong>Example - Nested conditionals</strong>:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Conditional"
conditions = [{ type = "TimeRange", start = "09:00", end = "17:00" }]
then_action = {
    type = "Conditional",
    conditions = [{ type = "AppRunning", bundle_id = "com.microsoft.VSCode" }],
    then_action = { type = "Keystroke", keys = "b", modifiers = ["cmd", "shift"] },
    else_action = { type = "Launch", app = "Visual Studio Code" }
}
else_action = { type = "Launch", app = "Spotify" }
</code></pre>
<h2 id="action-composition-patterns"><a class="header" href="#action-composition-patterns">Action Composition Patterns</a></h2>
<h3 id="1-velocity-based-repeat-count"><a class="header" href="#1-velocity-based-repeat-count">1. Velocity-Based Repeat Count</a></h3>
<p>Different repeat counts based on how hard you hit the pad:</p>
<pre><code class="language-toml">[modes.mappings.trigger]
type = "VelocityRange"
note = 10
ranges = [
    # Soft: repeat 3 times
    { min = 0, max = 40, action = {
        type = "Repeat",
        count = 3,
        action = { type = "Keystroke", keys = "down" }
    }},
    # Medium: repeat 5 times
    { min = 41, max = 80, action = {
        type = "Repeat",
        count = 5,
        action = { type = "Keystroke", keys = "down" }
    }},
    # Hard: repeat 10 times
    { min = 81, max = 127, action = {
        type = "Repeat",
        count = 10,
        action = { type = "Keystroke", keys = "down" }
    }}
]
</code></pre>
<h3 id="2-nested-repeats"><a class="header" href="#2-nested-repeats">2. Nested Repeats</a></h3>
<p>Multiply effect (use with caution!):</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Repeat"
count = 3  # Outer loop
action = {
    type = "Repeat",
    count = 5,  # Inner loop → 3 × 5 = 15 total
    action = { type = "Keystroke", keys = "down" }
}
</code></pre>
<h3 id="3-complex-automation-workflow"><a class="header" href="#3-complex-automation-workflow">3. Complex Automation Workflow</a></h3>
<p>Combine sequences, repeats, and delays:</p>
<pre><code class="language-toml">[modes.mappings.action]
type = "Sequence"
actions = [
    # Open file browser
    { type = "Keystroke", keys = "o", modifiers = ["cmd"] },
    { type = "Delay", ms = 500 },

    # Navigate to folder
    { type = "Keystroke", keys = "g", modifiers = ["cmd", "shift"] },
    { type = "Delay", ms = 200 },
    { type = "Text", text = "~/Downloads" },
    { type = "Keystroke", keys = "return" },
    { type = "Delay", ms = 500 },

    # Process first 3 files
    { type = "Repeat", count = 3, delay_between_ms = 1000, action = {
        type = "Sequence",
        actions = [
            { type = "Keystroke", keys = "return" },  # Open file
            { type = "Delay", ms = 800 },
            { type = "Keystroke", keys = "e", modifiers = ["cmd"] },  # Export
            { type = "Delay", ms = 500 },
            { type = "Keystroke", keys = "return" },  # Confirm
            { type = "Delay", ms = 1000 },
            { type = "Keystroke", keys = "w", modifiers = ["cmd"] },  # Close
            { type = "Delay", ms = 200 },
            { type = "Keystroke", keys = "down" }  # Next file
        ]
    }}
]
</code></pre>
<h2 id="performance--best-practices"><a class="header" href="#performance--best-practices">Performance &amp; Best Practices</a></h2>
<h3 id="timing-guidelines"><a class="header" href="#timing-guidelines">Timing Guidelines</a></h3>
<ul>
<li><strong>Keystroke</strong>: Instant (&lt;1ms)</li>
<li><strong>Text</strong>: ~10ms per character</li>
<li><strong>Launch</strong>: 100-2000ms (app dependent)</li>
<li><strong>Shell</strong>: Variable (command dependent)</li>
<li><strong>Sequence</strong>: 50ms auto-delay between actions</li>
<li><strong>Delay</strong>: As specified</li>
<li><strong>MouseClick</strong>: &lt;5ms</li>
<li><strong>Repeat</strong>: count × (action time + delay_between_ms)</li>
</ul>
<h3 id="optimization-tips"><a class="header" href="#optimization-tips">Optimization Tips</a></h3>
<ol>
<li><strong>Minimize Delays</strong>: Only add delays where needed (UI loading, animations)</li>
<li><strong>Batch Operations</strong>: Use Sequence instead of multiple mappings</li>
<li><strong>Avoid High-Frequency Repeats</strong>: Add <code>delay_between_ms</code> for rapid repeats</li>
<li><strong>Test Incrementally</strong>: Start with count=1, then increase</li>
<li><strong>Consider User Experience</strong>: Long-running actions should have feedback</li>
</ol>
<h3 id="common-pitfalls"><a class="header" href="#common-pitfalls">Common Pitfalls</a></h3>
<ol>
<li><strong>Blocking Operations</strong>: Repeats and sequences block - cannot interrupt</li>
<li><strong>Timing Fragility</strong>: UI timing varies by system load</li>
<li><strong>Nested Explosions</strong>: 10 × 10 nested repeat = 100 executions</li>
<li><strong>Error Swallowing</strong>: <code>stop_on_error = false</code> continues silently</li>
</ol>
<h3 id="debugging-actions"><a class="header" href="#debugging-actions">Debugging Actions</a></h3>
<p>Enable debug mode to see action execution:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
<p>Watch for:</p>
<ul>
<li>Action start/completion logs</li>
<li>Timing between actions</li>
<li>Error messages</li>
<li>Repeat iteration counts</li>
</ul>
<h2 id="see-also-3"><a class="header" href="#see-also-3">See Also</a></h2>
<ul>
<li><a href="configuration/../reference/action-types.html">Action Types Reference</a> - Complete technical specifications</li>
<li><a href="configuration/examples.html">Configuration Examples</a> - Real-world configuration patterns</li>
<li><a href="configuration/../reference/trigger-types.html">Trigger Types</a> - Trigger configuration reference</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="modes-system"><a class="header" href="#modes-system">Modes System</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-4"><a class="header" href="#coming-soon-4">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="configuration/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="led-feedback-configuration"><a class="header" href="#led-feedback-configuration">LED Feedback Configuration</a></h1>
<p>MIDIMon provides rich LED feedback for MIDI controllers with comprehensive support for RGB control (HID devices) and basic on/off control (MIDI devices).</p>
<h2 id="quick-start-1"><a class="header" href="#quick-start-1">Quick Start</a></h2>
<h3 id="command-line-usage"><a class="header" href="#command-line-usage">Command-Line Usage</a></h3>
<p>The fastest way to enable LED feedback is via command-line flags:</p>
<pre><code class="language-bash"># Start with reactive velocity feedback (recommended)
cargo run --release 2 --led reactive

# Try different schemes
cargo run --release 2 --led rainbow
cargo run --release 2 --led static
cargo run --release 2 --led off
</code></pre>
<h3 id="available-schemes"><a class="header" href="#available-schemes">Available Schemes</a></h3>
<p>Choose from 10 built-in lighting schemes:</p>
<ul>
<li><strong>off</strong> - All LEDs disabled</li>
<li><strong>static</strong> - Solid color based on current mode</li>
<li><strong>breathing</strong> - Slow 2-second breathing effect</li>
<li><strong>pulse</strong> - Fast 500ms pulse</li>
<li><strong>rainbow</strong> - Rainbow cycle across pads</li>
<li><strong>wave</strong> - Wave pattern animation</li>
<li><strong>sparkle</strong> - Random sparkles</li>
<li><strong>reactive</strong> - Velocity-based colors (green/yellow/red)</li>
<li><strong>vumeter</strong> - VU meter style (bottom-up)</li>
<li><strong>spiral</strong> - Spiral pattern animation</li>
</ul>
<h2 id="configuration-file"><a class="header" href="#configuration-file">Configuration File</a></h2>
<h3 id="basic-setup"><a class="header" href="#basic-setup">Basic Setup</a></h3>
<p>Add LED settings to your <code>config.toml</code>:</p>
<pre><code class="language-toml">[device]
name = "Mikro"
led_feedback = true  # Enable LED control

[led_settings]
scheme = "reactive"  # Default scheme
brightness = 255     # Full brightness (0-255)
</code></pre>
<h3 id="reactive-scheme-velocity-feedback"><a class="header" href="#reactive-scheme-velocity-feedback">Reactive Scheme (Velocity Feedback)</a></h3>
<p>The most commonly used scheme, providing color-coded velocity feedback:</p>
<pre><code class="language-toml">[led_settings]
scheme = "reactive"

[led_settings.reactive]
# Velocity ranges and colors
soft_color = { r = 0, g = 255, b = 0 }      # Green (0-40)
medium_color = { r = 255, g = 255, b = 0 }  # Yellow (41-80)
hard_color = { r = 255, g = 0, b = 0 }      # Red (81-127)

# Fade behavior
fade_duration_ms = 1000  # Wait 1s before fading
fade_steps = 10          # Number of fade steps (smoother = more steps)
</code></pre>
<p><strong>Visual Example:</strong></p>
<ul>
<li>Soft tap → 🟢 Green LED</li>
<li>Medium tap → 🟡 Yellow LED</li>
<li>Hard hit → 🔴 Red LED</li>
<li>After 1 second → Smooth fade to mode color</li>
</ul>
<h3 id="mode-based-colors"><a class="header" href="#mode-based-colors">Mode-Based Colors</a></h3>
<p>Each mode can have its own color scheme:</p>
<pre><code class="language-toml">[[modes]]
name = "Default"
color = "blue"
led_idle_brightness = 20      # Dim when idle
led_active_brightness = 255   # Full when pressed

[[modes]]
name = "Development"
color = "green"
led_idle_brightness = 30
led_active_brightness = 255

[[modes]]
name = "Media"
color = "purple"
led_idle_brightness = 15
led_active_brightness = 200
</code></pre>
<p><strong>Supported Colors:</strong></p>
<ul>
<li><code>"blue"</code> - (0, 100, 255)</li>
<li><code>"green"</code> - (0, 255, 0)</li>
<li><code>"red"</code> - (255, 0, 0)</li>
<li><code>"purple"</code> - (200, 0, 255)</li>
<li><code>"yellow"</code> - (255, 255, 0)</li>
<li><code>"cyan"</code> - (0, 255, 255)</li>
<li><code>"white"</code> - (255, 255, 255)</li>
<li>Custom: <code>{ r = 128, g = 64, b = 200 }</code></li>
</ul>
<h3 id="mode-transition-effects"><a class="header" href="#mode-transition-effects">Mode Transition Effects</a></h3>
<p>Add visual effects when switching modes:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Next Mode with Sweep Effect"
[global_mappings.trigger]
type = "EncoderTurn"
cc = 1
direction = "Clockwise"
[global_mappings.action]
type = "ModeChange"
mode = 1
relative = true
transition_effect = "Sweep"
</code></pre>
<p><strong>Transition Effects:</strong></p>
<pre><code class="language-toml">[led_settings.transitions]
enable_effects = true
flash_duration_ms = 150   # Flash effect (white → off → new color)
sweep_delay_ms = 30       # Sweep effect (left-to-right wave)
fadeout_steps = 10        # FadeOut effect (smooth color transition)
spiral_delay_ms = 15      # Spiral effect (center-outward)
</code></pre>
<p><strong>Available Effects:</strong></p>
<ul>
<li><strong>Flash</strong> - Quick white flash (150ms) - fast mode switching</li>
<li><strong>Sweep</strong> - Left-to-right wave (120ms) - smooth sweep</li>
<li><strong>FadeOut</strong> - Fade old to new color (200ms) - smooth transition</li>
<li><strong>Spiral</strong> - Center-outward spiral (240ms) - artistic</li>
<li><strong>None</strong> - Instant change (0ms) - no animation</li>
</ul>
<h3 id="mode-indicator-pads"><a class="header" href="#mode-indicator-pads">Mode Indicator Pads</a></h3>
<p>Dedicate specific pads to show the current mode:</p>
<pre><code class="language-toml">[led_settings]
mode_indicator_pads = [13, 14, 15, 16]  # Bottom row
# Pad 13 = Mode 0 indicator
# Pad 14 = Mode 1 indicator
# Pad 15 = Mode 2 indicator
# Pad 16 = Mode 3 indicator
</code></pre>
<p>When in Mode 1, pad 14 will light up in green while others remain dim.</p>
<h2 id="advanced-configuration"><a class="header" href="#advanced-configuration">Advanced Configuration</a></h2>
<h3 id="animation-settings"><a class="header" href="#animation-settings">Animation Settings</a></h3>
<p>Fine-tune animation parameters for each scheme:</p>
<pre><code class="language-toml">[led_settings.breathing]
cycle_duration_ms = 2000  # 2-second breathing cycle
min_brightness = 0        # Fully off at minimum
max_brightness = 255      # Full brightness at peak

[led_settings.rainbow]
speed = 60           # Degrees per second
saturation = 255     # Full saturation
brightness = 255     # Full brightness
hue_spacing = 22.5   # Degrees between pads

[led_settings.sparkle]
spawn_rate_ms = 100  # New sparkle every 100ms
fade_duration_ms = 200  # Sparkle fades in 200ms
max_active = 4       # Max 4 sparkles at once
</code></pre>
<h3 id="hid-specific-settings-mikro-mk3"><a class="header" href="#hid-specific-settings-mikro-mk3">HID-Specific Settings (Mikro MK3)</a></h3>
<pre><code class="language-toml">[device]
name = "Mikro"
led_feedback = true
use_hid = true  # Force HID mode

[led_settings.hid]
shared_device = true  # Allow NI Controller Editor access
vendor_id = 0x17cc    # Native Instruments
product_id = 0x1700   # Maschine Mikro MK3
</code></pre>
<h3 id="midi-feedback-settings"><a class="header" href="#midi-feedback-settings">MIDI Feedback Settings</a></h3>
<p>For standard MIDI controllers:</p>
<pre><code class="language-toml">[device]
name = "Launchpad Mini"
led_feedback = true

[led_settings.midi]
note_offset = 36  # C1 (MIDI note 36) = Pad 1
channel = 0       # MIDI channel 0-15
on_velocity = 127 # Velocity for "LED on"
off_velocity = 0  # Velocity for "LED off"
</code></pre>
<h2 id="platform-specific-notes-1"><a class="header" href="#platform-specific-notes-1">Platform-Specific Notes</a></h2>
<h3 id="macos-2"><a class="header" href="#macos-2">macOS</a></h3>
<p><strong>HID devices require Input Monitoring permission:</strong></p>
<ol>
<li>Open System Settings → Privacy &amp; Security</li>
<li>Select "Input Monitoring"</li>
<li>Enable permission for Terminal or your IDE</li>
</ol>
<p><strong>Shared device mode:</strong></p>
<pre><code class="language-toml">[led_settings.hid]
shared_device = true  # Works alongside NI Controller Editor
</code></pre>
<h3 id="linux-1"><a class="header" href="#linux-1">Linux</a></h3>
<p><strong>HID devices may require udev rules:</strong></p>
<pre><code class="language-bash"># Create udev rule for Mikro MK3
sudo nano /etc/udev/rules.d/99-maschine-mikro-mk3.rules

# Add this line:
SUBSYSTEM=="usb", ATTRS{idVendor}=="17cc", ATTRS{idProduct}=="1700", MODE="0666"

# Reload rules
sudo udevadm control --reload-rules
sudo udevadm trigger
</code></pre>
<h3 id="windows-1"><a class="header" href="#windows-1">Windows</a></h3>
<p><strong>HID devices work out of the box, but may require:</strong></p>
<ul>
<li>Native Instruments drivers installed</li>
<li>USB device permissions (Windows 10+)</li>
</ul>
<h2 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h2>
<h3 id="performancelive-use"><a class="header" href="#performancelive-use">Performance/Live Use</a></h3>
<pre><code class="language-toml">[led_settings]
scheme = "reactive"  # Immediate velocity feedback
brightness = 255     # Full brightness for stage visibility
</code></pre>
<h3 id="studioproduction"><a class="header" href="#studioproduction">Studio/Production</a></h3>
<pre><code class="language-toml">[led_settings]
scheme = "static"    # Subtle, non-distracting
brightness = 50      # Dim for low-light studio
</code></pre>
<h3 id="creativevisual"><a class="header" href="#creativevisual">Creative/Visual</a></h3>
<pre><code class="language-toml">[led_settings]
scheme = "rainbow"   # Eye-catching animations
brightness = 200     # Bright but not overwhelming
</code></pre>
<h3 id="focused-work"><a class="header" href="#focused-work">Focused Work</a></h3>
<pre><code class="language-toml">[led_settings]
scheme = "off"       # No distractions
</code></pre>
<h2 id="troubleshooting-3"><a class="header" href="#troubleshooting-3">Troubleshooting</a></h2>
<h3 id="leds-not-responding"><a class="header" href="#leds-not-responding">LEDs Not Responding</a></h3>
<ol>
<li>
<p><strong>Check device connection:</strong></p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2 --led reactive
# Look for: "✓ Connected to Mikro MK3 LED interface"
</code></pre>
</li>
<li>
<p><strong>Verify permissions</strong> (macOS HID):</p>
<ul>
<li>System Settings → Privacy → Input Monitoring</li>
</ul>
</li>
<li>
<p><strong>Try MIDI fallback:</strong></p>
<pre><code class="language-toml">[device]
led_feedback = true
use_hid = false  # Force MIDI mode
</code></pre>
</li>
</ol>
<h3 id="wrong-colors"><a class="header" href="#wrong-colors">Wrong Colors</a></h3>
<ul>
<li><strong>Issue</strong>: Colors don't match expected RGB values</li>
<li><strong>Cause</strong>: LED manufacturing variance (±10%)</li>
<li><strong>Solution</strong>: Normal behavior, slight color variations expected</li>
</ul>
<h3 id="flickering"><a class="header" href="#flickering">Flickering</a></h3>
<ul>
<li><strong>Issue</strong>: LEDs flicker or strobe</li>
<li><strong>Cause</strong>: Update rate too high or USB bandwidth saturation</li>
<li><strong>Solution</strong>: Use simpler scheme (<code>reactive</code> or <code>static</code>)</li>
</ul>
<h3 id="mode-colors-not-showing"><a class="header" href="#mode-colors-not-showing">Mode Colors Not Showing</a></h3>
<ul>
<li><strong>Issue</strong>: All pads same color regardless of mode</li>
<li><strong>Cause</strong>: Using non-mode-aware scheme</li>
<li><strong>Solution</strong>: Use <code>static</code> or <code>reactive</code> scheme</li>
</ul>
<h3 id="performance-impact"><a class="header" href="#performance-impact">Performance Impact</a></h3>
<ul>
<li><strong>Issue</strong>: High CPU usage</li>
<li><strong>Cause</strong>: Complex animation scheme</li>
<li><strong>Solution</strong>: Switch to <code>reactive</code> or <code>static</code> (&lt;1% CPU)</li>
</ul>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<h3 id="example-1-simple-reactive-setup"><a class="header" href="#example-1-simple-reactive-setup">Example 1: Simple Reactive Setup</a></h3>
<pre><code class="language-toml">[device]
name = "Mikro"
led_feedback = true

[led_settings]
scheme = "reactive"

[[modes]]
name = "Default"
color = "blue"

[[modes]]
name = "Development"
color = "green"
</code></pre>
<h3 id="example-2-advanced-multi-mode-with-transitions"><a class="header" href="#example-2-advanced-multi-mode-with-transitions">Example 2: Advanced Multi-Mode with Transitions</a></h3>
<pre><code class="language-toml">[device]
name = "Mikro"
led_feedback = true

[led_settings]
scheme = "reactive"
brightness = 255

[led_settings.transitions]
enable_effects = true
flash_duration_ms = 150

[[modes]]
name = "Default"
color = "blue"
led_idle_brightness = 20
led_active_brightness = 255

[[modes]]
name = "Development"
color = "green"
led_idle_brightness = 30
led_active_brightness = 255

[[modes]]
name = "Media"
color = "purple"
led_idle_brightness = 15
led_active_brightness = 200

[[global_mappings]]
description = "Next Mode with Flash"
[global_mappings.trigger]
type = "EncoderTurn"
cc = 1
direction = "Clockwise"
[global_mappings.action]
type = "ModeChange"
mode = 1
relative = true
transition_effect = "Flash"
</code></pre>
<h3 id="example-3-studio-mode-with-indicators"><a class="header" href="#example-3-studio-mode-with-indicators">Example 3: Studio Mode with Indicators</a></h3>
<pre><code class="language-toml">[device]
name = "Mikro"
led_feedback = true

[led_settings]
scheme = "static"
brightness = 50
mode_indicator_pads = [13, 14, 15, 16]

[[modes]]
name = "Recording"
color = "red"
led_idle_brightness = 10

[[modes]]
name = "Editing"
color = "green"
led_idle_brightness = 10

[[modes]]
name = "Mixing"
color = "blue"
led_idle_brightness = 10
</code></pre>
<h2 id="performance-2"><a class="header" href="#performance-2">Performance</a></h2>
<h3 id="cpu-usage-by-scheme"><a class="header" href="#cpu-usage-by-scheme">CPU Usage by Scheme</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Scheme</th><th>CPU (Idle)</th><th>CPU (Active)</th></tr></thead><tbody>
<tr><td>off</td><td>0%</td><td>0%</td></tr>
<tr><td>static</td><td>&lt;1%</td><td>&lt;1%</td></tr>
<tr><td>reactive</td><td>&lt;1%</td><td>~1%</td></tr>
<tr><td>breathing</td><td>~1%</td><td>~1%</td></tr>
<tr><td>rainbow</td><td>~2%</td><td>~2%</td></tr>
<tr><td>sparkle</td><td>~3%</td><td>~3%</td></tr>
</tbody></table>
</div>
<h3 id="memory"><a class="header" href="#memory">Memory</a></h3>
<ul>
<li><strong>Static schemes</strong>: &lt;1MB</li>
<li><strong>Animated schemes</strong>: &lt;1MB</li>
<li><strong>Per-pad state</strong>: ~50 bytes per pad</li>
</ul>
<h3 id="update-rate"><a class="header" href="#update-rate">Update Rate</a></h3>
<ul>
<li><strong>HID devices</strong>: 10fps (100ms per frame)</li>
<li><strong>MIDI devices</strong>: Event-driven (no polling)</li>
</ul>
<h2 id="see-also-4"><a class="header" href="#see-also-4">See Also</a></h2>
<ul>
<li><a href="configuration/../reference/led-system.html">Reference → LED System</a> - Complete LED feature reference</li>
<li><a href="configuration/../reference/action-types.html">Reference → Action Types</a> - ModeChange action</li>
<li><a href="configuration/../devices/mikro-mk3.html">Device Support → Maschine Mikro MK3</a> - HID device details</li>
<li><a href="configuration/modes.html">Configuration → Modes</a> - Mode system configuration</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="device-profiles"><a class="header" href="#device-profiles">Device Profiles</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-5"><a class="header" href="#coming-soon-5">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="configuration/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration-examples"><a class="header" href="#configuration-examples">Configuration Examples</a></h1>
<p>Real-world configuration patterns for common use cases. Each example is production-ready and can be adapted to your workflow.</p>
<h2 id="table-of-contents"><a class="header" href="#table-of-contents">Table of Contents</a></h2>
<ol>
<li><a href="configuration/examples.html#basic-workflows">Basic Workflows</a></li>
<li><a href="configuration/examples.html#developer-productivity">Developer Productivity</a></li>
<li><a href="configuration/examples.html#content-creation">Content Creation</a></li>
<li><a href="configuration/examples.html#repetition--automation">Repetition &amp; Automation</a></li>
<li><a href="configuration/examples.html#advanced-patterns">Advanced Patterns</a></li>
</ol>
<h2 id="basic-workflows"><a class="header" href="#basic-workflows">Basic Workflows</a></h2>
<h3 id="application-launcher"><a class="header" href="#application-launcher">Application Launcher</a></h3>
<p>Quick launch frequently used applications:</p>
<pre><code class="language-toml">[[modes]]
name = "Launcher"
color = "blue"

[[modes.mappings]]
description = "Open Terminal"
[modes.mappings.trigger]
type = "Note"
note = 60
[modes.mappings.action]
type = "Launch"
app = "Terminal"

[[modes.mappings]]
description = "Open VS Code"
[modes.mappings.trigger]
type = "Note"
note = 61
[modes.mappings.action]
type = "Launch"
app = "Visual Studio Code"

[[modes.mappings]]
description = "Open Browser"
[modes.mappings.trigger]
type = "Note"
note = 62
[modes.mappings.action]
type = "Launch"
app = "Google Chrome"
</code></pre>
<h3 id="text-snippets"><a class="header" href="#text-snippets">Text Snippets</a></h3>
<p>Common text expansions for email and documentation:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Email signature"
[modes.mappings.trigger]
type = "Note"
note = 70
[modes.mappings.action]
type = "Text"
text = """
Best regards,
Chris Joseph
Software Engineer
chris@amiable.dev
"""

[[modes.mappings]]
description = "Code review template"
[modes.mappings.trigger]
type = "Note"
note = 71
[modes.mappings.action]
type = "Text"
text = """
## Review Checklist
- [ ] Code follows style guide
- [ ] Tests are passing
- [ ] Documentation updated
- [ ] No obvious security issues
"""
</code></pre>
<h2 id="developer-productivity"><a class="header" href="#developer-productivity">Developer Productivity</a></h2>
<h3 id="git-workflow"><a class="header" href="#git-workflow">Git Workflow</a></h3>
<p>Common git operations on a single pad:</p>
<pre><code class="language-toml">[[modes]]
name = "Git"
color = "green"

# Soft press: git status
[[modes.mappings]]
description = "Git status (soft)"
[modes.mappings.trigger]
type = "VelocityRange"
note = 60
ranges = [{ min = 0, max = 40 }]
[modes.mappings.action]
type = "Shell"
command = "git status"

# Medium press: git add &amp; commit
[[modes.mappings]]
description = "Quick commit (medium)"
[modes.mappings.trigger]
type = "VelocityRange"
note = 60
ranges = [{ min = 41, max = 80 }]
[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Shell", command = "git add -A" },
    { type = "Delay", ms = 100 },
    { type = "Shell", command = "git commit -m 'quick save'" }
]

# Hard press: commit and push
[[modes.mappings]]
description = "Commit and push (hard)"
[modes.mappings.trigger]
type = "VelocityRange"
note = 60
ranges = [{ min = 81, max = 127 }]
[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Shell", command = "git add -A" },
    { type = "Delay", ms = 100 },
    { type = "Shell", command = "git commit -m 'quick save'" },
    { type = "Delay", ms = 100 },
    { type = "Shell", command = "git push" }
]
</code></pre>
<h3 id="code-navigation"><a class="header" href="#code-navigation">Code Navigation</a></h3>
<p>Navigate code with velocity-based jumps:</p>
<pre><code class="language-toml"># Jump lines based on velocity
[[modes.mappings]]
description = "Jump down (velocity-based)"
[modes.mappings.trigger]
type = "VelocityRange"
note = 65
ranges = [
    { min = 0, max = 40, action = { type = "Keystroke", keys = "down" } },
    { min = 41, max = 80, action = { type = "Repeat", count = 5, action = { type = "Keystroke", keys = "down" } } },
    { min = 81, max = 127, action = { type = "Repeat", count = 10, action = { type = "Keystroke", keys = "down" } } }
]

# Navigate between functions
[[modes.mappings]]
description = "Next function"
[modes.mappings.trigger]
type = "Note"
note = 66
[modes.mappings.action]
type = "Keystroke"
keys = "down"
modifiers = ["cmd", "shift"]
</code></pre>
<h2 id="content-creation"><a class="header" href="#content-creation">Content Creation</a></h2>
<h3 id="video-editing"><a class="header" href="#video-editing">Video Editing</a></h3>
<p>Timeline navigation and editing:</p>
<pre><code class="language-toml">[[modes]]
name = "Video"
color = "purple"

# Play/Pause
[[modes.mappings]]
description = "Play/Pause"
[modes.mappings.trigger]
type = "Note"
note = 60
[modes.mappings.action]
type = "Keystroke"
keys = "space"

# Frame-by-frame navigation
[[modes.mappings]]
description = "Previous frame"
[modes.mappings.trigger]
type = "Note"
note = 61
[modes.mappings.action]
type = "Keystroke"
keys = "left"

[[modes.mappings]]
description = "Next frame"
[modes.mappings.trigger]
type = "Note"
note = 62
[modes.mappings.action]
type = "Keystroke"
keys = "right"

# Jump 10 frames
[[modes.mappings]]
description = "Jump forward 10 frames"
[modes.mappings.trigger]
type = "Note"
note = 63
[modes.mappings.action]
type = "Repeat"
count = 10
action = { type = "Keystroke", keys = "right" }
</code></pre>
<h3 id="document-formatting"><a class="header" href="#document-formatting">Document Formatting</a></h3>
<p>Batch formatting operations:</p>
<pre><code class="language-toml"># Apply heading and next line
[[modes.mappings]]
description = "Apply heading 2"
[modes.mappings.trigger]
type = "Note"
note = 70
[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Keystroke", keys = "home" },  # Start of line
    { type = "Text", text = "## " },
    { type = "Keystroke", keys = "end" },  # End of line
    { type = "Keystroke", keys = "return" },  # New line
]
</code></pre>
<h2 id="repetition--automation"><a class="header" href="#repetition--automation">Repetition &amp; Automation</a></h2>
<h3 id="simple-repeats"><a class="header" href="#simple-repeats">Simple Repeats</a></h3>
<p>Scroll through long lists or documents:</p>
<pre><code class="language-toml"># Scroll down 10 lines
[[modes.mappings]]
description = "Scroll down 10 lines"
[modes.mappings.trigger]
type = "Note"
note = 80
[modes.mappings.action]
type = "Repeat"
count = 10
action = { type = "Keystroke", keys = "down" }

# Slow scroll (with delay)
[[modes.mappings]]
description = "Slow scroll down"
[modes.mappings.trigger]
type = "Note"
note = 81
[modes.mappings.action]
type = "Repeat"
count = 5
delay_between_ms = 200
action = { type = "Keystroke", keys = "down" }

# Page down 5 times
[[modes.mappings]]
description = "Jump 5 pages down"
[modes.mappings.trigger]
type = "Note"
note = 82
[modes.mappings.action]
type = "Repeat"
count = 5
delay_between_ms = 300
action = { type = "Keystroke", keys = "pagedown" }
</code></pre>
<h3 id="batch-file-processing"><a class="header" href="#batch-file-processing">Batch File Processing</a></h3>
<p>Process multiple files with a repeated sequence:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Batch process 3 files"
[modes.mappings.trigger]
type = "LongPress"
note = 85
hold_duration_ms = 1500
[modes.mappings.action]
type = "Repeat"
count = 3
delay_between_ms = 1000
action = {
    type = "Sequence",
    actions = [
        { type = "Keystroke", keys = "return" },  # Open file
        { type = "Delay", ms = 800 },  # Wait for file to load
        { type = "Keystroke", keys = "e", modifiers = ["cmd"] },  # Export
        { type = "Delay", ms = 500 },
        { type = "Keystroke", keys = "return" },  # Confirm export
        { type = "Delay", ms = 1000 },  # Wait for export
        { type = "Keystroke", keys = "w", modifiers = ["cmd"] },  # Close file
        { type = "Delay", ms = 200 },
        { type = "Keystroke", keys = "down" }  # Next file
    ]
}
</code></pre>
<h3 id="velocity-based-repeats"><a class="header" href="#velocity-based-repeats">Velocity-Based Repeats</a></h3>
<p>Different repeat counts based on pad pressure:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Variable repeat based on velocity"
[modes.mappings.trigger]
type = "VelocityRange"
note = 90
ranges = [
    # Soft: repeat 3 times
    { min = 0, max = 40, action = {
        type = "Repeat",
        count = 3,
        action = { type = "Keystroke", keys = "down" }
    }},
    # Medium: repeat 5 times
    { min = 41, max = 80, action = {
        type = "Repeat",
        count = 5,
        delay_between_ms = 100,
        action = { type = "Keystroke", keys = "down" }
    }},
    # Hard: repeat 10 times
    { min = 81, max = 127, action = {
        type = "Repeat",
        count = 10,
        delay_between_ms = 50,
        action = { type = "Keystroke", keys = "down" }
    }}
]
</code></pre>
<h3 id="nested-repeats"><a class="header" href="#nested-repeats">Nested Repeats</a></h3>
<p>Multiply effect for grid or matrix operations:</p>
<pre><code class="language-toml"># Navigate a 3x5 grid (15 total moves)
[[modes.mappings]]
description = "Navigate 3x5 grid"
[modes.mappings.trigger]
type = "DoubleTap"
note = 95
max_interval_ms = 300
[modes.mappings.action]
type = "Repeat"
count = 3  # 3 rows
delay_between_ms = 500
action = {
    type = "Sequence",
    actions = [
        # Move right 5 times
        { type = "Repeat", count = 5, delay_between_ms = 100, action = { type = "Keystroke", keys = "right" } },
        # Move down 1
        { type = "Delay", ms = 200 },
        { type = "Keystroke", keys = "down" },
        # Return to start of row
        { type = "Repeat", count = 5, action = { type = "Keystroke", keys = "left" } }
    ]
}
</code></pre>
<h3 id="retry-logic"><a class="header" href="#retry-logic">Retry Logic</a></h3>
<p>Attempt operations with error tolerance:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Launch Xcode (retry 3 times)"
[modes.mappings.trigger]
type = "Note"
note = 100
[modes.mappings.action]
type = "Repeat"
count = 3
delay_between_ms = 2000
stop_on_error = false  # Continue even if already running
action = { type = "Launch", app = "Xcode" }

[[modes.mappings]]
description = "Network test (stop on first failure)"
[modes.mappings.trigger]
type = "Note"
note = 101
[modes.mappings.action]
type = "Repeat"
count = 5
delay_between_ms = 1000
stop_on_error = true  # Stop if ping fails
action = { type = "Shell", command = "ping -c 1 8.8.8.8" }
</code></pre>
<h2 id="advanced-patterns"><a class="header" href="#advanced-patterns">Advanced Patterns</a></h2>
<h3 id="spotlight-launcher"><a class="header" href="#spotlight-launcher">Spotlight Launcher</a></h3>
<p>Use Spotlight for precise app launching:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Spotlight launcher for Terminal"
[modes.mappings.trigger]
type = "Note"
note = 110
[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Keystroke", keys = "space", modifiers = ["cmd"] },  # Open Spotlight
    { type = "Delay", ms = 200 },  # Wait for Spotlight
    { type = "Text", text = "Terminal" },
    { type = "Delay", ms = 100 },
    { type = "Keystroke", keys = "return" }
]
</code></pre>
<h3 id="form-automation"><a class="header" href="#form-automation">Form Automation</a></h3>
<p>Fill complex forms with timing:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Fill registration form"
[modes.mappings.trigger]
type = "LongPress"
note = 115
hold_duration_ms = 2000
[modes.mappings.action]
type = "Sequence"
actions = [
    # First name
    { type = "Text", text = "Chris" },
    { type = "Delay", ms = 100 },
    { type = "Keystroke", keys = "tab" },
    { type = "Delay", ms = 100 },

    # Last name
    { type = "Text", text = "Joseph" },
    { type = "Delay", ms = 100 },
    { type = "Keystroke", keys = "tab" },
    { type = "Delay", ms = 100 },

    # Email
    { type = "Text", text = "chris@amiable.dev" },
    { type = "Delay", ms = 100 },
    { type = "Keystroke", keys = "tab" },
    { type = "Delay", ms = 100 },

    # Phone
    { type = "Text", text = "+1-555-123-4567" },
    { type = "Delay", ms = 200 },

    # Submit
    { type = "Keystroke", keys = "return" }
]
</code></pre>
<h3 id="multi-click-automation"><a class="header" href="#multi-click-automation">Multi-Click Automation</a></h3>
<p>Repeat mouse clicks at intervals:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Click button 5 times"
[modes.mappings.trigger]
type = "DoubleTap"
note = 120
max_interval_ms = 300
[modes.mappings.action]
type = "Repeat"
count = 5
delay_between_ms = 500
action = { type = "MouseClick", button = "Left" }

# Click at specific location repeatedly
[[modes.mappings]]
description = "Click refresh button"
[modes.mappings.trigger]
type = "Note"
note = 121
[modes.mappings.action]
type = "Repeat"
count = 3
delay_between_ms = 2000
action = { type = "MouseClick", button = "Left", x = 1200, y = 100 }
</code></pre>
<h3 id="macro-pad-layout"><a class="header" href="#macro-pad-layout">Macro Pad Layout</a></h3>
<p>Complete 16-pad layout for development:</p>
<pre><code class="language-toml">[device]
name = "Mikro"
auto_connect = true

[[modes]]
name = "Development"
color = "green"

# Row 1: Git operations
[[modes.mappings]]
description = "Git status"
[modes.mappings.trigger]
type = "Note"
note = 60
[modes.mappings.action]
type = "Shell"
command = "git status"

[[modes.mappings]]
description = "Git diff"
[modes.mappings.trigger]
type = "Note"
note = 61
[modes.mappings.action]
type = "Shell"
command = "git diff"

[[modes.mappings]]
description = "Quick commit"
[modes.mappings.trigger]
type = "Note"
note = 62
[modes.mappings.action]
type = "Sequence"
actions = [
    { type = "Shell", command = "git add -A" },
    { type = "Delay", ms = 100 },
    { type = "Shell", command = "git commit -m 'quick save'" }
]

[[modes.mappings]]
description = "Git push"
[modes.mappings.trigger]
type = "Note"
note = 63
[modes.mappings.action]
type = "Shell"
command = "git push"

# Row 2: Build &amp; test
[[modes.mappings]]
description = "Build project"
[modes.mappings.trigger]
type = "Note"
note = 64
[modes.mappings.action]
type = "Shell"
command = "cargo build"

[[modes.mappings]]
description = "Run tests"
[modes.mappings.trigger]
type = "Note"
note = 65
[modes.mappings.action]
type = "Shell"
command = "cargo test"

[[modes.mappings]]
description = "Run app"
[modes.mappings.trigger]
type = "Note"
note = 66
[modes.mappings.action]
type = "Shell"
command = "cargo run"

[[modes.mappings]]
description = "Format code"
[modes.mappings.trigger]
type = "Note"
note = 67
[modes.mappings.action]
type = "Shell"
command = "cargo fmt"

# Row 3: Navigation
[[modes.mappings]]
description = "Jump down (velocity)"
[modes.mappings.trigger]
type = "VelocityRange"
note = 68
ranges = [
    { min = 0, max = 40, action = { type = "Keystroke", keys = "down" } },
    { min = 41, max = 80, action = { type = "Repeat", count = 5, action = { type = "Keystroke", keys = "down" } } },
    { min = 81, max = 127, action = { type = "Repeat", count = 10, action = { type = "Keystroke", keys = "down" } } }
]

[[modes.mappings]]
description = "Jump up (velocity)"
[modes.mappings.trigger]
type = "VelocityRange"
note = 69
ranges = [
    { min = 0, max = 40, action = { type = "Keystroke", keys = "up" } },
    { min = 41, max = 80, action = { type = "Repeat", count = 5, action = { type = "Keystroke", keys = "up" } } },
    { min = 81, max = 127, action = { type = "Repeat", count = 10, action = { type = "Keystroke", keys = "up" } } }
]

# Row 4: Utilities
[[modes.mappings]]
description = "Open Terminal"
[modes.mappings.trigger]
type = "Note"
note = 72
[modes.mappings.action]
type = "Launch"
app = "Terminal"

[[modes.mappings]]
description = "Open VS Code"
[modes.mappings.trigger]
type = "Note"
note = 73
[modes.mappings.action]
type = "Launch"
app = "Visual Studio Code"

[[modes.mappings]]
description = "Open Browser"
[modes.mappings.trigger]
type = "Note"
note = 74
[modes.mappings.action]
type = "Launch"
app = "Google Chrome"
</code></pre>
<h3 id="context-aware-actions-conditional"><a class="header" href="#context-aware-actions-conditional">Context-Aware Actions (Conditional)</a></h3>
<p>Execute different actions based on runtime conditions like active app, time of day, or system state.</p>
<h4 id="app-based-conditional"><a class="header" href="#app-based-conditional">App-Based Conditional</a></h4>
<p>Different behavior when specific apps are running:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Context-aware play/pause"
[modes.mappings.trigger]
type = "Note"
note = 130
[modes.mappings.action]
type = "Conditional"
conditions = [
    { type = "AppRunning", bundle_id = "com.apple.Logic" }
]
then_action = { type = "Keystroke", keys = "space" }  # Logic: Space to play/pause
else_action = { type = "Keystroke", keys = "space", modifiers = ["cmd"] }  # System: Media play/pause
</code></pre>
<h4 id="time-based-automation"><a class="header" href="#time-based-automation">Time-Based Automation</a></h4>
<p>Launch different apps based on work hours:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Time-aware launcher"
[modes.mappings.trigger]
type = "Note"
note = 131
[modes.mappings.action]
type = "Conditional"
conditions = [
    { type = "TimeRange", start = "09:00", end = "17:00" },
    { type = "DayOfWeek", days = ["Mon", "Tue", "Wed", "Thu", "Fri"] }
]
operator = "And"
then_action = { type = "Launch", app = "Slack" }  # Work app during work hours
else_action = { type = "Launch", app = "Discord" }  # Personal app otherwise
</code></pre>
<h4 id="multiple-conditions-or-logic"><a class="header" href="#multiple-conditions-or-logic">Multiple Conditions (OR Logic)</a></h4>
<p>Launch file if any IDE is running:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Open project in active IDE"
[modes.mappings.trigger]
type = "Note"
note = 132
[modes.mappings.action]
type = "Conditional"
conditions = [
    { type = "AppRunning", bundle_id = "com.microsoft.VSCode" },
    { type = "AppRunning", bundle_id = "com.jetbrains.IntelliJ" },
    { type = "AppRunning", bundle_id = "com.sublimetext.4" }
]
operator = "Or"  # Any one IDE is enough
then_action = { type = "Keystroke", keys = "o", modifiers = ["cmd"] }  # Cmd+O to open file
else_action = { type = "Launch", app = "Visual Studio Code" }  # Launch IDE if none running
</code></pre>
<h4 id="modifier-based-conditional"><a class="header" href="#modifier-based-conditional">Modifier-Based Conditional</a></h4>
<p>Hold Shift for alternative behavior:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Delete or force-delete"
[modes.mappings.trigger]
type = "Note"
note = 133
[modes.mappings.action]
type = "Conditional"
conditions = [
    { type = "ModifierPressed", modifier = "Shift" }
]
then_action = { type = "Keystroke", keys = "delete", modifiers = ["cmd", "option"] }  # Force delete
else_action = { type = "Keystroke", keys = "delete", modifiers = ["cmd"] }  # Normal delete
</code></pre>
<h4 id="nested-conditionals"><a class="header" href="#nested-conditionals">Nested Conditionals</a></h4>
<p>Complex decision trees with multiple levels:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Smart launcher with time and app detection"
[modes.mappings.trigger]
type = "LongPress"
note = 135
hold_duration_ms = 1000
[modes.mappings.action]
type = "Conditional"
conditions = [
    { type = "TimeRange", start = "09:00", end = "17:00" }
]
then_action = {
    type = "Conditional",
    conditions = [
        { type = "AppRunning", bundle_id = "com.apple.Logic" }
    ],
    then_action = { type = "Keystroke", keys = "n", modifiers = ["cmd"] },  # New Logic project
    else_action = { type = "Launch", app = "Logic Pro" }  # Launch Logic
}
else_action = {
    type = "Conditional",
    conditions = [
        { type = "DayOfWeek", days = ["Sat", "Sun"] }
    ],
    then_action = { type = "Launch", app = "Spotify" },  # Weekend music
    else_action = { type = "Launch", app = "Safari" }  # Evening browsing
}
</code></pre>
<h4 id="launch-only-if-not-running"><a class="header" href="#launch-only-if-not-running">Launch Only if Not Running</a></h4>
<p>Avoid duplicate app launches:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Launch Spotify or play/pause if running"
[modes.mappings.trigger]
type = "Note"
note = 136
[modes.mappings.action]
type = "Conditional"
conditions = [
    { type = "AppNotRunning", bundle_id = "com.spotify.client" }
]
then_action = { type = "Launch", app = "Spotify" }
else_action = { type = "Keystroke", keys = "space" }  # Already running, just play/pause
</code></pre>
<h4 id="mode-aware-shortcuts"><a class="header" href="#mode-aware-shortcuts">Mode-Aware Shortcuts</a></h4>
<p>Different actions per mode using global mappings:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Mode-aware F5 key"
[global_mappings.trigger]
type = "Note"
note = 137
[global_mappings.action]
type = "Conditional"
conditions = [
    { type = "ModeActive", mode = 1 }  # Development mode
]
then_action = { type = "Shell", command = "npm test" }  # Run tests in dev mode
else_action = { type = "Keystroke", keys = "f5" }  # Refresh in other modes
</code></pre>
<h4 id="weekend-vs-weekday-behavior"><a class="header" href="#weekend-vs-weekday-behavior">Weekend vs Weekday Behavior</a></h4>
<p>Different workflows based on day of week:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Morning routine launcher"
[modes.mappings.trigger]
type = "Note"
note = 138
[modes.mappings.action]
type = "Conditional"
conditions = [
    { type = "DayOfWeek", days = ["Sat", "Sun"] },
    { type = "TimeRange", start = "08:00", end = "12:00" }
]
operator = "And"
then_action = {
    type = "Sequence",
    actions = [
        { type = "Launch", app = "Apple Music" },
        { type = "Delay", ms = 1000 },
        { type = "Launch", app = "Mail" }
    ]
}
else_action = {
    type = "Sequence",
    actions = [
        { type = "Launch", app = "Slack" },
        { type = "Delay", ms = 1000 },
        { type = "Launch", app = "Calendar" },
        { type = "Delay", ms = 500 },
        { type = "Launch", app = "Visual Studio Code" }
    ]
}
</code></pre>
<h2 id="performance-tips"><a class="header" href="#performance-tips">Performance Tips</a></h2>
<h3 id="timing-best-practices"><a class="header" href="#timing-best-practices">Timing Best Practices</a></h3>
<ol>
<li><strong>Application Launch</strong>: Wait 1000-2000ms after launching apps</li>
<li><strong>UI Navigation</strong>: Use 100-200ms between UI interactions</li>
<li><strong>Form Fills</strong>: 100ms delay between field navigation</li>
<li><strong>File Operations</strong>: 500-1000ms for save/load operations</li>
<li><strong>Network Operations</strong>: 2000ms+ for remote operations</li>
</ol>
<h3 id="repeat-guidelines"><a class="header" href="#repeat-guidelines">Repeat Guidelines</a></h3>
<ol>
<li><strong>Start Small</strong>: Begin with count=1, increase gradually</li>
<li><strong>Add Delays</strong>: Use <code>delay_between_ms</code> for counts &gt;5</li>
<li><strong>Test Incrementally</strong>: Verify each step before combining</li>
<li><strong>Consider UX</strong>: Counts &gt;100 may appear as hang</li>
<li><strong>Monitor Performance</strong>: Watch CPU/memory with large counts</li>
</ol>
<h3 id="debugging"><a class="header" href="#debugging">Debugging</a></h3>
<p>Enable debug mode to see action execution:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
<p>Common issues:</p>
<ul>
<li><strong>Timing too tight</strong>: Increase <code>delay_between_ms</code></li>
<li><strong>Actions not executing</strong>: Check application focus</li>
<li><strong>Repeats stopping early</strong>: Check <code>stop_on_error</code> setting</li>
<li><strong>Slow performance</strong>: Reduce repeat counts or add delays</li>
</ul>
<h2 id="see-also-5"><a class="header" href="#see-also-5">See Also</a></h2>
<ul>
<li><a href="configuration/actions.html">Actions Reference</a> - Complete action type documentation</li>
<li><a href="configuration/../reference/action-types.html">Action Types Reference</a> - Technical specifications</li>
<li><a href="configuration/../reference/trigger-types.html">Trigger Types</a> - Trigger configuration</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="trigger-types"><a class="header" href="#trigger-types">Trigger Types</a></h1>
<p>Triggers define when an action should execute. MIDIMon supports a wide range of trigger types from simple note presses to complex patterns like chords and long presses.</p>
<h2 id="core-triggers"><a class="header" href="#core-triggers">Core Triggers</a></h2>
<h3 id="note"><a class="header" href="#note">Note</a></h3>
<p>Basic MIDI note on/off detection.</p>
<pre><code class="language-toml">[trigger]
type = "Note"
note = 60  # Middle C
velocity_min = 1  # Optional: minimum velocity (default 1)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>note</code> (integer): MIDI note number (0-127)</li>
<li><code>velocity_min</code> (integer, optional): Minimum velocity to trigger (default 1)</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Simple pad presses</li>
<li>Piano key detection</li>
<li>Basic button mapping</li>
</ul>
<h3 id="velocityrange"><a class="header" href="#velocityrange">VelocityRange</a></h3>
<p>Different actions based on how hard you press.</p>
<pre><code class="language-toml">[trigger]
type = "VelocityRange"
note = 60
min_velocity = 80
max_velocity = 127
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>note</code> (integer): MIDI note number</li>
<li><code>min_velocity</code> (integer): Minimum velocity (0-127)</li>
<li><code>max_velocity</code> (integer): Maximum velocity (0-127)</li>
</ul>
<p><strong>Velocity Levels:</strong></p>
<ul>
<li><strong>Soft</strong>: 0-40</li>
<li><strong>Medium</strong>: 41-80</li>
<li><strong>Hard</strong>: 81-127</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Soft press for play, hard press for stop</li>
<li>Different shortcuts based on press intensity</li>
<li>Expressive control mappings</li>
</ul>
<h3 id="longpress"><a class="header" href="#longpress">LongPress</a></h3>
<p>Detect when a pad is held for a duration.</p>
<pre><code class="language-toml">[trigger]
type = "LongPress"
note = 60
min_duration_ms = 1000  # Hold for 1 second
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>note</code> (integer): MIDI note number</li>
<li><code>min_duration_ms</code> (integer): Minimum hold duration in milliseconds (default 2000)</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Hold for 2s to quit app (prevent accidental quits)</li>
<li>Short tap for screenshot, long press for screen recording</li>
<li>Confirmation for destructive actions</li>
</ul>
<h3 id="doubletap"><a class="header" href="#doubletap">DoubleTap</a></h3>
<p>Detect quick double presses.</p>
<pre><code class="language-toml">[trigger]
type = "DoubleTap"
note = 60
max_interval_ms = 300  # Optional: max time between taps
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>note</code> (integer): MIDI note number</li>
<li><code>max_interval_ms</code> (integer, optional): Maximum interval between taps (default 300ms)</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Double-tap to toggle fullscreen</li>
<li>Quick double-tap for emergency actions</li>
<li>Gesture-based shortcuts</li>
</ul>
<h3 id="notechord"><a class="header" href="#notechord">NoteChord</a></h3>
<p>Multiple notes pressed simultaneously.</p>
<pre><code class="language-toml">[trigger]
type = "NoteChord"
notes = [60, 64, 67]  # C major chord
max_interval_ms = 100  # Optional
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>notes</code> (array): List of MIDI note numbers</li>
<li><code>max_interval_ms</code> (integer, optional): Maximum time between first and last note (default 100ms)</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Emergency exit (press 3 corners simultaneously)</li>
<li>Complex shortcuts requiring multiple pads</li>
<li>Safety mechanisms for important actions</li>
</ul>
<h3 id="cc-control-change"><a class="header" href="#cc-control-change">CC (Control Change)</a></h3>
<p>Continuous controller messages.</p>
<pre><code class="language-toml">[trigger]
type = "CC"
cc = 1  # Modulation wheel
value_min = 64  # Optional: trigger only when value &gt;= 64
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>cc</code> (integer): Control change number (0-127)</li>
<li><code>value_min</code> (integer, optional): Minimum value to trigger</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Button presses sending CC messages</li>
<li>Threshold-based triggers</li>
<li>Binary on/off switches</li>
</ul>
<h3 id="encoderturn"><a class="header" href="#encoderturn">EncoderTurn</a></h3>
<p>Encoder rotation with direction detection.</p>
<pre><code class="language-toml">[trigger]
type = "EncoderTurn"
cc = 2
direction = "Clockwise"  # or "CounterClockwise"
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>cc</code> (integer): Control change number</li>
<li><code>direction</code> (string): "Clockwise" or "CounterClockwise"</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Volume control with encoder</li>
<li>Mode switching (clockwise = next, counter-clockwise = previous)</li>
<li>Parameter adjustment</li>
</ul>
<h2 id="advanced-triggers"><a class="header" href="#advanced-triggers">Advanced Triggers</a></h2>
<h3 id="aftertouch"><a class="header" href="#aftertouch">Aftertouch</a></h3>
<p>Channel pressure sensitivity (pressure after initial press).</p>
<pre><code class="language-toml">[trigger]
type = "Aftertouch"
note = 1  # Optional: specific pad (omit for channel aftertouch)
min_pressure = 64  # Optional: minimum pressure
max_pressure = 127  # Optional: maximum pressure
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>note</code> (integer, optional): Specific pad for polyphonic aftertouch (omit for channel aftertouch)</li>
<li><code>min_pressure</code> (integer, optional): Minimum pressure value (0-127)</li>
<li><code>max_pressure</code> (integer, optional): Maximum pressure value (0-127)</li>
</ul>
<p><strong>Aftertouch Types:</strong></p>
<ul>
<li><strong>Polyphonic (0xA0)</strong>: Per-pad pressure (Maschine Mikro MK3, Launchpad Pro)</li>
<li><strong>Channel (0xD0)</strong>: Global pressure for entire device (most MIDI keyboards)</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Apply pressure to modulate effects</li>
<li>Pressure-sensitive volume control</li>
<li>Expression control without additional hardware</li>
</ul>
<p><strong>Device Compatibility:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Device</th><th>Support</th><th>Type</th><th>Notes</th></tr></thead><tbody>
<tr><td>Maschine Mikro MK3</td><td>✅</td><td>Polyphonic</td><td>Excellent sensitivity</td></tr>
<tr><td>Akai MPD Series</td><td>✅</td><td>Polyphonic</td><td>Requires firmware 1.5+</td></tr>
<tr><td>Novation Launchpad Pro</td><td>✅</td><td>Polyphonic</td><td>Excellent sensitivity</td></tr>
<tr><td>Launchpad Mini</td><td>❌</td><td>None</td><td>No aftertouch</td></tr>
<tr><td>Generic MIDI Keyboard</td><td>⚠️</td><td>Channel</td><td>Global only</td></tr>
</tbody></table>
</div>
<p><strong>Configuration Examples:</strong></p>
<pre><code class="language-toml"># Basic aftertouch trigger
[[modes.mappings]]
description = "Effect intensity via pressure"
[modes.mappings.trigger]
type = "Aftertouch"
note = 1
min_pressure = 64
[modes.mappings.action]
type = "Shell"
command = "osascript -e 'set volume 50'"

# Pressure ranges for different actions
[[modes.mappings]]
description = "Soft pressure"
[modes.mappings.trigger]
type = "Aftertouch"
note = 2
min_pressure = 1
max_pressure = 64
[modes.mappings.action]
type = "Keystroke"
keys = "1"

[[modes.mappings]]
description = "Hard pressure"
[modes.mappings.trigger]
type = "Aftertouch"
note = 2
min_pressure = 65
max_pressure = 127
[modes.mappings.action]
type = "Keystroke"
keys = "2"
</code></pre>
<p><strong>Throttling Options:</strong></p>
<p>Aftertouch generates continuous messages. Use throttling to control message rate:</p>
<pre><code class="language-toml">[advanced_settings.aftertouch]
throttle_ms = 50        # Max 20 messages/sec
delta_threshold = 5     # Only trigger on ±5 pressure change
hysteresis_gap = 10     # Prevent zone oscillation
</code></pre>
<h3 id="pitchbend"><a class="header" href="#pitchbend">PitchBend</a></h3>
<p>Touch strip or pitch wheel control (14-bit precision).</p>
<pre><code class="language-toml">[trigger]
type = "PitchBend"
min_value = 8192   # Center
max_value = 16383  # Max up
center_deadzone = 100  # Optional: ignore small movements near center
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>min_value</code> (integer): Minimum bend value (0-16383)</li>
<li><code>max_value</code> (integer): Maximum bend value (0-16383)</li>
<li><code>center_deadzone</code> (integer, optional): Deadzone size around center (8192)</li>
</ul>
<p><strong>Value Range:</strong></p>
<ul>
<li><strong>Full Range</strong>: 0-16383 (14-bit resolution)</li>
<li><strong>Center</strong>: 8192</li>
<li><strong>Down</strong>: 0-8191</li>
<li><strong>Up</strong>: 8193-16383</li>
<li><strong>Normalized</strong>: -1.0 to +1.0</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Touch strip for volume control</li>
<li>Timeline scrubbing in DAWs</li>
<li>Smooth parameter sweeps</li>
<li>Multi-zone selection (divide strip into regions)</li>
</ul>
<p><strong>Configuration Examples:</strong></p>
<pre><code class="language-toml"># Volume control with touch strip
[[global_mappings]]
description = "Volume up via touch strip"
[global_mappings.trigger]
type = "PitchBend"
min_value = 8192  # Center
max_value = 16383  # Max up
center_deadzone = 100
[global_mappings.action]
type = "VolumeControl"
operation = "Up"

# Multi-zone mapping (divide strip into 5 zones)
[[modes.mappings]]
description = "Zone 1: Far Left"
[modes.mappings.trigger]
type = "PitchBend"
min_value = 0
max_value = 3276  # 20% of range
[modes.mappings.action]
type = "Keystroke"
keys = "1"

[[modes.mappings]]
description = "Zone 2: Left"
[modes.mappings.trigger]
type = "PitchBend"
min_value = 3277
max_value = 6553  # 40% of range
[modes.mappings.action]
type = "Keystroke"
keys = "2"

# Center detection
[[modes.mappings]]
description = "Reset on center touch"
[modes.mappings.trigger]
type = "PitchBend"
min_value = 8092  # Center - 100
max_value = 8292  # Center + 100
[modes.mappings.action]
type = "Keystroke"
keys = "r"
modifiers = ["cmd"]
</code></pre>
<p><strong>Throttling Options:</strong></p>
<p>Pitch bend generates 100-1000+ messages/sec. Use throttling:</p>
<pre><code class="language-toml">[advanced_settings.pitch_bend]
throttle_ms = 50         # Max 20 messages/sec
delta_threshold = 100    # Trigger only on ±100 change
use_zones = true         # Zone-based triggering
num_zones = 16           # 16 discrete zones
</code></pre>
<p><strong>Spring-Back Behavior:</strong></p>
<p>Many controllers (Maschine Mikro MK3, MIDI keyboards) auto-return to center:</p>
<ul>
<li>Returns to 8192 when released</li>
<li>Not suitable for persistent state/toggles</li>
<li>Use for momentary effects only</li>
<li>Spring-back generates message flood on release</li>
</ul>
<p><strong>Platform Notes:</strong></p>
<ul>
<li><strong>macOS</strong>: Full 14-bit support, no special handling</li>
<li><strong>Linux</strong>: Some ALSA drivers may reverse MSB/LSB byte order</li>
<li><strong>Windows</strong>: Supported, but some USB MIDI drivers have 10-50ms latency</li>
</ul>
<h2 id="trigger-composition"><a class="header" href="#trigger-composition">Trigger Composition</a></h2>
<p>Triggers can work together for complex behaviors:</p>
<p><strong>Example: Conditional Trigger</strong></p>
<pre><code class="language-toml"># Only trigger during specific time range
[[modes.mappings]]
[modes.mappings.trigger]
type = "Note"
note = 60
[modes.mappings.action]
type = "Conditional"
conditions = [{ type = "TimeRange", start = "09:00", end = "17:00" }]
then_action = { type = "Shell", command = "work-task" }
else_action = { type = "Shell", command = "personal-task" }
</code></pre>
<h2 id="performance-notes"><a class="header" href="#performance-notes">Performance Notes</a></h2>
<ul>
<li><strong>Note/CC</strong>: &lt;0.1ms detection latency</li>
<li><strong>LongPress</strong>: Checked every 50ms</li>
<li><strong>DoubleTap</strong>: 300ms window (configurable)</li>
<li><strong>Chord</strong>: 100ms window (configurable)</li>
<li><strong>Aftertouch</strong>: Continuous messages, use throttling</li>
<li><strong>PitchBend</strong>: Continuous messages, 14-bit precision</li>
</ul>
<h2 id="troubleshooting-4"><a class="header" href="#troubleshooting-4">Troubleshooting</a></h2>
<h3 id="trigger-not-firing"><a class="header" href="#trigger-not-firing">Trigger Not Firing</a></h3>
<ul>
<li>Use <code>midi_diagnostic</code> tool to verify MIDI messages:
<pre><code class="language-bash">cargo run --bin midi_diagnostic 2
</code></pre>
</li>
<li>Check note numbers match MIDI output</li>
<li>Verify velocity thresholds</li>
<li>Enable debug logging: <code>DEBUG=1 cargo run</code></li>
</ul>
<h3 id="aftertouch-not-working"><a class="header" href="#aftertouch-not-working">Aftertouch Not Working</a></h3>
<ul>
<li>Check device compatibility (not all controllers support aftertouch)</li>
<li>Verify polyphonic vs channel aftertouch</li>
<li>Test with <code>midi_diagnostic</code> tool</li>
<li>Adjust pressure thresholds</li>
</ul>
<h3 id="pitchbend-jittery"><a class="header" href="#pitchbend-jittery">PitchBend Jittery</a></h3>
<ul>
<li>Increase <code>center_deadzone</code> value</li>
<li>Enable throttling in <code>advanced_settings</code></li>
<li>Use <code>delta_threshold</code> for change-based triggering</li>
<li>Consider zone-based triggering instead of continuous</li>
</ul>
<h3 id="chord-not-detected"><a class="header" href="#chord-not-detected">Chord Not Detected</a></h3>
<ul>
<li>Increase <code>max_interval_ms</code> (default 100ms)</li>
<li>Press pads more simultaneously</li>
<li>Check with <code>midi_diagnostic</code> for timing</li>
<li>Verify all note numbers correct</li>
</ul>
<h2 id="see-also-6"><a class="header" href="#see-also-6">See Also</a></h2>
<ul>
<li><a href="reference/action-types.html">Action Types</a></li>
<li><a href="reference/../configuration/examples.html">Configuration Examples</a></li>
<li><a href="reference/../configuration/modes.html">Modes and Mappings</a></li>
<li><a href="reference/../configuration/overview.html">Advanced Settings</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="action-types"><a class="header" href="#action-types">Action Types</a></h1>
<p>Actions are what MIDIMon executes when a trigger is detected. This page documents all available action types and their configuration.</p>
<h2 id="core-actions"><a class="header" href="#core-actions">Core Actions</a></h2>
<h3 id="keystroke-1"><a class="header" href="#keystroke-1">Keystroke</a></h3>
<p>Simulates keyboard input with optional modifiers.</p>
<pre><code class="language-toml">[action]
type = "Keystroke"
keys = "c"
modifiers = ["cmd"]
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>keys</code> (string): Key(s) to press (e.g., "space", "return", "f1")</li>
<li><code>modifiers</code> (array): Optional modifiers: "cmd", "ctrl", "alt", "shift"</li>
</ul>
<p><strong>Supported Keys:</strong></p>
<ul>
<li>Letters: <code>a-z</code></li>
<li>Numbers: <code>0-9</code></li>
<li>Special: <code>space</code>, <code>return</code>, <code>tab</code>, <code>escape</code>, <code>backspace</code>, <code>delete</code></li>
<li>Arrows: <code>up</code>, <code>down</code>, <code>left</code>, <code>right</code></li>
<li>Function: <code>f1</code> through <code>f12</code></li>
<li>Navigation: <code>home</code>, <code>end</code>, <code>pageup</code>, <code>pagedown</code></li>
</ul>
<h3 id="text-1"><a class="header" href="#text-1">Text</a></h3>
<p>Types arbitrary text strings with full Unicode support. Uses keyboard simulation to type character-by-character.</p>
<pre><code class="language-toml">[action]
type = "Text"
text = "Hello, World!"
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>text</code> (string): Text to type (supports Unicode, emoji, multi-line)</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Text snippets and templates</li>
<li>Email signatures and contact information</li>
<li>Code boilerplate and common patterns</li>
<li>Form auto-fill</li>
<li>Multi-language text input</li>
</ul>
<p><strong>Configuration Examples:</strong></p>
<p><strong>Simple Text:</strong></p>
<pre><code class="language-toml">[action]
type = "Text"
text = "user@example.com"
</code></pre>
<p><strong>Multi-line Code Snippet:</strong></p>
<pre><code class="language-toml">[action]
type = "Text"
text = """
fn main() {
    println!(\"Hello, World!\");
}
"""
</code></pre>
<p><strong>Unicode and Emoji:</strong></p>
<pre><code class="language-toml">[action]
type = "Text"
text = "✅ Task completed! 🎉"
</code></pre>
<p><strong>Special Characters:</strong></p>
<pre><code class="language-toml">[action]
type = "Text"
text = "!@#$%^&amp;*()_+-=[]{}|;':\",./&lt;&gt;?"
</code></pre>
<p><strong>Text with Delay (using Sequence):</strong></p>
<pre><code class="language-toml">[action]
type = "Sequence"
actions = [
    { type = "Text", text = "username" },
    { type = "Delay", ms = 100 },
    { type = "Text", text = "@company.com" }
]
</code></pre>
<p><strong>TOML String Escaping:</strong></p>
<pre><code class="language-toml"># Escape quotes in basic strings
text = "He said \"hello\""

# Use multiline strings for complex text
text = """
Line 1
Line 2 with "quotes"
"""

# Use literal strings to avoid escaping backslashes
text = 'C:\Users\Documents\file.txt'
</code></pre>
<p><strong>Platform Support:</strong></p>
<ul>
<li>macOS: Accessibility APIs</li>
<li>Linux: X11/Wayland</li>
<li>Windows: Windows API</li>
</ul>
<p><strong>Behavior:</strong></p>
<ul>
<li>Types character-by-character (no clipboard)</li>
<li>Respects active keyboard layout</li>
<li>Typing speed controlled by OS</li>
<li>Requires text input focus</li>
</ul>
<p><strong>Troubleshooting:</strong></p>
<ul>
<li>Ensure target app has input focus</li>
<li>Check Input Monitoring permissions (macOS)</li>
<li>For slow UIs, use Sequence with Delay actions</li>
<li>For special keys (Enter, Tab, Ctrl), use Keystroke action instead</li>
</ul>
<h3 id="launch-1"><a class="header" href="#launch-1">Launch</a></h3>
<p>Opens an application by name or path using platform-specific system commands.</p>
<pre><code class="language-toml">[action]
type = "Launch"
app = "Safari"
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>app</code> (string): Application name or full path to executable/bundle</li>
</ul>
<p><strong>Platform Behavior:</strong></p>
<p><strong>macOS:</strong></p>
<ul>
<li>Uses <code>open -a</code> command</li>
<li>Accepts app names: "Safari", "Visual Studio Code", "Logic Pro"</li>
<li>Accepts full paths: "/Applications/Safari.app"</li>
<li>If app already running, brings to front</li>
<li>Searches standard paths: /Applications, ~/Applications, /System/Applications</li>
</ul>
<p><strong>Linux:</strong></p>
<ul>
<li>Direct executable launch via <code>Command::spawn()</code></li>
<li>Requires full path or executable in $PATH</li>
<li>No automatic .desktop file resolution</li>
<li>Typically launches new instance even if already running</li>
</ul>
<p><strong>Windows:</strong></p>
<ul>
<li>Uses <code>cmd /C start</code> command</li>
<li>Accepts app names or paths</li>
<li>Uses Windows file associations</li>
<li>Behavior varies by app's single-instance implementation</li>
</ul>
<p><strong>Examples:</strong></p>
<pre><code class="language-toml"># Launch by app name (macOS)
[action]
type = "Launch"
app = "Terminal"

# Launch by full path
[action]
type = "Launch"
app = "/Applications/Utilities/Terminal.app"

# Launch script with full path
[action]
type = "Launch"
app = "/Users/username/scripts/backup.sh"

# Launch multiple apps in sequence
[action]
type = "Sequence"
actions = [
    { type = "Launch", app = "VS Code" },
    { type = "Delay", ms = 1000 },
    { type = "Launch", app = "Terminal" }
]
</code></pre>
<p><strong>Troubleshooting:</strong></p>
<ul>
<li><strong>App not found</strong>: Use full path instead of app name</li>
<li><strong>macOS test</strong>: Run <code>open -a "App Name"</code> in Terminal</li>
<li><strong>Linux test</strong>: Run <code>which app-name</code> or use full path</li>
<li><strong>Silent failures</strong>: Enable debug mode with <code>DEBUG=1</code></li>
<li><strong>Permissions</strong>: Ensure execute permissions on scripts (<code>chmod +x</code>)</li>
</ul>
<p><strong>Notes:</strong></p>
<ul>
<li>Launch is non-blocking (returns immediately)</li>
<li>No validation that app exists before launch attempt</li>
<li>Errors fail silently (check debug logs)</li>
<li>App names with spaces are automatically handled</li>
<li>Launch time varies: 100ms (small apps) to 10s (large IDEs/DAWs)</li>
</ul>
<h3 id="shell-1"><a class="header" href="#shell-1">Shell</a></h3>
<p>Executes a shell command.</p>
<pre><code class="language-toml">[action]
type = "Shell"
command = "npm test"
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>command</code> (string): Shell command to execute</li>
</ul>
<p><strong>Platform Notes:</strong></p>
<ul>
<li>Unix/macOS: Uses <code>sh -c</code></li>
<li>Windows: Uses <code>cmd /C</code></li>
</ul>
<p><strong>Security Warning:</strong> Be cautious with user input in shell commands.</p>
<h2 id="system-actions"><a class="header" href="#system-actions">System Actions</a></h2>
<h3 id="volumecontrol"><a class="header" href="#volumecontrol">VolumeControl</a></h3>
<p>Controls system volume with cross-platform support for increase, decrease, mute/unmute, and absolute level setting.</p>
<pre><code class="language-toml">[action]
type = "VolumeControl"
operation = "Up"
amount = 5  # Optional: volume increment (default 5)
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>operation</code> (string): Volume operation to perform</li>
<li><code>amount</code> (integer, optional):
<ul>
<li>For <code>Up</code>/<code>Down</code>: Increment amount 0-100 (default 5)</li>
<li>For <code>Set</code>: Absolute level 0-100</li>
</ul>
</li>
</ul>
<p><strong>Operations:</strong></p>
<ul>
<li><code>Up</code>: Increase volume by amount</li>
<li><code>Down</code>: Decrease volume by amount</li>
<li><code>Mute</code>: Mute audio output</li>
<li><code>Unmute</code>: Unmute audio output</li>
<li><code>Toggle</code>: Toggle mute state</li>
<li><code>Set</code>: Set to specific level (requires <code>amount</code> parameter)</li>
</ul>
<p><strong>Platform Support:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Platform</th><th>Method</th><th>Latency</th><th>Dependencies</th></tr></thead><tbody>
<tr><td>macOS</td><td>AppleScript</td><td>50-100ms</td><td>None (built-in)</td></tr>
<tr><td>Linux (PulseAudio)</td><td>pactl</td><td>10-30ms</td><td>pulseaudio-utils</td></tr>
<tr><td>Linux (Pipewire)</td><td>wpctl</td><td>5-15ms</td><td>wireplumber</td></tr>
<tr><td>Linux (ALSA)</td><td>amixer</td><td>15-40ms</td><td>alsa-utils</td></tr>
<tr><td>Windows</td><td>nircmd</td><td>20-50ms</td><td>nircmd.exe</td></tr>
<tr><td>Windows</td><td>COM API</td><td>5-10ms</td><td>None (built-in)</td></tr>
</tbody></table>
</div>
<p><strong>Configuration Examples:</strong></p>
<pre><code class="language-toml"># Encoder volume control
[[global_mappings]]
description = "Volume Up"
[global_mappings.trigger]
type = "EncoderTurn"
cc = 2
direction = "Clockwise"
[global_mappings.action]
type = "VolumeControl"
operation = "Up"
amount = 2  # Small increments for smooth control

[[global_mappings]]
description = "Volume Down"
[global_mappings.trigger]
type = "EncoderTurn"
cc = 2
direction = "CounterClockwise"
[global_mappings.action]
type = "VolumeControl"
operation = "Down"
amount = 2

# Mute toggle
[[global_mappings]]
description = "Mute/Unmute"
[global_mappings.trigger]
type = "Note"
note = 16
[global_mappings.action]
type = "VolumeControl"
operation = "Toggle"

# Set to specific level
[[modes.mappings]]
description = "Set volume to 50%"
[modes.mappings.trigger]
type = "Note"
note = 8
[modes.mappings.action]
type = "VolumeControl"
operation = "Set"
amount = 50

# Velocity-based volume (multiple mappings)
[[modes.mappings]]
description = "Soft press = 25%"
[modes.mappings.trigger]
type = "VelocityRange"
note = 9
min_velocity = 0
max_velocity = 40
[modes.mappings.action]
type = "VolumeControl"
operation = "Set"
amount = 25

[[modes.mappings]]
description = "Medium press = 50%"
[modes.mappings.trigger]
type = "VelocityRange"
note = 9
min_velocity = 41
max_velocity = 80
[modes.mappings.action]
type = "VolumeControl"
operation = "Set"
amount = 50

[[modes.mappings]]
description = "Hard press = 75%"
[modes.mappings.trigger]
type = "VelocityRange"
note = 9
min_velocity = 81
max_velocity = 127
[modes.mappings.action]
type = "VolumeControl"
operation = "Set"
amount = 75
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li><strong>Producer</strong>: Encoder for smooth volume adjustment while mixing</li>
<li><strong>Developer</strong>: Quick mute during video calls, volume presets for different activities</li>
<li><strong>Streamer</strong>: Real-time volume balancing during streams, emergency mute</li>
<li><strong>Presenter</strong>: Volume control without touching laptop during presentations</li>
</ul>
<p><strong>Troubleshooting:</strong></p>
<p><em><strong>macOS:</strong></em></p>
<ul>
<li>No dependencies required</li>
<li>AppleScript latency ~50-100ms is normal</li>
<li>Requires no special permissions</li>
</ul>
<p><em><strong>Linux:</strong></em></p>
<ul>
<li>Install dependencies:
<pre><code class="language-bash"># PulseAudio (most common)
sudo apt install pulseaudio-utils

# Pipewire (modern, fastest)
sudo apt install pipewire wireplumber

# ALSA (minimal systems)
sudo apt install alsa-utils
</code></pre>
</li>
<li>MIDIMon auto-detects available backend</li>
<li>User must be in <code>audio</code> group</li>
</ul>
<p><em><strong>Windows:</strong></em></p>
<ul>
<li>Download nircmd.exe from https://www.nirsoft.net/utils/nircmd.html</li>
<li>Add to PATH or place in MIDIMon directory</li>
<li>COM API fallback requires no dependencies</li>
</ul>
<p><strong>Performance Notes:</strong></p>
<ul>
<li>Volume commands are non-blocking</li>
<li>State changes typically take 5-100ms depending on platform</li>
<li>Multiple rapid commands may queue on slower platforms (macOS AppleScript)</li>
</ul>
<h3 id="modechange"><a class="header" href="#modechange">ModeChange</a></h3>
<p>Switches between different mapping modes with optional LED transition effects and relative navigation.</p>
<pre><code class="language-toml">[action]
type = "ModeChange"
mode = 1  # Switch to mode index 1
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>mode</code> (integer): Zero-based mode index or offset (if <code>relative = true</code>)</li>
<li><code>relative</code> (boolean, optional): If true, <code>mode</code> is offset from current mode (default false)</li>
<li><code>transition_effect</code> (string, optional): Visual transition effect: "Flash", "Sweep", "FadeOut", "Spiral", "None"</li>
</ul>
<p><strong>Mode Indexing:</strong></p>
<ul>
<li>Modes are zero-based: Mode 0, Mode 1, Mode 2, etc.</li>
<li>Mode 0 is typically the default mode on startup</li>
<li>Invalid mode indices are clamped to valid range</li>
</ul>
<p><strong>Absolute vs Relative Mode Changes:</strong></p>
<p><em><strong>Absolute (direct jump):</strong></em></p>
<pre><code class="language-toml">[action]
type = "ModeChange"
mode = 2  # Jump directly to Mode 2
transition_effect = "Flash"
</code></pre>
<p><em><strong>Relative (navigation):</strong></em></p>
<pre><code class="language-toml"># Next mode (with wrapping)
[action]
type = "ModeChange"
mode = 1  # +1 offset
relative = true
transition_effect = "Sweep"

# Previous mode (with wrapping)
[action]
type = "ModeChange"
mode = -1  # -1 offset
relative = true
</code></pre>
<p><strong>Transition Effects:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Effect</th><th>Duration</th><th>Description</th></tr></thead><tbody>
<tr><td>Flash</td><td>150ms</td><td>Quick white flash</td></tr>
<tr><td>Sweep</td><td>120ms</td><td>Left-to-right wave</td></tr>
<tr><td>FadeOut</td><td>200ms</td><td>Fade out old, fade in new</td></tr>
<tr><td>Spiral</td><td>240ms</td><td>Center-outward spiral</td></tr>
<tr><td>None</td><td>0ms</td><td>Instant switch</td></tr>
</tbody></table>
</div>
<p><strong>Configuration Examples:</strong></p>
<pre><code class="language-toml"># Encoder for mode cycling
[[global_mappings]]
description = "Next Mode"
[global_mappings.trigger]
type = "EncoderTurn"
cc = 1
direction = "Clockwise"
[global_mappings.action]
type = "ModeChange"
mode = 1  # +1 offset
relative = true
transition_effect = "Sweep"

[[global_mappings]]
description = "Previous Mode"
[global_mappings.trigger]
type = "EncoderTurn"
cc = 1
direction = "CounterClockwise"
[global_mappings.action]
type = "ModeChange"
mode = -1  # -1 offset (wraps backward)
relative = true
transition_effect = "Sweep"

# Direct mode selection with chords
[[global_mappings]]
description = "Jump to Default Mode"
[global_mappings.trigger]
type = "NoteChord"
notes = [1, 9]  # Top-left corners
[global_mappings.action]
type = "ModeChange"
mode = 0
transition_effect = "Flash"

[[global_mappings]]
description = "Jump to Development Mode"
[global_mappings.trigger]
type = "NoteChord"
notes = [2, 10]
[global_mappings.action]
type = "ModeChange"
mode = 1
transition_effect = "Flash"

[[global_mappings]]
description = "Jump to Media Mode"
[global_mappings.trigger]
type = "NoteChord"
notes = [3, 11]
[global_mappings.action]
type = "ModeChange"
mode = 2
transition_effect = "FadeOut"

# Conditional mode change
[[modes.mappings]]
description = "Switch to Media mode if Spotify running"
[modes.mappings.trigger]
type = "Note"
note = 8
[modes.mappings.action]
type = "Conditional"
conditions = [{ type = "AppRunning", bundle_id = "com.spotify.client" }]
then_action = { type = "ModeChange", mode = 2, transition_effect = "FadeOut" }
else_action = { type = "Launch", app = "Spotify" }
</code></pre>
<p><strong>Mode Configuration:</strong></p>
<p>Modes are defined in your config.toml with names and LED colors:</p>
<pre><code class="language-toml">[[modes]]
name = "Default"
color = "blue"             # LED color for this mode
led_idle_brightness = 20   # Brightness when pad not pressed
led_active_brightness = 255 # Brightness when pad pressed
mappings = [...]

[[modes]]
name = "Development"
color = "green"
led_idle_brightness = 30
led_active_brightness = 255
mappings = [...]

[[modes]]
name = "Media"
color = "purple"
led_idle_brightness = 15
led_active_brightness = 200
mappings = [...]
</code></pre>
<p><strong>LED Feedback Integration:</strong></p>
<ul>
<li>Mode colors automatically update LEDs on mode change</li>
<li>Transition effects provide visual feedback</li>
<li>Optional mode indicator pads (e.g., bottom row shows active mode)</li>
<li>Idle/active brightness levels per mode</li>
</ul>
<p><strong>Use Cases:</strong></p>
<p><em><strong>Developer (Sam) - Context Switching:</strong></em></p>
<ul>
<li><strong>Mode 0</strong>: General productivity shortcuts</li>
<li><strong>Mode 1</strong>: IDE shortcuts (build, test, debug)</li>
<li><strong>Mode 2</strong>: Media controls</li>
<li>Encoder rotation for quick mode cycling</li>
</ul>
<p><em><strong>Producer (Alex) - Production Workflow:</strong></em></p>
<ul>
<li><strong>Mode 0</strong>: Recording (transport, record arm)</li>
<li><strong>Mode 1</strong>: Mixing (volume, mute/solo, effects)</li>
<li><strong>Mode 2</strong>: Mastering (compressor, EQ, limiter)</li>
<li>Chord combinations for instant mode jumps</li>
</ul>
<p><em><strong>Streamer (Jordan) - Live Streaming:</strong></em></p>
<ul>
<li><strong>Mode 0</strong>: Pre-Stream (setup checks, app launching)</li>
<li><strong>Mode 1</strong>: Live (scene switching, alerts)</li>
<li><strong>Mode 2</strong>: BRB (limited controls, auto-mute)</li>
<li><strong>Mode 3</strong>: Post-Stream (save, shutdown sequence)</li>
</ul>
<p><em><strong>Designer (Taylor) - Creative Workflows:</strong></em></p>
<ul>
<li><strong>Mode 0</strong>: Sketch (drawing tools, layers)</li>
<li><strong>Mode 1</strong>: Edit (selection, transform, filters)</li>
<li><strong>Mode 2</strong>: Export (save presets, formats)</li>
<li>Visual LED feedback shows current mode</li>
</ul>
<p><strong>Circular Mode Navigation:</strong></p>
<p>With <code>relative = true</code>, modes wrap around:</p>
<ul>
<li>Mode 0 → +1 → Mode 1</li>
<li>Mode 1 → +1 → Mode 2</li>
<li>Mode 2 → +1 → Mode 0 (wraps to beginning)</li>
<li>Mode 0 → -1 → Mode 2 (wraps to end)</li>
</ul>
<p><strong>Troubleshooting:</strong></p>
<p><em><strong>Mode Not Switching:</strong></em></p>
<ul>
<li>Verify mode index is within range (0 to num_modes-1)</li>
<li>Check that modes are defined in config.toml</li>
<li>Enable debug logging: <code>DEBUG=1 cargo run</code></li>
<li>Ensure mode change mapping is in <code>global_mappings</code> to work from all modes</li>
</ul>
<p><em><strong>LEDs Not Updating:</strong></em></p>
<ul>
<li>Verify <code>color</code> is set for each mode</li>
<li>Check device supports RGB LED feedback</li>
<li>Ensure LED feedback is enabled</li>
<li>Test with different transition effects</li>
</ul>
<p><em><strong>Transition Effects Not Working:</strong></em></p>
<ul>
<li>Only works with devices supporting RGB LEDs (Maschine Mikro MK3, etc.)</li>
<li>MIDI-only devices show instant switches</li>
<li>Check transition timing isn't too fast to notice</li>
</ul>
<p><strong>Performance Notes:</strong></p>
<ul>
<li>Mode switches are near-instant (&lt;1ms)</li>
<li>Transition effects add 0-240ms visual delay</li>
<li>LED updates are non-blocking</li>
<li>Rapid mode changes are queued and handled gracefully</li>
</ul>
<h2 id="advanced-actions-1"><a class="header" href="#advanced-actions-1">Advanced Actions</a></h2>
<h3 id="sequence-1"><a class="header" href="#sequence-1">Sequence</a></h3>
<p>Executes multiple actions in order.</p>
<pre><code class="language-toml">[action]
type = "Sequence"
actions = [
    { type = "Keystroke", keys = "n", modifiers = ["cmd"] },
    { type = "Delay", ms = 500 },
    { type = "Text", text = "New Document" }
]
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>actions</code> (array): Array of action configurations</li>
</ul>
<p><strong>Notes:</strong></p>
<ul>
<li>Actions execute sequentially</li>
<li>Default 50ms delay between actions</li>
<li>Use <code>Delay</code> action for longer pauses</li>
</ul>
<h3 id="delay-1"><a class="header" href="#delay-1">Delay</a></h3>
<p>Pauses execution.</p>
<pre><code class="language-toml">[action]
type = "Delay"
ms = 1000  # Wait 1 second
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>ms</code> (integer): Milliseconds to wait</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Wait for app to launch</li>
<li>Timing between keystrokes</li>
<li>Synchronization in sequences</li>
</ul>
<h3 id="repeat-1"><a class="header" href="#repeat-1">Repeat</a></h3>
<p>Repeats an action multiple times.</p>
<pre><code class="language-toml">[action]
type = "Repeat"
count = 10
delay_between_ms = 100
action = { type = "Keystroke", keys = "right" }
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>action</code> (object): Action to repeat</li>
<li><code>count</code> (integer): Number of repetitions</li>
<li><code>delay_between_ms</code> (integer, optional): Delay between repetitions in milliseconds</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Navigate through items</li>
<li>Rapid-fire actions</li>
<li>Automation tasks</li>
</ul>
<h3 id="mouseclick-1"><a class="header" href="#mouseclick-1">MouseClick</a></h3>
<p>Simulates mouse clicks.</p>
<pre><code class="language-toml">[action]
type = "MouseClick"
button = "left"
x = 100
y = 200
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>button</code> (string): "left", "right", or "middle"</li>
<li><code>x</code> (integer, optional): X coordinate (absolute)</li>
<li><code>y</code> (integer, optional): Y coordinate (absolute)</li>
</ul>
<p><strong>Notes:</strong></p>
<ul>
<li>If <code>x</code> and <code>y</code> are omitted, clicks at current cursor position</li>
<li>Coordinates are screen-absolute</li>
</ul>
<h3 id="conditional-1"><a class="header" href="#conditional-1">Conditional</a></h3>
<p>Executes actions based on conditions.</p>
<pre><code class="language-toml">[action]
type = "Conditional"
conditions = [
    { type = "AppRunning", bundle_id = "com.apple.Logic" }
]
operator = "And"
then_action = { type = "Keystroke", keys = "space" }
else_action = { type = "Launch", app = "Logic Pro" }
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>conditions</code> (array): Array of condition objects</li>
<li><code>operator</code> (string, optional): "And" or "Or" (default: "And")</li>
<li><code>then_action</code> (object): Action when conditions are true</li>
<li><code>else_action</code> (object, optional): Action when conditions are false</li>
</ul>
<p><strong>Condition Types:</strong></p>
<h4 id="apprunning"><a class="header" href="#apprunning">AppRunning</a></h4>
<p>Check if an application is running.</p>
<pre><code class="language-toml">{ type = "AppRunning", bundle_id = "com.spotify.client" }
</code></pre>
<h4 id="appnotrunning"><a class="header" href="#appnotrunning">AppNotRunning</a></h4>
<p>Check if an application is not running.</p>
<pre><code class="language-toml">{ type = "AppNotRunning", bundle_id = "com.spotify.client" }
</code></pre>
<h4 id="timerange"><a class="header" href="#timerange">TimeRange</a></h4>
<p>Check if current time is within a range.</p>
<pre><code class="language-toml">{ type = "TimeRange", start = "09:00", end = "17:00" }
</code></pre>
<p><strong>Format:</strong> HH:MM in 24-hour format
<strong>Note:</strong> Uses local system time</p>
<h4 id="dayofweek"><a class="header" href="#dayofweek">DayOfWeek</a></h4>
<p>Check if today matches specified days.</p>
<pre><code class="language-toml">{ type = "DayOfWeek", days = ["Mon", "Tue", "Wed", "Thu", "Fri"] }
</code></pre>
<p><strong>Valid Days:</strong> "Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"</p>
<h4 id="modifierpressed"><a class="header" href="#modifierpressed">ModifierPressed</a></h4>
<p>Check if a modifier key is held.</p>
<pre><code class="language-toml">{ type = "ModifierPressed", modifier = "Shift" }
</code></pre>
<p><strong>Valid Modifiers:</strong> "Shift", "Ctrl", "Cmd", "Alt", "Option"</p>
<h4 id="modeactive"><a class="header" href="#modeactive">ModeActive</a></h4>
<p>Check if a specific mode is active.</p>
<pre><code class="language-toml">{ type = "ModeActive", mode = 1 }
</code></pre>
<p><strong>Parameter:</strong> <code>mode</code> (integer): Zero-based mode index</p>
<p><strong>Operators:</strong></p>
<ul>
<li><code>And</code>: All conditions must be true</li>
<li><code>Or</code>: At least one condition must be true</li>
</ul>
<p><strong>Nested Conditionals:</strong>
You can nest conditionals for complex decision trees:</p>
<pre><code class="language-toml">[action]
type = "Conditional"
conditions = [{ type = "TimeRange", start = "09:00", end = "17:00" }]
then_action = {
    type = "Conditional",
    conditions = [{ type = "AppRunning", bundle_id = "com.microsoft.VSCode" }],
    then_action = { type = "Keystroke", keys = "b", modifiers = ["cmd", "shift"] },
    else_action = { type = "Launch", app = "Visual Studio Code" }
}
else_action = { type = "Launch", app = "Spotify" }
</code></pre>
<h2 id="action-composition"><a class="header" href="#action-composition">Action Composition</a></h2>
<p>Actions can be combined in powerful ways:</p>
<p><strong>Example: Complex Workflow</strong></p>
<pre><code class="language-toml">[action]
type = "Sequence"
actions = [
    { type = "Launch", app = "Terminal" },
    { type = "Delay", ms = 1000 },
    { type = "Text", text = "cd ~/projects &amp;&amp; npm test" },
    { type = "Keystroke", keys = "return" }
]
</code></pre>
<p><strong>Example: Conditional with Repeat</strong></p>
<pre><code class="language-toml">[action]
type = "Conditional"
conditions = [{ type = "ModifierPressed", modifier = "Shift" }]
then_action = {
    type = "Repeat",
    count = 5,
    delay_between_ms = 200,
    action = { type = "Keystroke", keys = "right" }
}
else_action = { type = "Keystroke", keys = "right" }
</code></pre>
<h2 id="performance-notes-1"><a class="header" href="#performance-notes-1">Performance Notes</a></h2>
<ul>
<li><strong>Keystroke</strong>: &lt;1ms execution time</li>
<li><strong>Shell</strong>: Asynchronous, non-blocking</li>
<li><strong>Launch</strong>: Platform-dependent, typically 100-500ms</li>
<li><strong>Conditional</strong>: 10-50ms per condition evaluation</li>
<li><strong>Sequence</strong>: Sum of individual action times + delays</li>
</ul>
<h2 id="troubleshooting-5"><a class="header" href="#troubleshooting-5">Troubleshooting</a></h2>
<h3 id="keystroke-not-working"><a class="header" href="#keystroke-not-working">Keystroke Not Working</a></h3>
<ul>
<li>Verify key name spelling</li>
<li>Check modifier syntax</li>
<li>Ensure app has input focus</li>
</ul>
<h3 id="shell-command-fails-silently"><a class="header" href="#shell-command-fails-silently">Shell Command Fails Silently</a></h3>
<ul>
<li>Test command in terminal first</li>
<li>Check environment variables</li>
<li>Enable debug logging: <code>DEBUG=1 cargo run</code></li>
</ul>
<h3 id="conditional-not-triggering"><a class="header" href="#conditional-not-triggering">Conditional Not Triggering</a></h3>
<ul>
<li>Verify bundle ID format (macOS): <code>osascript -e 'id of app "AppName"'</code></li>
<li>Check time format (24-hour: "09:00", not "9:00 AM")</li>
<li>Verify day names match exactly</li>
</ul>
<h3 id="launch-app-not-found"><a class="header" href="#launch-app-not-found">Launch App Not Found</a></h3>
<ul>
<li>Use exact app name as it appears in Applications folder</li>
<li>On Linux, use full executable path if not in PATH</li>
<li>Check permissions for app execution</li>
</ul>
<h2 id="see-also-7"><a class="header" href="#see-also-7">See Also</a></h2>
<ul>
<li><a href="reference/../configuration/examples.html">Configuration Examples</a></li>
<li><a href="reference/trigger-types.html">Trigger Types</a></li>
<li><a href="reference/../configuration/modes.html">Modes and Mappings</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="led-system-reference"><a class="header" href="#led-system-reference">LED System Reference</a></h1>
<p>MIDIMon provides comprehensive LED feedback for supported MIDI controllers, with full RGB control for HID devices (Native Instruments Maschine Mikro MK3) and basic on/off control for standard MIDI devices.</p>
<h2 id="overview-3"><a class="header" href="#overview-3">Overview</a></h2>
<p>The LED system consists of four main features:</p>
<ol>
<li><strong>F23: LED Lighting Schemes</strong> - 10 pre-defined animation patterns</li>
<li><strong>F24: LED Velocity Feedback</strong> - Color-coded response based on pad velocity</li>
<li><strong>F25: LED Mode Indicators</strong> - Visual feedback for active mode</li>
<li><strong>F26: LED Fade Effects</strong> - Smooth transitions and fade-out animations</li>
</ol>
<h2 id="feature-f23-led-lighting-schemes"><a class="header" href="#feature-f23-led-lighting-schemes">Feature F23: LED Lighting Schemes</a></h2>
<p>MIDIMon supports 10 distinct lighting schemes that can be selected at startup or configured in your config file.</p>
<h3 id="available-schemes-1"><a class="header" href="#available-schemes-1">Available Schemes</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Scheme</th><th>Description</th><th>Use Case</th><th>CPU Impact</th></tr></thead><tbody>
<tr><td><code>off</code></td><td>All LEDs disabled</td><td>Power saving, minimal distraction</td><td>0%</td></tr>
<tr><td><code>static</code></td><td>Solid color based on current mode</td><td>Clear mode indication</td><td>&lt;1%</td></tr>
<tr><td><code>breathing</code></td><td>Slow 2-second breathing effect</td><td>Ambient, relaxed workflow</td><td>~1%</td></tr>
<tr><td><code>pulse</code></td><td>Fast 500ms pulse</td><td>High-energy, performance</td><td>~1%</td></tr>
<tr><td><code>rainbow</code></td><td>Rainbow cycle across pads</td><td>Creative sessions, visual appeal</td><td>~2%</td></tr>
<tr><td><code>wave</code></td><td>Wave animation pattern</td><td>Dynamic feedback</td><td>~2%</td></tr>
<tr><td><code>sparkle</code></td><td>Random sparkles</td><td>Playful, attention-grabbing</td><td>~3%</td></tr>
<tr><td><code>reactive</code></td><td>Velocity-based colors (most common)</td><td>Precise feedback, performance</td><td>~1%</td></tr>
<tr><td><code>vumeter</code></td><td>VU meter style (bottom-up)</td><td>Audio visualization</td><td>~2%</td></tr>
<tr><td><code>spiral</code></td><td>Spiral pattern animation</td><td>Artistic, mesmerizing</td><td>~2%</td></tr>
</tbody></table>
</div>
<h3 id="command-line-usage-1"><a class="header" href="#command-line-usage-1">Command-Line Usage</a></h3>
<pre><code class="language-bash"># Start with reactive scheme (recommended)
cargo run --release 2 --led reactive

# Rainbow animation
cargo run --release 2 --led rainbow

# Disable LEDs
cargo run --release 2 --led off

# Static mode colors
cargo run --release 2 --led static
</code></pre>
<h3 id="configuration"><a class="header" href="#configuration">Configuration</a></h3>
<pre><code class="language-toml">[led_settings]
scheme = "reactive"  # Default scheme on startup
</code></pre>
<h3 id="implementation-details"><a class="header" href="#implementation-details">Implementation Details</a></h3>
<ul>
<li><strong>Update Rate</strong>: 10fps (100ms per frame) to maintain low CPU usage</li>
<li><strong>HID Devices</strong>: Full RGB control with 16.7 million colors</li>
<li><strong>MIDI Devices</strong>: Schemes degrade gracefully to on/off</li>
<li><strong>Performance</strong>: All schemes designed for &lt;3% CPU usage</li>
</ul>
<hr />
<h2 id="feature-f24-led-velocity-feedback"><a class="header" href="#feature-f24-led-velocity-feedback">Feature F24: LED Velocity Feedback</a></h2>
<p>Reactive LED feedback provides immediate visual confirmation of pad velocity, using color-coded responses.</p>
<h3 id="velocity-color-mapping"><a class="header" href="#velocity-color-mapping">Velocity Color Mapping</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Velocity Range</th><th>Color</th><th>Visual</th><th>Meaning</th></tr></thead><tbody>
<tr><td>0-40</td><td>Green</td><td>🟢</td><td>Soft press</td></tr>
<tr><td>41-80</td><td>Yellow</td><td>🟡</td><td>Medium press</td></tr>
<tr><td>81-127</td><td>Red</td><td>🔴</td><td>Hard press</td></tr>
</tbody></table>
</div>
<h3 id="behavior"><a class="header" href="#behavior">Behavior</a></h3>
<p><strong>On Press:</strong></p>
<ul>
<li>Pad immediately lights up in velocity-appropriate color</li>
<li>Brightness scales with velocity (40% base + 60% velocity-based)</li>
<li>Color change happens within &lt;1ms for responsive feedback</li>
</ul>
<p><strong>On Release:</strong></p>
<ul>
<li>Fade-out begins after 1 second</li>
<li>Fade duration: 200ms (configurable in future versions)</li>
<li>Pad returns to mode color or off state</li>
</ul>
<h3 id="configuration-example"><a class="header" href="#configuration-example">Configuration Example</a></h3>
<pre><code class="language-toml">[led_settings]
scheme = "reactive"

# Future: Velocity threshold customization
[led_settings.reactive]
soft_color = { r = 0, g = 255, b = 0 }      # Green
medium_color = { r = 255, g = 255, b = 0 }  # Yellow
hard_color = { r = 255, g = 0, b = 0 }      # Red
fade_duration_ms = 1000
</code></pre>
<h3 id="use-cases-1"><a class="header" href="#use-cases-1">Use Cases</a></h3>
<ul>
<li><strong>Performance</strong>: Immediate feedback on hit strength for drum pads</li>
<li><strong>Practice</strong>: Visual metronome or timing reference</li>
<li><strong>Recording</strong>: Confirm input without audio monitoring</li>
<li><strong>Accessibility</strong>: Visual alternative to audio feedback</li>
</ul>
<hr />
<h2 id="feature-f25-led-mode-indicators"><a class="header" href="#feature-f25-led-mode-indicators">Feature F25: LED Mode Indicators</a></h2>
<p>Visual feedback showing the currently active mode, helping users stay oriented when switching contexts.</p>
<h3 id="mode-color-scheme"><a class="header" href="#mode-color-scheme">Mode Color Scheme</a></h3>
<p>Each mode has an associated color that LEDs display when using <code>static</code> or <code>reactive</code> schemes:</p>
<div class="table-wrapper"><table><thead><tr><th>Mode</th><th>Default Color</th><th>RGB Values</th><th>Visual</th></tr></thead><tbody>
<tr><td>Mode 0 (Default)</td><td>Blue</td><td>(0, 100, 255)</td><td>🔵</td></tr>
<tr><td>Mode 1 (Development)</td><td>Green</td><td>(0, 255, 0)</td><td>🟢</td></tr>
<tr><td>Mode 2 (Media)</td><td>Purple</td><td>(200, 0, 255)</td><td>🟣</td></tr>
</tbody></table>
</div>
<h3 id="configuration-1"><a class="header" href="#configuration-1">Configuration</a></h3>
<pre><code class="language-toml">[[modes]]
name = "Default"
color = "blue"
led_idle_brightness = 20      # Brightness when idle (0-255)
led_active_brightness = 255   # Brightness when pressed

[[modes]]
name = "Development"
color = "green"
led_idle_brightness = 30
led_active_brightness = 255

[[modes]]
name = "Media"
color = "purple"
led_idle_brightness = 15
led_active_brightness = 200
</code></pre>
<h3 id="mode-transition-effects-1"><a class="header" href="#mode-transition-effects-1">Mode Transition Effects</a></h3>
<p>When switching modes, you can apply visual transition effects:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Next Mode with Flash"
[global_mappings.trigger]
type = "EncoderTurn"
cc = 1
direction = "Clockwise"
[global_mappings.action]
type = "ModeChange"
mode = 1
relative = true
transition_effect = "Flash"  # Options: Flash, Sweep, FadeOut, Spiral, None
</code></pre>
<p><strong>Transition Effects:</strong></p>
<ul>
<li><strong>Flash</strong>: Quick white flash (150ms) - best for rapid mode switching</li>
<li><strong>Sweep</strong>: Left-to-right wave (120ms) - smooth visual sweep</li>
<li><strong>FadeOut</strong>: Fade old color to new (200ms) - smooth transition</li>
<li><strong>Spiral</strong>: Center-outward spiral (240ms) - artistic transition</li>
</ul>
<h3 id="optional-mode-indicator-pads"><a class="header" href="#optional-mode-indicator-pads">Optional Mode Indicator Pads</a></h3>
<p>You can dedicate specific pads to always show the current mode:</p>
<pre><code class="language-toml">[led_settings]
mode_indicator_pads = [13, 14, 15, 16]  # Bottom row shows mode
# Pad 13 lights up for Mode 0
# Pad 14 lights up for Mode 1
# Pad 15 lights up for Mode 2
# Pad 16 lights up for Mode 3
</code></pre>
<hr />
<h2 id="feature-f26-led-fade-effects"><a class="header" href="#feature-f26-led-fade-effects">Feature F26: LED Fade Effects</a></h2>
<p>Smooth transitions and fade animations provide polished visual feedback.</p>
<h3 id="fade-out-on-release"><a class="header" href="#fade-out-on-release">Fade-Out on Release</a></h3>
<p>After pressing a pad, the LED fades out gracefully instead of turning off instantly:</p>
<p><strong>Default Behavior:</strong></p>
<ol>
<li>Pad pressed → Immediate color change (velocity-based)</li>
<li>Pad released → Wait 1 second</li>
<li>Fade begins → 200ms smooth fade to mode color or off</li>
</ol>
<p><strong>Timeline:</strong></p>
<pre><code>Press    Release            Fade Start         Complete
  |---------|-------------------|-----------------|
  0ms    Variable            +1000ms          +1200ms
  ↑                              ↑                 ↑
  Full brightness          Start fade         Dark/Mode color
</code></pre>
<h3 id="configurable-fade-parameters"><a class="header" href="#configurable-fade-parameters">Configurable Fade Parameters</a></h3>
<pre><code class="language-toml">[led_settings.fade]
delay_after_release_ms = 1000  # How long to wait before fading
fade_duration_ms = 200         # How long the fade takes
steps = 10                     # Number of discrete fade steps
</code></pre>
<h3 id="fade-applications"><a class="header" href="#fade-applications">Fade Applications</a></h3>
<p><strong>Reactive Scheme:</strong></p>
<pre><code class="language-rust">// Pseudo-code for reactive fade
on_pad_press(pad, velocity) {
    color = velocity_to_color(velocity)
    set_pad_color(pad, color)
    schedule_fade(pad, delay=1000ms, duration=200ms)
}</code></pre>
<p><strong>Mode Transition:</strong></p>
<pre><code class="language-rust">// Pseudo-code for mode transition fade
on_mode_change(old_mode, new_mode) {
    // FadeOut transition effect
    for brightness in (100% down_to 0%).step_by(10%) {
        set_all_pads(old_mode_color * brightness)
        wait(10ms)
    }
    for brightness in (0% up_to 100%).step_by(10%) {
        set_all_pads(new_mode_color * brightness)
        wait(10ms)
    }
}</code></pre>
<hr />
<h2 id="device-support"><a class="header" href="#device-support">Device Support</a></h2>
<h3 id="hid-devices-full-rgb-control"><a class="header" href="#hid-devices-full-rgb-control">HID Devices (Full RGB Control)</a></h3>
<p><strong>Native Instruments Maschine Mikro MK3:</strong></p>
<ul>
<li>✅ All 10 lighting schemes</li>
<li>✅ Full RGB color spectrum (16.7M colors)</li>
<li>✅ Velocity-based colors</li>
<li>✅ Smooth fades and transitions</li>
<li>✅ Shared device mode (works alongside NI Controller Editor)</li>
</ul>
<p><strong>Requirements:</strong></p>
<ul>
<li>macOS: Input Monitoring permission</li>
<li>USB connection: Direct HID communication</li>
<li>Drivers: Native Instruments drivers installed</li>
</ul>
<h3 id="midi-devices-onoff-only"><a class="header" href="#midi-devices-onoff-only">MIDI Devices (On/Off Only)</a></h3>
<p><strong>Supported Controllers:</strong></p>
<ul>
<li>Novation Launchpad Mini/Pro</li>
<li>Akai APC Mini/40</li>
<li>Generic MIDI pad controllers</li>
</ul>
<p><strong>Limitations:</strong></p>
<ul>
<li>❌ RGB colors (on/off only)</li>
<li>❌ Smooth fades (instant on/off)</li>
<li>✅ Reactive feedback (on when pressed, off after delay)</li>
<li>✅ Mode indicators (basic)</li>
</ul>
<p><strong>Note Range:</strong> MIDI LEDs typically respond to notes C1-D#2 (36-51) for 16 pads</p>
<hr />
<h2 id="configuration-examples-1"><a class="header" href="#configuration-examples-1">Configuration Examples</a></h2>
<h3 id="minimal-configuration"><a class="header" href="#minimal-configuration">Minimal Configuration</a></h3>
<pre><code class="language-toml">[device]
name = "Mikro"
led_feedback = true

[led_settings]
scheme = "reactive"
</code></pre>
<h3 id="advanced-configuration-1"><a class="header" href="#advanced-configuration-1">Advanced Configuration</a></h3>
<pre><code class="language-toml">[device]
name = "Mikro"
led_feedback = true

[led_settings]
scheme = "reactive"
brightness = 255

[led_settings.reactive]
soft_color = { r = 0, g = 255, b = 0 }
medium_color = { r = 255, g = 255, b = 0 }
hard_color = { r = 255, g = 0, b = 0 }
fade_duration_ms = 1000

[led_settings.transitions]
enable_effects = true
flash_duration_ms = 150
sweep_delay_ms = 30
fadeout_steps = 10
spiral_delay_ms = 15

[[modes]]
name = "Default"
color = "blue"
led_idle_brightness = 20
led_active_brightness = 255

[[modes]]
name = "Development"
color = "green"
led_idle_brightness = 30
led_active_brightness = 255
</code></pre>
<hr />
<h2 id="troubleshooting-6"><a class="header" href="#troubleshooting-6">Troubleshooting</a></h2>
<h3 id="leds-not-working-mikro-mk3"><a class="header" href="#leds-not-working-mikro-mk3">LEDs Not Working (Mikro MK3)</a></h3>
<ol>
<li>
<p><strong>Check permissions</strong> (macOS):</p>
<ul>
<li>System Settings → Privacy &amp; Security → Input Monitoring</li>
<li>Enable permission for Terminal or your IDE</li>
</ul>
</li>
<li>
<p><strong>Verify HID connection</strong>:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2 --led reactive
# Look for "✓ Connected to Mikro MK3 LED interface"
</code></pre>
</li>
<li>
<p><strong>Check for conflicts</strong>:</p>
<ul>
<li>Close Native Instruments Controller Editor</li>
<li>Unplug and replug USB cable</li>
<li>Try different USB port</li>
</ul>
</li>
</ol>
<h3 id="wrong-colors-1"><a class="header" href="#wrong-colors-1">Wrong Colors</a></h3>
<ul>
<li><strong>Issue</strong>: Colors don't match expected values</li>
<li><strong>Cause</strong>: LED manufacturing variance (±10% color accuracy)</li>
<li><strong>Solution</strong>: This is normal, colors may vary slightly between units</li>
</ul>
<h3 id="flickering-leds"><a class="header" href="#flickering-leds">Flickering LEDs</a></h3>
<ul>
<li><strong>Issue</strong>: LEDs flicker or strobe</li>
<li><strong>Cause</strong>: Update rate too high or USB bandwidth saturation</li>
<li><strong>Solution</strong>: Use simpler scheme (reactive or static) instead of complex animations</li>
</ul>
<h3 id="mode-colors-not-showing-1"><a class="header" href="#mode-colors-not-showing-1">Mode Colors Not Showing</a></h3>
<ul>
<li><strong>Issue</strong>: All pads same color regardless of mode</li>
<li><strong>Cause</strong>: Using non-mode-aware scheme</li>
<li><strong>Solution</strong>: Use <code>static</code> or <code>reactive</code> scheme, not <code>rainbow</code> or <code>sparkle</code></li>
</ul>
<hr />
<h2 id="performance-considerations"><a class="header" href="#performance-considerations">Performance Considerations</a></h2>
<h3 id="cpu-usage-by-scheme-1"><a class="header" href="#cpu-usage-by-scheme-1">CPU Usage by Scheme</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Scheme</th><th>CPU (Idle)</th><th>CPU (Active)</th><th>Memory</th></tr></thead><tbody>
<tr><td>off</td><td>0%</td><td>0%</td><td>Minimal</td></tr>
<tr><td>static</td><td>&lt;1%</td><td>&lt;1%</td><td>&lt;1MB</td></tr>
<tr><td>reactive</td><td>&lt;1%</td><td>~1%</td><td>&lt;1MB</td></tr>
<tr><td>breathing</td><td>~1%</td><td>~1%</td><td>&lt;1MB</td></tr>
<tr><td>rainbow</td><td>~2%</td><td>~2%</td><td>&lt;1MB</td></tr>
<tr><td>sparkle</td><td>~3%</td><td>~3%</td><td>~1MB</td></tr>
</tbody></table>
</div>
<h3 id="usb-bandwidth"><a class="header" href="#usb-bandwidth">USB Bandwidth</a></h3>
<ul>
<li><strong>Update Rate</strong>: 10fps (100ms per frame)</li>
<li><strong>Data per Update</strong>: 51 bytes (1 byte report ID + 50 bytes RGB data)</li>
<li><strong>Bandwidth</strong>: 510 bytes/sec (~0.004 Mbps)</li>
<li><strong>Impact</strong>: Negligible on USB 2.0 (480 Mbps)</li>
</ul>
<h3 id="recommendations"><a class="header" href="#recommendations">Recommendations</a></h3>
<ul>
<li><strong>Performance Mode</strong>: Use <code>reactive</code> or <code>static</code> for lowest CPU usage</li>
<li><strong>Visual Appeal</strong>: Use <code>rainbow</code> or <code>spiral</code> for presentations/demos</li>
<li><strong>Battery (USB-powered hubs)</strong>: Use <code>off</code> or <code>static</code> to reduce power draw</li>
</ul>
<hr />
<h2 id="api-reference"><a class="header" href="#api-reference">API Reference</a></h2>
<h3 id="trait-interface"><a class="header" href="#trait-interface">Trait Interface</a></h3>
<pre><code class="language-rust">pub trait PadFeedback: Send {
    fn connect(&amp;mut self) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
    fn set_pad_color(&amp;mut self, pad: u8, color: RGB) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
    fn set_pad_velocity(&amp;mut self, pad: u8, velocity: u8) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
    fn set_mode_colors(&amp;mut self, mode: u8) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
    fn show_velocity_feedback(&amp;mut self, pad: u8, velocity: u8) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
    fn flash_pad(&amp;mut self, pad: u8, color: RGB, duration_ms: u64) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
    fn ripple_effect(&amp;mut self, start_pad: u8, color: RGB) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
    fn clear_all(&amp;mut self) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
    fn show_long_press_feedback(&amp;mut self, pad: u8, elapsed_ms: u128) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
    fn run_scheme(&amp;mut self, scheme: &amp;LightingScheme) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;;
}</code></pre>
<h3 id="rgb-color-structure"><a class="header" href="#rgb-color-structure">RGB Color Structure</a></h3>
<pre><code class="language-rust">pub struct RGB {
    pub r: u8,  // Red: 0-255
    pub g: u8,  // Green: 0-255
    pub b: u8,  // Blue: 0-255
}

impl RGB {
    pub const OFF: RGB = RGB { r: 0, g: 0, b: 0 };
    pub const RED: RGB = RGB { r: 255, g: 0, b: 0 };
    pub const GREEN: RGB = RGB { r: 0, g: 255, b: 0 };
    pub const BLUE: RGB = RGB { r: 0, g: 0, b: 255 };
    pub const YELLOW: RGB = RGB { r: 255, g: 255, b: 0 };
    pub const PURPLE: RGB = RGB { r: 255, g: 0, b: 255 };
}</code></pre>
<hr />
<h2 id="see-also-8"><a class="header" href="#see-also-8">See Also</a></h2>
<ul>
<li><a href="reference/../configuration/led-feedback.html">Configuration → LED Feedback</a></li>
<li><a href="reference/../devices/mikro-mk3.html">Device Support → Maschine Mikro MK3</a></li>
<li><a href="reference/action-types.html">Reference → Action Types</a> (ModeChange action)</li>
<li><a href="reference/../troubleshooting/common-issues.html">Troubleshooting → Common Issues</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cli-commands-reference"><a class="header" href="#cli-commands-reference">CLI Commands Reference</a></h1>
<h2 id="overview-4"><a class="header" href="#overview-4">Overview</a></h2>
<p>MIDIMon provides a main binary and several diagnostic tools, all accessible via the command line. This reference covers all available commands, their options, and usage examples.</p>
<h2 id="main-binary-midimon"><a class="header" href="#main-binary-midimon">Main Binary: midimon</a></h2>
<p>The primary MIDIMon application.</p>
<h3 id="basic-syntax"><a class="header" href="#basic-syntax">Basic Syntax</a></h3>
<pre><code class="language-bash"># Via cargo
cargo run --release [PORT] [OPTIONS]

# Or directly
./target/release/midimon [PORT] [OPTIONS]
</code></pre>
<h3 id="arguments"><a class="header" href="#arguments">Arguments</a></h3>
<h4 id="port-required-in-some-cases"><a class="header" href="#port-required-in-some-cases">PORT (Required in some cases)</a></h4>
<p>The MIDI input port number to connect to.</p>
<p><strong>Finding available ports</strong>:</p>
<pre><code class="language-bash"># List all MIDI ports
cargo run --release

# Or
./target/release/midimon
</code></pre>
<p>Output:</p>
<pre><code>Available MIDI input ports:
0: USB MIDI Device
1: IAC Driver Bus 1
2: Maschine Mikro MK3 - Input
3: Digital Keyboard
</code></pre>
<p><strong>Usage</strong>:</p>
<pre><code class="language-bash"># Connect to port 2 (Maschine Mikro MK3)
cargo run --release 2

# Connect to port 0
cargo run --release 0
</code></pre>
<p><strong>Note</strong>: If <code>auto_connect = true</code> in <code>config.toml</code>, the port argument is optional and MIDIMon will connect to the first available port.</p>
<h3 id="options"><a class="header" href="#options">Options</a></h3>
<h4 id="--led---lighting"><a class="header" href="#--led---lighting">--led, --lighting <SCHEME></a></h4>
<p>Select LED lighting scheme (for devices with LED support).</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --release 2 --led &lt;SCHEME&gt;
# or
cargo run --release 2 --lighting &lt;SCHEME&gt;
</code></pre>
<p><strong>Available schemes</strong>:</p>
<ul>
<li><code>reactive</code> (default) - Velocity-based colors, fade out after release</li>
<li><code>rainbow</code> - Static rainbow gradient</li>
<li><code>breathing</code> - Breathing effect (all pads)</li>
<li><code>pulse</code> - Pulsing effect</li>
<li><code>wave</code> - Wave pattern with brightness gradient</li>
<li><code>sparkle</code> - Random twinkling LEDs</li>
<li><code>vumeter</code> - VU meter style gradient (green → yellow → red)</li>
<li><code>spiral</code> - Spiral/diagonal pattern</li>
<li><code>static</code> - Static single color</li>
<li><code>off</code> - LEDs disabled</li>
</ul>
<p><strong>Examples</strong>:</p>
<pre><code class="language-bash"># Reactive mode (velocity-sensitive)
cargo run --release 2 --led reactive

# Rainbow gradient
cargo run --release 2 --led rainbow

# Breathing effect
cargo run --release 2 --lighting breathing

# Turn off LEDs
cargo run --release 2 --led off
</code></pre>
<p><strong>LED Behavior by Scheme</strong>:</p>
<p><strong>reactive</strong>:</p>
<ul>
<li>Soft press (velocity &lt; 50): Green Dim</li>
<li>Medium press (50 ≤ velocity &lt; 100): Yellow Normal</li>
<li>Hard press (velocity ≥ 100): Red Bright</li>
<li>Fades out 1 second after release</li>
</ul>
<p><strong>rainbow</strong>:</p>
<ul>
<li>Static rainbow gradient across all pads</li>
<li>No animation (constant colors)</li>
</ul>
<p><strong>sparkle</strong>:</p>
<ul>
<li>Random white LEDs</li>
<li>20% probability per pad per frame</li>
<li>Updates every 100ms</li>
</ul>
<p><strong>vumeter</strong>:</p>
<ul>
<li>Green (bottom rows)</li>
<li>Yellow/Orange (middle)</li>
<li>Red (top)</li>
</ul>
<p><strong>wave</strong>:</p>
<ul>
<li>Blue with varying brightness</li>
<li>Creates wave effect</li>
</ul>
<h4 id="--profile--p"><a class="header" href="#--profile--p">--profile, -p <PATH></a></h4>
<p>Load a Native Instruments Controller Editor profile (.ncmm3 file).</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --release 2 --profile &lt;PATH&gt;
# or
cargo run --release 2 -p &lt;PATH&gt;
</code></pre>
<p><strong>Examples</strong>:</p>
<pre><code class="language-bash"># Relative path
cargo run --release 2 --profile my-profile.ncmm3

# Absolute path
cargo run --release 2 --profile ~/Downloads/base-template-ni-mikro-mk3.ncmm3

# macOS default location
cargo run --release 2 --profile "$HOME/Documents/Native Instruments/Controller Editor/Profiles/my-profile.ncmm3"
</code></pre>
<p><strong>What profiles do</strong>:</p>
<ul>
<li>Map physical pad positions to MIDI note numbers</li>
<li>Support 8 pad pages (A-H) per profile</li>
<li>Enable correct LED feedback for custom layouts</li>
<li>Allow seamless integration with NI Controller Editor</li>
</ul>
<p><strong>Creating profiles</strong>:</p>
<ol>
<li>Open Native Instruments Controller Editor</li>
<li>Select "Maschine Mikro MK3"</li>
<li>Edit pad pages (A-H)</li>
<li>Assign MIDI notes to each pad</li>
<li>Save as <code>.ncmm3</code> file</li>
<li>Use with <code>--profile</code> flag</li>
</ol>
<p>See <a href="reference/../DEVICE_PROFILES.html">Device Profiles Documentation</a> for complete guide.</p>
<h4 id="--pad-page"><a class="header" href="#--pad-page">--pad-page <PAGE></a></h4>
<p>Force a specific pad page when using a profile (instead of auto-detection).</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --release 2 --profile &lt;PATH&gt; --pad-page &lt;PAGE&gt;
</code></pre>
<p><strong>Valid pages</strong>: A, B, C, D, E, F, G, H (case-insensitive)</p>
<p><strong>Examples</strong>:</p>
<pre><code class="language-bash"># Force page A
cargo run --release 2 --profile my-profile.ncmm3 --pad-page A

# Force page H
cargo run --release 2 --profile my-profile.ncmm3 --pad-page h
</code></pre>
<p><strong>When to use</strong>:</p>
<ul>
<li>Auto-detection not working correctly</li>
<li>Want to lock to a specific page</li>
<li>Testing specific page mappings</li>
<li>Profile has identical notes across multiple pages</li>
</ul>
<p><strong>Default behavior</strong> (without <code>--pad-page</code>):</p>
<ul>
<li>Auto-detect active page from incoming MIDI notes</li>
<li>Switch pages automatically when notes from different page detected</li>
</ul>
<h4 id="--config--c"><a class="header" href="#--config--c">--config, -c <PATH></a></h4>
<p>Specify custom configuration file location.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --release 2 --config &lt;PATH&gt;
# or
cargo run --release 2 -c &lt;PATH&gt;
</code></pre>
<p><strong>Examples</strong>:</p>
<pre><code class="language-bash"># Use alternative config
cargo run --release 2 --config config-dev.toml

# Full path
cargo run --release 2 --config /etc/midimon/config.toml
</code></pre>
<p><strong>Default</strong>: <code>./config.toml</code> (current directory)</p>
<h4 id="--help--h"><a class="header" href="#--help--h">--help, -h</a></h4>
<p>Display help message with all available options.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --release -- --help
# or
./target/release/midimon --help
</code></pre>
<p>Note the <code>--</code> separator when using <code>cargo run</code>.</p>
<h4 id="--version--v"><a class="header" href="#--version--v">--version, -v</a></h4>
<p>Display MIDIMon version.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --release -- --version
# or
./target/release/midimon --version
</code></pre>
<h3 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h3>
<h4 id="debug1"><a class="header" href="#debug1">DEBUG=1</a></h4>
<p>Enable verbose debug logging.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
<p><strong>Output includes</strong>:</p>
<ul>
<li>MIDI event details (note on/off, velocity, channel)</li>
<li>HID connection status</li>
<li>LED updates (buffer contents)</li>
<li>Event processing (velocity detection, long press, chords)</li>
<li>Mapping matches and action execution</li>
<li>Mode changes</li>
<li>Error details</li>
</ul>
<p><strong>Example debug output</strong>:</p>
<pre><code>[DEBUG] Connected to MIDI port 2: Maschine Mikro MK3 - Input
[DEBUG] HID device opened successfully
[DEBUG] LED controller initialized
[DEBUG] Loaded config with 3 modes, 24 mappings
[DEBUG] Starting in mode 0: Default

[MIDI] NoteOn ch:0 note:12 vel:87
[DEBUG] Processed: Note(12) with velocity Medium
[DEBUG] Matched mapping: "Copy text" (mode: Default)
[DEBUG] Executing action: Keystroke(keys: "c", modifiers: ["cmd"])
[DEBUG] LED update: pad 0 -&gt; color 7 (Green) brightness 2
[MIDI] NoteOff ch:0 note:12 vel:0
[DEBUG] LED fade: pad 0 cleared after 1000ms
</code></pre>
<p><strong>When to use</strong>:</p>
<ul>
<li>Troubleshooting mapping issues</li>
<li>Debugging note number mismatches</li>
<li>Verifying LED control</li>
<li>Understanding event processing</li>
<li>Investigating performance issues</li>
</ul>
<h4 id="rust_log"><a class="header" href="#rust_log">RUST_LOG</a></h4>
<p>Control Rust logging levels (for development).</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">RUST_LOG=debug cargo run --release 2
RUST_LOG=trace cargo run --release 2
RUST_LOG=info cargo run --release 2
</code></pre>
<p><strong>Levels</strong>:</p>
<ul>
<li><code>error</code> - Only errors</li>
<li><code>warn</code> - Warnings and errors</li>
<li><code>info</code> - General information (default)</li>
<li><code>debug</code> - Debug information</li>
<li><code>trace</code> - Very verbose</li>
</ul>
<p><strong>Filter by module</strong>:</p>
<pre><code class="language-bash"># Only log MIDI events
RUST_LOG=midimon::midi=debug cargo run --release 2

# Multiple modules
RUST_LOG=midimon::event_processor=debug,midimon::mappings=trace cargo run --release 2
</code></pre>
<h3 id="complete-usage-examples"><a class="header" href="#complete-usage-examples">Complete Usage Examples</a></h3>
<h4 id="example-1-basic-usage"><a class="header" href="#example-1-basic-usage">Example 1: Basic Usage</a></h4>
<pre><code class="language-bash"># List ports
cargo run --release

# Connect to port 2 with default settings
cargo run --release 2
</code></pre>
<h4 id="example-2-with-led-lighting"><a class="header" href="#example-2-with-led-lighting">Example 2: With LED Lighting</a></h4>
<pre><code class="language-bash"># Reactive mode (default)
cargo run --release 2 --led reactive

# Rainbow gradient
cargo run --release 2 --led rainbow

# Sparkle effect
cargo run --release 2 --led sparkle
</code></pre>
<h4 id="example-3-with-profile"><a class="header" href="#example-3-with-profile">Example 3: With Profile</a></h4>
<pre><code class="language-bash"># Auto-detect page
cargo run --release 2 --profile my-profile.ncmm3

# Force specific page
cargo run --release 2 --profile my-profile.ncmm3 --pad-page H

# With LED scheme
cargo run --release 2 --profile my-profile.ncmm3 --led reactive
</code></pre>
<h4 id="example-4-debug-mode"><a class="header" href="#example-4-debug-mode">Example 4: Debug Mode</a></h4>
<pre><code class="language-bash"># Enable debug output
DEBUG=1 cargo run --release 2

# With all options
DEBUG=1 cargo run --release 2 --profile my-profile.ncmm3 --led reactive
</code></pre>
<h4 id="example-5-custom-config"><a class="header" href="#example-5-custom-config">Example 5: Custom Config</a></h4>
<pre><code class="language-bash"># Use development config
cargo run --release 2 --config config-dev.toml

# Use config from different directory
cargo run --release 2 --config ~/midimon-configs/work.toml
</code></pre>
<h4 id="example-6-production-binary"><a class="header" href="#example-6-production-binary">Example 6: Production Binary</a></h4>
<pre><code class="language-bash"># Build release
cargo build --release

# Run with all options
./target/release/midimon 2 \
    --profile ~/Documents/NI/my-profile.ncmm3 \
    --led reactive \
    --config ~/midimon-configs/production.toml
</code></pre>
<h2 id="diagnostic-tools"><a class="header" href="#diagnostic-tools">Diagnostic Tools</a></h2>
<p>MIDIMon includes several diagnostic utilities for debugging and configuration.</p>
<h3 id="midi_diagnostic"><a class="header" href="#midi_diagnostic">midi_diagnostic</a></h3>
<p>Visualize all incoming MIDI events in real-time.</p>
<p><strong>Purpose</strong>: Debug MIDI connectivity, view raw MIDI data, verify device is sending events.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin midi_diagnostic [PORT]
</code></pre>
<p><strong>Example</strong>:</p>
<pre><code class="language-bash"># Connect to port 2
cargo run --bin midi_diagnostic 2
</code></pre>
<p><strong>Output</strong>:</p>
<pre><code>Connected to MIDI port 2: Maschine Mikro MK3 - Input
Listening for MIDI events... (Ctrl+C to exit)

[NoteOn]  ch:0 note:12 vel:87
[NoteOff] ch:0 note:12 vel:0
[NoteOn]  ch:0 note:13 vel:45
[NoteOff] ch:0 note:13 vel:0
[CC]      ch:0 cc:1 value:64
[PitchBend] ch:0 value:8192
</code></pre>
<p><strong>Event types shown</strong>:</p>
<ul>
<li><code>NoteOn</code> - Pad/key pressed</li>
<li><code>NoteOff</code> - Pad/key released</li>
<li><code>CC</code> - Control Change (knobs, sliders)</li>
<li><code>PitchBend</code> - Touch strip, pitch wheel</li>
<li><code>Aftertouch</code> - Pressure sensitivity</li>
<li><code>ProgramChange</code> - Program/patch change</li>
</ul>
<p><strong>When to use</strong>:</p>
<ul>
<li>Verify MIDI device is connected</li>
<li>Find note numbers for pads/keys</li>
<li>Debug why mappings aren't triggering</li>
<li>Check velocity ranges</li>
<li>Verify CC numbers for encoders/knobs</li>
</ul>
<p><strong>Press Ctrl+C to exit.</strong></p>
<h3 id="led_diagnostic"><a class="header" href="#led_diagnostic">led_diagnostic</a></h3>
<p>Test LED functionality and HID connection.</p>
<p><strong>Purpose</strong>: Verify HID access, test LED control, debug LED issues.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin led_diagnostic
</code></pre>
<p><strong>What it does</strong>:</p>
<ol>
<li>Attempts to open HID device</li>
<li>Displays connection status</li>
<li>Tests individual LED control</li>
<li>Cycles through all pads with different colors</li>
</ol>
<p><strong>Output</strong>:</p>
<pre><code>LED Diagnostic Tool
==================

Searching for Maschine Mikro MK3...
✓ Device found: Maschine Mikro MK3 (17cc:1600)
✓ HID device opened successfully

Testing LED control...
- Lighting pad 0 (Red Bright)
- Lighting pad 1 (Green Bright)
- Lighting pad 2 (Blue Bright)
...
- Clearing all pads

✓ LED diagnostic complete
</code></pre>
<p><strong>Error output</strong> (if HID not accessible):</p>
<pre><code>✗ Failed to open HID device
  Possible causes:
  - Device not connected
  - Input Monitoring permission not granted
  - Native Instruments drivers not installed

  Solutions:
  1. Check USB connection
  2. Grant Input Monitoring permission (System Settings → Privacy &amp; Security)
  3. Install NI drivers via Native Access
</code></pre>
<p><strong>When to use</strong>:</p>
<ul>
<li>LEDs not working in main application</li>
<li>Verify HID access before running midimon</li>
<li>Test after granting permissions</li>
<li>Debug LED coordinate mapping issues</li>
</ul>
<h3 id="led_tester"><a class="header" href="#led_tester">led_tester</a></h3>
<p>Interactive LED testing tool.</p>
<p><strong>Purpose</strong>: Manual control of individual LEDs for testing and debugging.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin led_tester
</code></pre>
<p><strong>Interactive mode</strong>:</p>
<pre><code>LED Tester - Interactive Mode
==============================

Commands:
  on &lt;pad&gt; &lt;color&gt; &lt;brightness&gt;  - Turn on LED
  off &lt;pad&gt;                      - Turn off LED
  all &lt;color&gt; &lt;brightness&gt;       - Set all LEDs
  clear                          - Clear all LEDs
  rainbow                        - Show rainbow pattern
  test                           - Cycle through all pads
  quit                           - Exit

&gt; on 0 red 3
✓ Pad 0: Red Bright

&gt; all blue 2
✓ All pads: Blue Normal

&gt; rainbow
✓ Rainbow pattern displayed

&gt; quit
</code></pre>
<p><strong>Colors</strong>: red, orange, yellow, green, blue, purple, magenta, white</p>
<p><strong>Brightness</strong>: 0 (off), 1 (dim), 2 (normal), 3 (bright)</p>
<p><strong>When to use</strong>:</p>
<ul>
<li>Test specific pad LEDs</li>
<li>Verify coordinate mapping</li>
<li>Experiment with colors and brightness</li>
<li>Debug LED patterns</li>
</ul>
<h3 id="pad_mapper"><a class="header" href="#pad_mapper">pad_mapper</a></h3>
<p>Find MIDI note numbers for physical pads.</p>
<p><strong>Purpose</strong>: Discover note numbers to use in <code>config.toml</code>.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin pad_mapper [PORT]
</code></pre>
<p><strong>Example</strong>:</p>
<pre><code class="language-bash">cargo run --bin pad_mapper 2
</code></pre>
<p><strong>Usage</strong>:</p>
<ol>
<li>Run the tool</li>
<li>Press each pad on your controller</li>
<li>Write down the note number displayed</li>
<li>Use those numbers in your config</li>
</ol>
<p><strong>Output</strong>:</p>
<pre><code>Pad Mapper - Press pads to see note numbers
============================================
Connected to port 2: Maschine Mikro MK3 - Input

Press pads... (Ctrl+C to exit)

Pad pressed: Note 12 (velocity: 87)
Pad pressed: Note 13 (velocity: 64)
Pad pressed: Note 14 (velocity: 103)
Pad pressed: Note 15 (velocity: 52)
</code></pre>
<p><strong>Tips</strong>:</p>
<ul>
<li>Press pads in order (bottom-left to top-right)</li>
<li>Draw a grid on paper and write down note numbers</li>
<li>Use this data to update <code>config.toml</code></li>
</ul>
<p><strong>When to use</strong>:</p>
<ul>
<li>Setting up a new device</li>
<li>Creating initial config</li>
<li>Mapping custom devices</li>
<li>Verifying profile note numbers</li>
</ul>
<h3 id="test_midi"><a class="header" href="#test_midi">test_midi</a></h3>
<p>Test MIDI port connectivity and enumerate devices.</p>
<p><strong>Purpose</strong>: Quick MIDI connectivity test, list all available ports.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin test_midi
</code></pre>
<p><strong>Output</strong>:</p>
<pre><code>MIDI Port Test
==============

Available input ports:
0: USB MIDI Device
1: IAC Driver Bus 1
2: Maschine Mikro MK3 - Input
3: Digital Keyboard

Available output ports:
0: USB MIDI Device
1: IAC Driver Bus 1
2: Maschine Mikro MK3 - Output

Testing port 2 (input)...
✓ Successfully opened port: Maschine Mikro MK3 - Input

Press a pad to test... (5 second timeout)
✓ Received MIDI event: NoteOn ch:0 note:12 vel:87

Connection test: PASSED
</code></pre>
<p><strong>When to use</strong>:</p>
<ul>
<li>Verify MIDI device detected</li>
<li>Check port numbers before running midimon</li>
<li>Debug connectivity issues</li>
<li>Confirm MIDI cable is working</li>
</ul>
<h2 id="command-quick-reference"><a class="header" href="#command-quick-reference">Command Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Purpose</th><th>Example</th></tr></thead><tbody>
<tr><td><code>midimon [PORT]</code></td><td>Main application</td><td><code>cargo run --release 2</code></td></tr>
<tr><td><code>--led &lt;SCHEME&gt;</code></td><td>Set LED scheme</td><td><code>cargo run --release 2 --led rainbow</code></td></tr>
<tr><td><code>--profile &lt;PATH&gt;</code></td><td>Load profile</td><td><code>cargo run --release 2 --profile my.ncmm3</code></td></tr>
<tr><td><code>--pad-page &lt;PAGE&gt;</code></td><td>Force pad page</td><td><code>cargo run --release 2 --pad-page H</code></td></tr>
<tr><td><code>--config &lt;PATH&gt;</code></td><td>Custom config</td><td><code>cargo run --release 2 --config dev.toml</code></td></tr>
<tr><td><code>DEBUG=1</code></td><td>Enable debug log</td><td><code>DEBUG=1 cargo run --release 2</code></td></tr>
<tr><td><code>midi_diagnostic</code></td><td>View MIDI events</td><td><code>cargo run --bin midi_diagnostic 2</code></td></tr>
<tr><td><code>led_diagnostic</code></td><td>Test LEDs</td><td><code>cargo run --bin led_diagnostic</code></td></tr>
<tr><td><code>led_tester</code></td><td>Interactive LED test</td><td><code>cargo run --bin led_tester</code></td></tr>
<tr><td><code>pad_mapper</code></td><td>Find note numbers</td><td><code>cargo run --bin pad_mapper 2</code></td></tr>
<tr><td><code>test_midi</code></td><td>Test MIDI ports</td><td><code>cargo run --bin test_midi</code></td></tr>
</tbody></table>
</div>
<h2 id="common-workflows"><a class="header" href="#common-workflows">Common Workflows</a></h2>
<h3 id="first-time-setup"><a class="header" href="#first-time-setup">First-Time Setup</a></h3>
<pre><code class="language-bash"># 1. List available ports
cargo run --release

# 2. Test connectivity
cargo run --bin test_midi

# 3. Map pads to note numbers
cargo run --bin pad_mapper 2

# 4. Run with basic settings
cargo run --release 2

# 5. Test LEDs
cargo run --release 2 --led rainbow
</code></pre>
<h3 id="troubleshooting-7"><a class="header" href="#troubleshooting-7">Troubleshooting</a></h3>
<pre><code class="language-bash"># 1. Check MIDI events are received
cargo run --bin midi_diagnostic 2

# 2. Enable debug logging
DEBUG=1 cargo run --release 2

# 3. Test LED control
cargo run --bin led_diagnostic

# 4. Verify port numbers
cargo run --bin test_midi
</code></pre>
<h3 id="production-use"><a class="header" href="#production-use">Production Use</a></h3>
<pre><code class="language-bash"># Build optimized binary
cargo build --release

# Run with all options
./target/release/midimon 2 \
    --profile ~/profiles/work.ncmm3 \
    --led reactive \
    --config ~/configs/production.toml

# Or use shell script
#!/bin/bash
DEBUG=0 ./target/release/midimon 2 \
    --profile "$HOME/Documents/NI/my-profile.ncmm3" \
    --led reactive \
    &gt; /tmp/midimon.log 2&gt;&amp;1 &amp;
</code></pre>
<h2 id="see-also-9"><a class="header" href="#see-also-9">See Also</a></h2>
<ul>
<li><a href="reference/../installation/macos.html">macOS Installation</a> - Platform-specific setup</li>
<li><a href="reference/../installation/building.html">Building Guide</a> - Build from source</li>
<li><a href="reference/../troubleshooting/diagnostics.html">Diagnostics Guide</a> - Detailed troubleshooting</li>
<li><a href="reference/../configuration/overview.html">Configuration Overview</a> - Config file structure</li>
</ul>
<hr />
<p><strong>Last Updated</strong>: November 11, 2025
<strong>Binary Version</strong>: 0.1.0</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="config-file-schema"><a class="header" href="#config-file-schema">Config File Schema</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-6"><a class="header" href="#coming-soon-6">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="reference/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="environment-variables-1"><a class="header" href="#environment-variables-1">Environment Variables</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-7"><a class="header" href="#coming-soon-7">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="reference/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compatibility-matrix"><a class="header" href="#compatibility-matrix">Compatibility Matrix</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-8"><a class="header" href="#coming-soon-8">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="devices/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="maschine-mikro-mk3"><a class="header" href="#maschine-mikro-mk3">Maschine Mikro MK3</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-9"><a class="header" href="#coming-soon-9">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="devices/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="generic-midi-controllers"><a class="header" href="#generic-midi-controllers">Generic MIDI Controllers</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-10"><a class="header" href="#coming-soon-10">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="devices/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-device-profiles"><a class="header" href="#creating-device-profiles">Creating Device Profiles</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-11"><a class="header" href="#coming-soon-11">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="devices/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development-setup"><a class="header" href="#development-setup">Development Setup</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-12"><a class="header" href="#coming-soon-12">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="development/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="architecture-overview"><a class="header" href="#architecture-overview">Architecture Overview</a></h1>
<h2 id="current-architecture-phase-1"><a class="header" href="#current-architecture-phase-1">Current Architecture (Phase 1)</a></h2>
<p>MIDIMon is currently implemented as a <strong>single-binary Rust application</strong> with all functionality in one crate. This design prioritizes rapid development and feature validation.</p>
<h3 id="system-architecture"><a class="header" href="#system-architecture">System Architecture</a></h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                        MIDIMon CLI                          │
│                    (Single Binary)                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌──────────────┐    ┌──────────────┐  │
│  │   Config    │───▶│    Engine    │◀──▶│  Feedback    │  │
│  │   Loader    │    │              │    │   System     │  │
│  └─────────────┘    └──────────────┘    └──────────────┘  │
│         │                   │                    │         │
│         │                   │                    │         │
│         ▼                   ▼                    ▼         │
│  ┌─────────────┐    ┌──────────────┐    ┌──────────────┐  │
│  │  Mappings   │    │    Event     │    │  HID/MIDI    │  │
│  │   Engine    │    │  Processor   │    │   LEDs       │  │
│  └─────────────┘    └──────────────┘    └──────────────┘  │
│         │                   │                              │
│         │                   │                              │
│         ▼                   ▼                              │
│  ┌─────────────┐    ┌──────────────┐                      │
│  │   Actions   │    │  Device I/O  │                      │
│  │  Executor   │    │ (midir/HID)  │                      │
│  └─────────────┘    └──────────────┘                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 id="event-processing-pipeline"><a class="header" href="#event-processing-pipeline">Event Processing Pipeline</a></h3>
<p>The system uses a three-stage event processing architecture:</p>
<pre><code>┌──────────────────┐
│   MIDI Device    │
└────────┬─────────┘
         │ Raw bytes
         ▼
┌──────────────────┐
│   MidiEvent      │  (Note On/Off, CC, Velocity)
└────────┬─────────┘
         │
         ▼
┌──────────────────┐
│ Event Processor  │  (State Machine)
│  - Velocity      │  - Soft/Med/Hard levels
│  - Long Press    │  - Hold detection (2000ms)
│  - Double-Tap    │  - Quick succession (300ms)
│  - Chord         │  - Simultaneous notes (50ms)
│  - Encoder       │  - Direction detection
└────────┬─────────┘
         │ ProcessedEvent
         ▼
┌──────────────────┐
│ Mapping Engine   │  (Mode-aware matching)
│  - Global maps   │
│  - Mode maps     │
│  - Trigger match │
└────────┬─────────┘
         │ Action
         ▼
┌──────────────────┐
│ Action Executor  │  (enigo for input simulation)
│  - Keystroke     │
│  - Shell         │
│  - Launch        │
│  - Volume        │
└──────────────────┘
</code></pre>
<h3 id="core-components"><a class="header" href="#core-components">Core Components</a></h3>
<h4 id="mainrs"><a class="header" href="#mainrs">main.rs</a></h4>
<ul>
<li><strong>Entry Point</strong>: CLI argument parsing, device enumeration</li>
<li><strong>MIDI Connection</strong>: Sets up <code>midir</code> input callbacks</li>
<li><strong>Event Loop</strong>: Coordinates event processing thread</li>
<li><strong>Mode Management</strong>: Tracks current mode via <code>AtomicU8</code></li>
<li><strong>Device Profiles</strong>: Loads <code>.ncmm3</code> profiles for pad mapping</li>
</ul>
<h4 id="configrs"><a class="header" href="#configrs">config.rs</a></h4>
<ul>
<li><strong>Configuration Types</strong>: <code>Config</code>, <code>Mode</code>, <code>Mapping</code>, <code>Trigger</code>, <code>ActionConfig</code></li>
<li><strong>TOML Parsing</strong>: Loads and validates <code>config.toml</code></li>
<li><strong>Serialization</strong>: Supports saving default configs</li>
</ul>
<h4 id="event_processorrs"><a class="header" href="#event_processorrs">event_processor.rs</a></h4>
<ul>
<li><strong>State Machine</strong>: Transforms raw MIDI → ProcessedEvent</li>
<li><strong>Timing Detection</strong>: Long press, double-tap, hold threshold</li>
<li><strong>Velocity Ranges</strong>: Soft (0-40), Medium (41-80), Hard (81-127)</li>
<li><strong>Chord Detection</strong>: Buffers notes within 50ms window</li>
<li><strong>Encoder Direction</strong>: Detects clockwise/counterclockwise rotation</li>
</ul>
<h4 id="mappingsrs"><a class="header" href="#mappingsrs">mappings.rs</a></h4>
<ul>
<li><strong>Mapping Engine</strong>: Matches <code>ProcessedEvent</code> → <code>Action</code></li>
<li><strong>Mode System</strong>: Global mappings + per-mode mappings</li>
<li><strong>Trigger Matching</strong>: Supports Note, CC, Chord, Velocity, LongPress, DoubleTap</li>
<li><strong>Compilation</strong>: Converts <code>Trigger</code> config → <code>CompiledTrigger</code> for fast matching</li>
</ul>
<h4 id="actionsrs"><a class="header" href="#actionsrs">actions.rs</a></h4>
<ul>
<li><strong>Action Executor</strong>: Executes compiled actions via <code>enigo</code></li>
<li><strong>Keystroke Simulation</strong>: Key sequences with modifiers</li>
<li><strong>Application Launch</strong>: Platform-specific (macOS <code>open</code>, Linux <code>exec</code>, Windows <code>start</code>)</li>
<li><strong>Shell Execution</strong>: Runs arbitrary shell commands</li>
<li><strong>Sequences</strong>: Chains multiple actions with delays</li>
</ul>
<h4 id="feedbackrs"><a class="header" href="#feedbackrs">feedback.rs</a></h4>
<ul>
<li><strong>Trait Abstraction</strong>: <code>PadFeedback</code> trait for LED control</li>
<li><strong>Device Factory</strong>: Creates HID (Mikro MK3) or MIDI feedback</li>
<li><strong>Lighting Schemes</strong>: Off, Static, Breathing, Pulse, Rainbow, Wave, Sparkle, Reactive, VuMeter, Spiral</li>
</ul>
<h4 id="mikro_ledsrs"><a class="header" href="#mikro_ledsrs">mikro_leds.rs</a></h4>
<ul>
<li><strong>HID Control</strong>: Direct RGB LED control via <code>hidapi</code></li>
<li><strong>Maschine Mikro MK3</strong>: Full RGB control, 16 pads</li>
<li><strong>Shared Device Mode</strong>: macOS shared access (runs alongside NI Controller Editor)</li>
<li><strong>Effects</strong>: Velocity feedback, mode colors, reactive lighting</li>
</ul>
<h4 id="midi_feedbackrs"><a class="header" href="#midi_feedbackrs">midi_feedback.rs</a></h4>
<ul>
<li><strong>Standard MIDI</strong>: Fallback LED control via MIDI Note messages</li>
<li><strong>Generic Devices</strong>: Works with any MIDI device with LED support</li>
<li><strong>Limited Features</strong>: On/off only, no color control</li>
</ul>
<h4 id="device_profilers"><a class="header" href="#device_profilers">device_profile.rs</a></h4>
<ul>
<li><strong>NI Profile Parser</strong>: Parses <code>.ncmm3</code> XML from Controller Editor</li>
<li><strong>Pad Mapping</strong>: Maps physical pad positions → MIDI notes</li>
<li><strong>Page Support</strong>: Handles pad pages (A-H) for multi-page controllers</li>
<li><strong>Auto-Detection</strong>: Detects active pad page from incoming MIDI</li>
</ul>
<h3 id="key-design-patterns"><a class="header" href="#key-design-patterns">Key Design Patterns</a></h3>
<h4 id="mode-system"><a class="header" href="#mode-system">Mode System</a></h4>
<p>Multiple modes (Default, Development, Media, etc.) allow different mapping sets. Each mode has:</p>
<ul>
<li>Distinct name and color theme</li>
<li>Mode-specific mappings</li>
<li>LED color scheme</li>
</ul>
<p>Mode changes triggered by:</p>
<ul>
<li>Encoder rotation (CC messages)</li>
<li>Specific pad combinations</li>
<li>Programmatic mode switching</li>
</ul>
<h4 id="global-vs-mode-mappings"><a class="header" href="#global-vs-mode-mappings">Global vs Mode Mappings</a></h4>
<ul>
<li><strong>Global Mappings</strong>: Active in all modes (e.g., emergency exit, encoder volume)</li>
<li><strong>Mode Mappings</strong>: Scoped to specific modes (e.g., dev tools in Development mode)</li>
</ul>
<h4 id="profile-based-note-mapping"><a class="header" href="#profile-based-note-mapping">Profile-Based Note Mapping</a></h4>
<p>Supports loading NI Controller Editor profiles (<code>.ncmm3</code>) to:</p>
<ul>
<li>Map physical pad positions to MIDI notes</li>
<li>Handle different pad pages (A-H)</li>
<li>Auto-detect active pad page from events</li>
<li>Support custom controller configurations</li>
</ul>
<h4 id="led-feedback-system"><a class="header" href="#led-feedback-system">LED Feedback System</a></h4>
<p>Trait-based abstraction (<code>PadFeedback</code>) supports:</p>
<ul>
<li><strong>HID Devices</strong>: Full RGB control (Maschine Mikro MK3)</li>
<li><strong>MIDI Devices</strong>: Basic on/off via MIDI Note messages</li>
</ul>
<p><strong>Reactive Mode</strong>: LEDs respond to velocity:</p>
<ul>
<li>Soft (green), Medium (yellow), Hard (red)</li>
<li>Fade-out 1 second after release</li>
</ul>
<p><strong>Mode Colors</strong>: Distinct color themes per mode</p>
<ul>
<li>Mode 0: Blue</li>
<li>Mode 1: Green</li>
<li>Mode 2: Purple</li>
</ul>
<h3 id="threading-and-concurrency"><a class="header" href="#threading-and-concurrency">Threading and Concurrency</a></h3>
<pre><code>┌─────────────────────┐
│   Main Thread       │
│   - Config load     │
│   - Device connect  │
│   - Ctrl+C handler  │
└──────────┬──────────┘
           │
           ├─────────────────────────┐
           │                         │
           ▼                         ▼
┌─────────────────────┐   ┌─────────────────────┐
│   MIDI Callback     │   │   LED Effect        │
│   - Raw bytes       │   │   - Background      │
│   - crossbeam send  │   │   - Lighting loop   │
└──────────┬──────────┘   └─────────────────────┘
           │
           ▼
┌─────────────────────┐
│   Event Thread      │
│   - Process events  │
│   - Match mappings  │
│   - Execute actions │
└─────────────────────┘
</code></pre>
<p><strong>Current Threading Model</strong>:</p>
<ul>
<li><strong>Main Thread</strong>: Setup, config loading, signal handling</li>
<li><strong>MIDI Callbacks</strong>: Lock-free (via <code>crossbeam-channel</code>)</li>
<li><strong>Event Thread</strong>: Dedicated thread for event processing</li>
<li><strong>LED Effects</strong>: Optional background thread for lighting schemes</li>
</ul>
<p><strong>Atomic State</strong>:</p>
<ul>
<li><code>AtomicU8</code> for current mode (lock-free reads/writes)</li>
<li><code>AtomicBool</code> for running flag (graceful shutdown)</li>
</ul>
<h3 id="performance-characteristics"><a class="header" href="#performance-characteristics">Performance Characteristics</a></h3>
<ul>
<li><strong>Event Latency</strong>: &lt;1ms typical</li>
<li><strong>Memory Usage</strong>: 5-10MB</li>
<li><strong>CPU Usage</strong>: &lt;1% idle, &lt;5% active</li>
<li><strong>Binary Size</strong>: ~3-5MB (release with LTO)</li>
</ul>
<h3 id="dependencies"><a class="header" href="#dependencies">Dependencies</a></h3>
<p><strong>Core Dependencies</strong>:</p>
<ul>
<li><code>midir</code>: Cross-platform MIDI I/O</li>
<li><code>enigo</code>: Keyboard/mouse simulation</li>
<li><code>hidapi</code>: HID device access (with <code>macos-shared-device</code>)</li>
<li><code>serde</code>/<code>toml</code>: Config parsing</li>
<li><code>quick-xml</code>: XML profile parsing</li>
<li><code>crossbeam-channel</code>: Lock-free event channels</li>
</ul>
<p><strong>Platform-Specific</strong>:</p>
<ul>
<li>macOS: AppleScript for volume control</li>
<li>Linux: <code>xdotool</code> (optional, for input simulation)</li>
<li>Windows: Native Windows APIs</li>
</ul>
<h2 id="future-architecture-phase-2"><a class="header" href="#future-architecture-phase-2">Future Architecture (Phase 2+)</a></h2>
<p>The roadmap includes migrating to a <strong>workspace structure</strong> with separate crates. See <a href="development/../../docs/workspace-structure.html">Workspace Structure Design</a> for complete details (AMI-124).</p>
<h3 id="target-structure"><a class="header" href="#target-structure">Target Structure</a></h3>
<pre><code>midimon/
├── Cargo.toml                      # Workspace root manifest
├── midimon-core/                   # Pure Rust engine (UI-free)
│   ├── Cargo.toml
│   └── src/
│       ├── lib.rs                  # Public API
│       ├── engine.rs               # MidiMonEngine
│       ├── config.rs               # Config types
│       ├── events.rs               # Event types
│       ├── mappings.rs             # Mapping engine
│       ├── actions.rs              # Action execution
│       ├── feedback.rs             # LED feedback
│       ├── device_profile.rs       # NI profile parser
│       └── error.rs                # Error types
├── midimon-daemon/                 # CLI binary (current main.rs)
│   ├── Cargo.toml
│   └── src/
│       ├── main.rs                 # CLI entry point
│       ├── cli.rs                  # Argument parsing
│       ├── debug.rs                # Debug output
│       └── bin/                    # Diagnostic tools
├── midimon-gui/                    # Tauri UI (Phase 4)
│   ├── Cargo.toml
│   ├── src-tauri/
│   └── ui/
└── config/                         # Config templates
    ├── default.toml
    ├── examples/
    └── device_templates/
</code></pre>
<h3 id="workspace-dependency-graph"><a class="header" href="#workspace-dependency-graph">Workspace Dependency Graph</a></h3>
<pre><code class="language-mermaid">graph TD
    A[midimon-gui&lt;br/&gt;Tauri UI] --&gt;|depends on| C[midimon-core&lt;br/&gt;Engine Library]
    B[midimon-daemon&lt;br/&gt;CLI Binary] --&gt;|depends on| C
    C --&gt;|no dependencies on| A
    C --&gt;|no dependencies on| B

    style C fill:#4a90e2,stroke:#2e5f8a,stroke-width:3px,color:#fff
    style A fill:#50c878,stroke:#2d7a4d,stroke-width:2px,color:#fff
    style B fill:#50c878,stroke:#2d7a4d,stroke-width:2px,color:#fff
</code></pre>
<h3 id="phase-2-core-library-extraction"><a class="header" href="#phase-2-core-library-extraction">Phase 2: Core Library Extraction</a></h3>
<p><strong>Goal</strong>: Extract engine logic into reusable <code>midimon-core</code> crate (AMI-123, AMI-124).</p>
<p><strong>Public API</strong> (from <a href="development/../../docs/api-design.html">API Design</a>):</p>
<pre><code class="language-rust">pub struct MidiMonEngine;
impl MidiMonEngine {
    pub fn new(config: Config) -&gt; Result&lt;Self, EngineError&gt;;
    pub fn start(&amp;mut self) -&gt; Result&lt;(), EngineError&gt;;
    pub fn stop(&amp;mut self) -&gt; Result&lt;(), EngineError&gt;;
    pub fn reload_config(&amp;mut self, config: Config) -&gt; Result&lt;(), EngineError&gt;;
    pub fn current_mode(&amp;self) -&gt; u8;
    pub fn set_mode(&amp;mut self, mode: u8) -&gt; Result&lt;(), EngineError&gt;;
    pub fn config(&amp;self) -&gt; Config;
    pub fn stats(&amp;self) -&gt; EngineStats;

    // Callbacks for integration
    pub fn on_mode_change&lt;F&gt;(&amp;mut self, callback: F)
    where F: Fn(u8) + Send + 'static;

    pub fn on_action&lt;F&gt;(&amp;mut self, callback: F)
    where F: Fn(&amp;ProcessedEvent, &amp;Action) + Send + 'static;
}</code></pre>
<p><strong>Module Separation</strong>:</p>
<ul>
<li><strong>Public Modules</strong>: <code>config</code>, <code>engine</code>, <code>events</code>, <code>actions</code>, <code>feedback</code>, <code>device</code>, <code>error</code></li>
<li><strong>Private Modules</strong>: <code>event_processor</code>, <code>timing</code>, <code>chord</code>, <code>velocity</code></li>
</ul>
<p><strong>Benefits</strong>:</p>
<ul>
<li>Reusable engine for CLI, daemon, GUI</li>
<li>Zero UI dependencies in core (no <code>colored</code>, <code>chrono</code> for display)</li>
<li>Clean API boundaries with trait-based abstractions</li>
<li>Easier testing and integration</li>
<li>Thread-safe with Arc/RwLock for shared state</li>
</ul>
<p><strong>Build Commands</strong>:</p>
<pre><code class="language-bash"># Build core library only
cargo build -p midimon-core

# Build CLI daemon
cargo build -p midimon-daemon --release

# Run with new structure
cargo run -p midimon-daemon --release -- 2 --led reactive

# Test workspace
cargo test --workspace
</code></pre>
<h3 id="phase-3-daemon-and-menu-bar"><a class="header" href="#phase-3-daemon-and-menu-bar">Phase 3: Daemon and Menu Bar</a></h3>
<p><strong>Goal</strong>: Add <code>midimon-daemon</code> with macOS menu bar integration.</p>
<p><strong>Features</strong>:</p>
<ul>
<li>System tray icon with status</li>
<li>Quick actions (Pause, Reload, Open Config)</li>
<li>Config hot-reloading via <code>notify</code> crate</li>
<li>Auto-start via LaunchAgent or Tauri autostart plugin</li>
<li>Frontmost app detection for per-app profiles</li>
</ul>
<p><strong>Integration Pattern</strong>:</p>
<pre><code class="language-rust">use midimon_core::{Config, MidiMonEngine};

fn main() -&gt; Result&lt;()&gt; {
    let config = Config::load("config.toml")?;
    let mut engine = MidiMonEngine::new(config)?;

    // Register callbacks for UI updates
    engine.on_mode_change(|mode| {
        update_menu_bar_icon(mode);
    });

    engine.start()?;
    Ok(())
}</code></pre>
<h3 id="phase-4-gui-configuration"><a class="header" href="#phase-4-gui-configuration">Phase 4: GUI Configuration</a></h3>
<p><strong>Goal</strong>: Add <code>midimon-gui</code> with Tauri-based visual config editor.</p>
<p><strong>Features</strong>:</p>
<ul>
<li>Visual device mapping with SVG pad layouts</li>
<li>MIDI Learn mode (click → press → bind)</li>
<li>Profile management (import/export/share)</li>
<li>Live event console with filtering</li>
<li>Velocity curve editor</li>
<li>Test bindings without saving</li>
</ul>
<p><strong>UI Components</strong>:</p>
<ul>
<li>Device visualizer (16-pad grid for Maschine Mikro MK3)</li>
<li>Mapping editor (trigger → action configuration)</li>
<li>Profile switcher (per-app profiles)</li>
<li>Event log (real-time MIDI/HID events)</li>
<li>Settings panel (advanced timing, thresholds)</li>
</ul>
<h2 id="configuration-backward-compatibility"><a class="header" href="#configuration-backward-compatibility">Configuration Backward Compatibility</a></h2>
<p><strong>Core Commitment</strong>: Configuration files created for v0.1.0 will work in all v1.x.x versions without modification.</p>
<h3 id="stability-guarantees"><a class="header" href="#stability-guarantees">Stability Guarantees</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Section</th><th>v0.1.0</th><th>v0.2.0</th><th>v1.0.0</th><th>Stability</th></tr></thead><tbody>
<tr><td><code>[device]</code></td><td>✅</td><td>✅</td><td>✅</td><td><strong>Stable</strong></td></tr>
<tr><td><code>[[modes]]</code></td><td>✅</td><td>✅</td><td>✅</td><td><strong>Stable</strong></td></tr>
<tr><td><code>[[global_mappings]]</code></td><td>✅</td><td>✅</td><td>✅</td><td><strong>Stable</strong> (optional, defaults to empty)</td></tr>
<tr><td><code>[advanced_settings]</code></td><td>⚠️</td><td>✅</td><td>✅</td><td><strong>Optional</strong> (defaults provided)</td></tr>
</tbody></table>
</div>
<p><strong>Legend</strong>:</p>
<ul>
<li>✅ <strong>Fully Supported</strong>: Section works identically across versions</li>
<li>⚠️  <strong>Optional</strong>: Section is optional with sensible defaults</li>
</ul>
<h3 id="version-compatibility"><a class="header" href="#version-compatibility">Version Compatibility</a></h3>
<pre><code>v0.1.0 config → v0.2.0 engine ✅ (100% compatible)
v0.1.0 config → v1.0.0 engine ✅ (100% compatible)

v0.2.0 config → v0.1.0 engine ⚠️  (new features ignored with warnings)
v1.0.0 config → v0.1.0 engine ⚠️  (new features ignored with warnings)
</code></pre>
<h3 id="deprecation-policy"><a class="header" href="#deprecation-policy">Deprecation Policy</a></h3>
<p>MIDIMon follows <strong>semantic versioning</strong> (SemVer) for configuration:</p>
<ul>
<li><strong>Major version (x.0.0)</strong>: May introduce breaking changes with migration tools</li>
<li><strong>Minor version (0.x.0)</strong>: Adds features in backward-compatible manner</li>
<li><strong>Patch version (0.0.x)</strong>: Bug fixes only, no config changes</li>
</ul>
<p><strong>Breaking changes</strong> require:</p>
<ol>
<li>Deprecation notice (version N)</li>
<li>Deprecation period with warnings (version N+1)</li>
<li>Removal with migration tool (version N+2, major bump)</li>
</ol>
<h3 id="test-coverage"><a class="header" href="#test-coverage">Test Coverage</a></h3>
<p>All v0.1.0 configuration examples are validated in CI/CD via <code>tests/config_compatibility_test.rs</code>:</p>
<ul>
<li><strong>CFG-001</strong>: Basic config.toml loads without errors</li>
<li><strong>CFG-003</strong>: Minimal device-only configs use defaults</li>
<li><strong>CFG-004</strong>: All trigger types parse correctly</li>
<li><strong>CFG-005</strong>: All action types parse correctly</li>
<li><strong>CFG-006</strong>: Complex sequences work</li>
<li><strong>CFG-007</strong>: Multiple modes supported</li>
<li><strong>CFG-009</strong>: Legacy v0.1.0 syntax always works</li>
<li><strong>CFG-010</strong>: Invalid syntax produces clear error messages</li>
</ul>
<p><strong>Coverage Requirements</strong>:</p>
<ul>
<li>100% coverage for config parsing (<code>src/config.rs</code>)</li>
<li>All documentation examples must parse successfully</li>
<li>Regression tests for every released version</li>
</ul>
<p>For complete details, see: <strong><a href="development/../../docs/config-compatibility.html">Configuration Backward Compatibility Strategy</a></strong></p>
<hr />
<h2 id="api-design"><a class="header" href="#api-design">API Design</a></h2>
<p>For detailed public API design (Phase 2+), see:</p>
<ul>
<li><strong><a href="development/../../docs/api-design.html">API Design Document</a></strong> - Complete API specification (AMI-123)</li>
<li><strong><a href="development/../../docs/config-compatibility.html">Configuration Compatibility</a></strong> - Backward compatibility strategy (AMI-125)</li>
<li><strong><a href="development/../../.research/implementation-viewpoint-1.html">Implementation Viewpoint 1</a></strong> - Monorepo with Tauri</li>
<li><strong><a href="development/../../.research/implementation-viewpoint-2.html">Implementation Viewpoint 2</a></strong> - Alternative approach</li>
</ul>
<h2 id="related-documentation"><a class="header" href="#related-documentation">Related Documentation</a></h2>
<ul>
<li><a href="development/../configuration/overview.html">Configuration Overview</a></li>
<li><a href="development/../configuration/device-profiles.html">Device Profiles</a></li>
<li><a href="development/../configuration/led-feedback.html">LED Feedback System</a></li>
<li><a href="development/contributing.html">Contributing Guide</a></li>
<li><a href="development/testing.html">Testing Strategy</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributing-guide"><a class="header" href="#contributing-guide">Contributing Guide</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-13"><a class="header" href="#coming-soon-13">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="development/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="testing-guide"><a class="header" href="#testing-guide">Testing Guide</a></h1>
<p>This guide covers testing strategies for MIDIMon, including hardware-independent testing using the MIDI device simulator.</p>
<h2 id="table-of-contents-1"><a class="header" href="#table-of-contents-1">Table of Contents</a></h2>
<ul>
<li><a href="development/testing.html#midi-device-simulator">MIDI Device Simulator</a></li>
<li><a href="development/testing.html#running-tests">Running Tests</a></li>
<li><a href="development/testing.html#end-to-end-test-suite">End-to-End Test Suite</a></li>
<li><a href="development/testing.html#code-coverage">Code Coverage</a></li>
<li><a href="development/testing.html#test-reporting">Test Reporting</a></li>
<li><a href="development/testing.html#writing-tests">Writing Tests</a></li>
<li><a href="development/testing.html#interactive-cli-tool">Interactive CLI Tool</a></li>
<li><a href="development/testing.html#test-scenarios">Test Scenarios</a></li>
</ul>
<h2 id="midi-device-simulator"><a class="header" href="#midi-device-simulator">MIDI Device Simulator</a></h2>
<p>The MIDI device simulator allows comprehensive testing of MIDIMon without requiring physical hardware. It simulates all MIDI events and complex user interactions with precise timing control.</p>
<h3 id="features"><a class="header" href="#features">Features</a></h3>
<p>The simulator supports:</p>
<ul>
<li><strong>Basic MIDI Events</strong>: Note On/Off, Control Change, Aftertouch, Pitch Bend, Program Change</li>
<li><strong>Velocity Levels</strong>: Soft (0-40), Medium (41-80), Hard (81-127)</li>
<li><strong>Timing-Based Triggers</strong>: Long press, double-tap detection</li>
<li><strong>Complex Gestures</strong>: Chords, encoder rotation, velocity ramps</li>
<li><strong>Precise Timing</strong>: Configurable delays and durations</li>
<li><strong>Event Capture</strong>: Inspect all generated MIDI messages</li>
</ul>
<h3 id="quick-start-2"><a class="header" href="#quick-start-2">Quick Start</a></h3>
<pre><code class="language-rust">use midi_simulator::{MidiSimulator, Gesture, EncoderDirection};

// Create a simulator on MIDI channel 0
let sim = MidiSimulator::new(0);

// Simulate a simple note press
sim.note_on(60, 100);
sim.note_off(60);

// Get captured events
let events = sim.get_events();
assert_eq!(events.len(), 2); // Note on + Note off</code></pre>
<h2 id="running-tests"><a class="header" href="#running-tests">Running Tests</a></h2>
<h3 id="unit-tests"><a class="header" href="#unit-tests">Unit Tests</a></h3>
<p>Run the simulator's built-in unit tests:</p>
<pre><code class="language-bash">cargo test --test midi_simulator
</code></pre>
<p>Expected output:</p>
<pre><code>running 12 tests
test tests::test_note_on_off ... ok
test tests::test_velocity_levels ... ok
test tests::test_control_change ... ok
test tests::test_aftertouch ... ok
test tests::test_pitch_bend ... ok
test tests::test_program_change ... ok
test tests::test_simple_tap_gesture ... ok
test tests::test_chord_gesture ... ok
test tests::test_encoder_simulation ... ok
test tests::test_velocity_ramp_gesture ... ok
test tests::test_scenario_builder ... ok
test tests::test_channel_masking ... ok

test result: ok. 12 passed; 0 failed
</code></pre>
<h3 id="integration-tests-1"><a class="header" href="#integration-tests-1">Integration Tests</a></h3>
<p>Run integration tests that verify the complete event processing pipeline:</p>
<pre><code class="language-bash">cargo test --test integration_tests
</code></pre>
<p>These tests cover:</p>
<ul>
<li>Basic note event handling</li>
<li>Velocity level detection</li>
<li>Long press simulation with timing validation</li>
<li>Double-tap detection</li>
<li>Chord detection with multiple notes</li>
<li>Encoder direction detection (CW/CCW)</li>
<li>Aftertouch and pitch bend</li>
<li>Complex multi-event scenarios</li>
</ul>
<h3 id="all-tests"><a class="header" href="#all-tests">All Tests</a></h3>
<p>Run all tests including unit and integration:</p>
<pre><code class="language-bash">cargo test
</code></pre>
<h3 id="using-nextest-recommended"><a class="header" href="#using-nextest-recommended">Using Nextest (Recommended)</a></h3>
<p>For improved test output and parallel execution, use cargo-nextest:</p>
<pre><code class="language-bash"># Install nextest
cargo install cargo-nextest

# Run tests with nextest
cargo nextest run --all-features

# Or use the convenience script
./scripts/test-nextest.sh
</code></pre>
<p>Nextest provides:</p>
<ul>
<li>Faster test execution through parallelization</li>
<li>Better output formatting with progress indicators</li>
<li>More detailed failure reporting</li>
<li>Per-test timing information</li>
</ul>
<h2 id="end-to-end-test-suite"><a class="header" href="#end-to-end-test-suite">End-to-End Test Suite</a></h2>
<p>The E2E test suite (<code>tests/e2e_tests.rs</code>) provides comprehensive validation of the complete MIDIMon pipeline from MIDI input through event processing, mapping, and action execution. See <a href="development/testing.html#integration-test-suites">Integration Test Suites</a> section below for full documentation of all E2E workflows, test architecture, and writing E2E tests.</p>
<h3 id="quick-start-3"><a class="header" href="#quick-start-3">Quick Start</a></h3>
<pre><code class="language-bash"># Run all E2E tests (20+ workflow tests)
cargo test --test e2e_tests

# Expected: 37 tests passed covering all critical workflows
</code></pre>
<h2 id="code-coverage"><a class="header" href="#code-coverage">Code Coverage</a></h2>
<p>MIDIMon uses <code>cargo-llvm-cov</code> for code coverage tracking. The project maintains a minimum coverage threshold of 0.35% (baseline) with a Phase 1 target of 85%.</p>
<h3 id="installing-coverage-tools"><a class="header" href="#installing-coverage-tools">Installing Coverage Tools</a></h3>
<pre><code class="language-bash"># Install cargo-llvm-cov
cargo install cargo-llvm-cov
</code></pre>
<h3 id="generating-coverage-reports"><a class="header" href="#generating-coverage-reports">Generating Coverage Reports</a></h3>
<h4 id="terminal-summary-default"><a class="header" href="#terminal-summary-default">Terminal Summary (Default)</a></h4>
<p>Generate a coverage summary in the terminal:</p>
<pre><code class="language-bash"># Using cargo-llvm-cov directly
cargo llvm-cov --all-features --workspace

# Or use the convenience script
./scripts/coverage.sh

# Or use just command
just coverage
</code></pre>
<p>Output example:</p>
<pre><code>Filename                      Regions    Missed Regions     Cover   Functions  Missed Functions  Executed       Lines      Missed Lines     Cover
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
actions.rs                        212               212     0.00%          12                12     0.00%         134               134     0.00%
config.rs                          52                42    19.23%           3                 2    33.33%          52                47     9.62%
main.rs                           278               278     0.00%          13                13     0.00%         151               151     0.00%
mappings.rs                        96                96     0.00%           8                 8     0.00%          71                71     0.00%
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
TOTAL                            2263              2253     0.44%          66                65     1.52%        1413              1408     0.35%
</code></pre>
<h4 id="html-report"><a class="header" href="#html-report">HTML Report</a></h4>
<p>Generate an interactive HTML coverage report:</p>
<pre><code class="language-bash"># Generate HTML report
./scripts/coverage.sh --html

# Or use just command
just coverage-html

# Report saved to: target/llvm-cov/html/index.html
</code></pre>
<h4 id="html-report-with-auto-open"><a class="header" href="#html-report-with-auto-open">HTML Report with Auto-Open</a></h4>
<p>Generate and automatically open the coverage report in your browser:</p>
<pre><code class="language-bash"># Generate and open HTML report
./scripts/coverage.sh --open

# Or use just command
just coverage-open
</code></pre>
<h4 id="lcov-format-for-ci"><a class="header" href="#lcov-format-for-ci">LCOV Format (for CI)</a></h4>
<p>Generate coverage in LCOV format for Codecov or other CI tools:</p>
<pre><code class="language-bash"># Generate lcov.info
./scripts/coverage.sh --lcov

# Or use just command
just coverage-lcov

# Output: lcov.info
</code></pre>
<h3 id="coverage-configuration"><a class="header" href="#coverage-configuration">Coverage Configuration</a></h3>
<p>Coverage settings are configured in <code>.llvm-cov.toml</code>:</p>
<pre><code class="language-toml">[report]
# Fail if coverage is below this percentage
fail-under-lines = 0.35

[filter]
# Exclude test files and binaries from coverage
exclude-filename-regex = [
    ".*/tests/.*",
    ".*/bin/.*"
]
</code></pre>
<h3 id="coverage-targets"><a class="header" href="#coverage-targets">Coverage Targets</a></h3>
<ul>
<li><strong>Phase 0 Baseline</strong>: 0.35% (established)</li>
<li><strong>Phase 1 Target</strong>: 85% line coverage</li>
<li><strong>Minimum Threshold</strong>: 80% (enforced in CI)</li>
</ul>
<h3 id="coverage-in-cicd"><a class="header" href="#coverage-in-cicd">Coverage in CI/CD</a></h3>
<p>Coverage is automatically tracked on every pull request:</p>
<ol>
<li><strong>GitHub Actions</strong> runs coverage on all PRs</li>
<li><strong>Codecov</strong> receives coverage reports and provides:
<ul>
<li>Coverage percentage badge</li>
<li>Line-by-line coverage visualization</li>
<li>Coverage diffs on PRs</li>
<li>Historical coverage trends</li>
</ul>
</li>
<li><strong>PR Comments</strong> show coverage delta (increase/decrease)</li>
<li><strong>Status Checks</strong> fail if coverage drops below threshold</li>
</ol>
<p>View current coverage: <a href="https://codecov.io/gh/amiable-dev/midimon"><img src="https://codecov.io/gh/amiable-dev/midimon/branch/main/graph/badge.svg" alt="codecov" /></a></p>
<h3 id="local-coverage-workflow"><a class="header" href="#local-coverage-workflow">Local Coverage Workflow</a></h3>
<p>Recommended workflow for maintaining coverage:</p>
<pre><code class="language-bash"># 1. Write tests for new code
vim tests/my_feature_test.rs

# 2. Run tests to verify they pass
cargo nextest run

# 3. Generate coverage report
just coverage-open

# 4. Identify uncovered lines (shown in red in HTML report)

# 5. Add tests for uncovered code paths

# 6. Verify coverage improved
just coverage
</code></pre>
<h2 id="test-reporting"><a class="header" href="#test-reporting">Test Reporting</a></h2>
<h3 id="github-actions-integration"><a class="header" href="#github-actions-integration">GitHub Actions Integration</a></h3>
<p>All tests run automatically on:</p>
<ul>
<li><strong>Push to main/develop branches</strong></li>
<li><strong>Pull requests</strong></li>
<li><strong>Manual workflow dispatch</strong></li>
</ul>
<p>Test results are displayed in the GitHub Actions UI with:</p>
<ul>
<li>Test count (passed/failed/skipped)</li>
<li>Execution time</li>
<li>Detailed failure logs</li>
<li>Coverage percentage</li>
</ul>
<h3 id="nextest-reports"><a class="header" href="#nextest-reports">Nextest Reports</a></h3>
<p>Nextest provides enhanced test reporting:</p>
<pre><code class="language-bash"># Run with detailed output
cargo nextest run --verbose

# Generate JUnit XML report
cargo nextest run --junit junit.xml

# Show only failed tests
cargo nextest run --failure-output immediate
</code></pre>
<h3 id="coverage-reports-in-prs"><a class="header" href="#coverage-reports-in-prs">Coverage Reports in PRs</a></h3>
<p>When you create a pull request, Codecov automatically:</p>
<ol>
<li>Analyzes coverage for changed files</li>
<li>Posts a comment with coverage diff</li>
<li>Updates status checks</li>
<li>Shows coverage on changed lines</li>
</ol>
<p>Example PR comment:</p>
<pre><code>Coverage: 85.2% (+2.1%) vs main

Files changed coverage:
  - src/new_feature.rs: 92.3% ✓
  - src/existing.rs: 78.1% ⚠️ (below target)
</code></pre>
<h3 id="local-test-scripts"><a class="header" href="#local-test-scripts">Local Test Scripts</a></h3>
<p>Use convenience scripts for common testing tasks:</p>
<pre><code class="language-bash"># Run all tests
./scripts/test.sh

# Run with nextest
./scripts/test-nextest.sh

# Generate coverage
./scripts/coverage.sh [--html|--open|--lcov]
</code></pre>
<h3 id="just-commands"><a class="header" href="#just-commands">Just Commands</a></h3>
<p>The <code>justfile</code> provides convenient shortcuts:</p>
<pre><code class="language-bash"># View all available commands
just

# Run tests
just test              # Standard cargo test
just test-nextest      # With nextest
just test-watch        # Watch mode (requires cargo-watch)

# Coverage
just coverage          # Terminal summary
just coverage-html     # HTML report
just coverage-open     # HTML report + open in browser
just coverage-lcov     # LCOV format for CI

# Linting and formatting
just lint              # Run clippy
just fmt               # Format code
just fmt-check         # Check formatting

# Complete CI check locally
just ci                # Run all CI checks (fmt, lint, test, coverage)
</code></pre>
<h2 id="writing-tests"><a class="header" href="#writing-tests">Writing Tests</a></h2>
<h3 id="basic-event-tests"><a class="header" href="#basic-event-tests">Basic Event Tests</a></h3>
<p>Test simple MIDI event generation:</p>
<pre><code class="language-rust">#[test]
fn test_my_feature() {
    let sim = MidiSimulator::new(0);

    // Simulate user action
    sim.note_on(60, 100);
    sim.note_off(60);

    // Verify events
    let events = sim.get_events();
    assert_eq!(events.len(), 2);
    assert_eq!(events[0], vec![0x90, 60, 100]); // Note On
    assert_eq!(events[1], vec![0x80, 60, 0x40]); // Note Off
}</code></pre>
<h3 id="velocity-level-tests"><a class="header" href="#velocity-level-tests">Velocity Level Tests</a></h3>
<p>Test velocity-sensitive actions:</p>
<pre><code class="language-rust">#[test]
fn test_velocity_levels() {
    let sim = MidiSimulator::new(0);

    // Test soft, medium, hard presses
    sim.note_on(60, 30);   // Soft (0-40)
    sim.note_on(60, 70);   // Medium (41-80)
    sim.note_on(60, 110);  // Hard (81-127)

    let events = sim.get_events();
    assert_eq!(events.len(), 3);
}</code></pre>
<h3 id="timing-based-tests"><a class="header" href="#timing-based-tests">Timing-Based Tests</a></h3>
<p>Test long press and timing detection:</p>
<pre><code class="language-rust">#[test]
fn test_long_press() {
    let sim = MidiSimulator::new(0);
    let start = Instant::now();

    sim.perform_gesture(Gesture::LongPress {
        note: 60,
        velocity: 80,
        hold_ms: 2500,
    });

    let duration = start.elapsed();
    assert!(duration &gt;= Duration::from_millis(2500));
}</code></pre>
<h3 id="double-tap-tests"><a class="header" href="#double-tap-tests">Double-Tap Tests</a></h3>
<p>Test double-tap detection with gap timing:</p>
<pre><code class="language-rust">#[test]
fn test_double_tap() {
    let sim = MidiSimulator::new(0);

    sim.perform_gesture(Gesture::DoubleTap {
        note: 60,
        velocity: 80,
        tap_duration_ms: 50,
        gap_ms: 200,
    });

    let events = sim.get_events();
    assert_eq!(events.len(), 4); // 2 note ons + 2 note offs
}</code></pre>
<h3 id="chord-tests"><a class="header" href="#chord-tests">Chord Tests</a></h3>
<p>Test chord detection with multiple simultaneous notes:</p>
<pre><code class="language-rust">#[test]
fn test_chord() {
    let sim = MidiSimulator::new(0);

    sim.perform_gesture(Gesture::Chord {
        notes: vec![60, 64, 67], // C major chord
        velocity: 80,
        stagger_ms: 10,
        hold_ms: 500,
    });

    let events = sim.get_events();
    assert_eq!(events.len(), 6); // 3 note ons + 3 note offs
}</code></pre>
<h3 id="encoder-tests"><a class="header" href="#encoder-tests">Encoder Tests</a></h3>
<p>Test encoder rotation with direction detection:</p>
<pre><code class="language-rust">#[test]
fn test_encoder() {
    let sim = MidiSimulator::new(0);

    sim.perform_gesture(Gesture::EncoderTurn {
        cc: 1,
        direction: EncoderDirection::Clockwise,
        steps: 5,
        step_delay_ms: 0,
    });

    let events = sim.get_events();
    assert_eq!(events.len(), 5);

    // Verify values are increasing
    for i in 1..events.len() {
        assert!(events[i][2] &gt; events[i-1][2]);
    }
}</code></pre>
<h3 id="scenario-builder"><a class="header" href="#scenario-builder">Scenario Builder</a></h3>
<p>Create complex test scenarios with the builder pattern:</p>
<pre><code class="language-rust">use midi_simulator::ScenarioBuilder;

#[test]
fn test_complex_scenario() {
    let sim = MidiSimulator::new(0);

    let scenario = ScenarioBuilder::new()
        .note_on(60, 100)
        .wait(100)
        .control_change(1, 64)
        .wait(100)
        .aftertouch(80)
        .wait(100)
        .note_off(60)
        .build();

    sim.execute_sequence(scenario);

    let events = sim.get_events();
    assert_eq!(events.len(), 4);
}</code></pre>
<h2 id="interactive-cli-tool"><a class="header" href="#interactive-cli-tool">Interactive CLI Tool</a></h2>
<p>The simulator includes an interactive command-line interface for manual testing and experimentation.</p>
<h3 id="starting-the-cli"><a class="header" href="#starting-the-cli">Starting the CLI</a></h3>
<pre><code class="language-bash">cargo run --bin midi_simulator
</code></pre>
<h3 id="available-commands"><a class="header" href="#available-commands">Available Commands</a></h3>
<pre><code>╭─────────────────────────────────────────────────────────────╮
│ COMMANDS                                                    │
├─────────────────────────────────────────────────────────────┤
│ Basic:                                                      │
│   help, h, ?              Show help message                 │
│   quit, exit, q           Exit the simulator                │
│   clear, c                Clear event queue                 │
│   events, e               Show captured events              │
├─────────────────────────────────────────────────────────────┤
│ MIDI Events:                                                │
│   note &lt;num&gt; &lt;vel&gt;        Send note on/off                  │
│   velocity &lt;note&gt;         Test velocity levels              │
│   long &lt;note&gt; [ms]        Simulate long press               │
│   double &lt;note&gt; [gap_ms]  Simulate double-tap               │
│   chord &lt;n1&gt; &lt;n2&gt; ...     Simulate chord                    │
│   encoder &lt;cc&gt; &lt;cw|ccw&gt;   Simulate encoder rotation         │
│   aftertouch &lt;pressure&gt;   Send aftertouch                   │
│   pitch &lt;value&gt;           Send pitch bend (0-16383)         │
│   cc &lt;num&gt; &lt;val&gt;          Send control change               │
├─────────────────────────────────────────────────────────────┤
│ Scenarios:                                                  │
│   demo                    Run full demonstration            │
│   scenario [name]         Run specific test scenario        │
╰─────────────────────────────────────────────────────────────╯
</code></pre>
<h3 id="example-session"><a class="header" href="#example-session">Example Session</a></h3>
<pre><code class="language-bash"># Start the CLI
cargo run --bin midi_simulator

# Test velocity levels
&gt; velocity 60
Simulating velocity levels (soft, medium, hard)...
✓ Velocity test complete

# Test long press
&gt; long 60 2500
Simulating long press for 2500ms...
✓ Long press complete

# Test double-tap
&gt; double 60 200
Simulating double-tap with 200ms gap...
✓ Double-tap complete

# Test chord (C major)
&gt; chord 60 64 67
Simulating chord: [60, 64, 67]
✓ Chord complete

# Test encoder rotation
&gt; encoder 1 cw 5
Simulating encoder CC1 Clockwise 5 steps...
✓ Encoder simulation complete

# Show captured events
&gt; events
Captured events:
  1: [90, 60, 64, ...]
  2: [80, 60, 40, ...]
  ...

# Run full demo
&gt; demo
Running demonstration scenarios...
1. Testing velocity levels...
2. Testing long press...
3. Testing double-tap...
4. Testing chord...
5. Testing encoder...
✓ Demo complete

# Exit
&gt; quit
Goodbye!
</code></pre>
<h2 id="test-scenarios"><a class="header" href="#test-scenarios">Test Scenarios</a></h2>
<p>The simulator includes pre-built test scenarios for common testing needs.</p>
<h3 id="velocity-scenario"><a class="header" href="#velocity-scenario">Velocity Scenario</a></h3>
<p>Tests all three velocity levels:</p>
<pre><code class="language-bash">&gt; scenario velocity
Testing velocity levels: Soft (30), Medium (70), Hard (110)
✓ Velocity scenario complete
</code></pre>
<h3 id="timing-scenario"><a class="header" href="#timing-scenario">Timing Scenario</a></h3>
<p>Tests short, medium, and long press durations:</p>
<pre><code class="language-bash">&gt; scenario timing
Testing press durations: Short (100ms), Medium (500ms), Long (2500ms)
✓ Timing scenario complete
</code></pre>
<h3 id="double-tap-scenario"><a class="header" href="#double-tap-scenario">Double-Tap Scenario</a></h3>
<p>Tests double-tap detection:</p>
<pre><code class="language-bash">&gt; scenario doubletap
Testing double-tap with 200ms gap
✓ Double-tap scenario complete
</code></pre>
<h3 id="chord-scenario"><a class="header" href="#chord-scenario">Chord Scenario</a></h3>
<p>Tests chord detection with C major:</p>
<pre><code class="language-bash">&gt; scenario chord
Testing chord detection: C major (60, 64, 67)
✓ Chord scenario complete
</code></pre>
<h3 id="encoder-scenario"><a class="header" href="#encoder-scenario">Encoder Scenario</a></h3>
<p>Tests encoder rotation in both directions:</p>
<pre><code class="language-bash">&gt; scenario encoder
Testing encoder: 5 steps CW, then 5 steps CCW
✓ Encoder scenario complete
</code></pre>
<h3 id="complex-scenario"><a class="header" href="#complex-scenario">Complex Scenario</a></h3>
<p>Tests mixed events and complex interactions:</p>
<pre><code class="language-bash">&gt; scenario complex
Running complex scenario: mixed events...
✓ Complex scenario complete
</code></pre>
<h2 id="advanced-gestures"><a class="header" href="#advanced-gestures">Advanced Gestures</a></h2>
<h3 id="velocity-ramp"><a class="header" href="#velocity-ramp">Velocity Ramp</a></h3>
<p>Simulate a velocity ramp from soft to hard:</p>
<pre><code class="language-rust">sim.perform_gesture(Gesture::VelocityRamp {
    note: 60,
    min_velocity: 20,
    max_velocity: 120,
    steps: 5,
});</code></pre>
<h3 id="simple-tap"><a class="header" href="#simple-tap">Simple Tap</a></h3>
<p>Simulate a quick tap with precise duration:</p>
<pre><code class="language-rust">sim.perform_gesture(Gesture::SimpleTap {
    note: 60,
    velocity: 80,
    duration_ms: 100,
});</code></pre>
<h2 id="event-inspection"><a class="header" href="#event-inspection">Event Inspection</a></h2>
<h3 id="getting-events"><a class="header" href="#getting-events">Getting Events</a></h3>
<pre><code class="language-rust">// Get all events and clear the queue
let events = sim.get_events();

// Peek at last event without clearing
let last = sim.peek_last_event();

// Clear the queue
sim.clear_events();</code></pre>
<h3 id="parsing-events"><a class="header" href="#parsing-events">Parsing Events</a></h3>
<pre><code class="language-rust">for event in events {
    let status = event[0];
    let message_type = status &amp; 0xF0;
    let channel = status &amp; 0x0F;

    match message_type {
        0x90 =&gt; println!("Note On: {} vel {}", event[1], event[2]),
        0x80 =&gt; println!("Note Off: {}", event[1]),
        0xB0 =&gt; println!("CC{}: {}", event[1], event[2]),
        0xD0 =&gt; println!("Aftertouch: {}", event[1]),
        0xE0 =&gt; println!("Pitch Bend: {} {}", event[1], event[2]),
        _ =&gt; println!("Unknown message type"),
    }
}</code></pre>
<h2 id="debug-output"><a class="header" href="#debug-output">Debug Output</a></h2>
<p>Enable debug output to see all MIDI messages:</p>
<pre><code class="language-rust">let mut sim = MidiSimulator::new(0);
sim.set_debug(true);

sim.note_on(60, 100);
// Output: [SIM] Sending: [90, 3C, 64]</code></pre>
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<ol>
<li><strong>Clear events between tests</strong>: Always clear the event queue between tests to avoid interference</li>
<li><strong>Use gestures for complex interactions</strong>: Prefer high-level gestures over manual event sequences</li>
<li><strong>Verify timing</strong>: Use <code>Instant::now()</code> to verify timing-sensitive operations</li>
<li><strong>Test edge cases</strong>: Test velocity boundaries (0, 40, 41, 80, 81, 127)</li>
<li><strong>Test multiple channels</strong>: Verify channel masking works correctly</li>
<li><strong>Use scenario builder</strong>: Build complex scenarios declaratively with the builder pattern</li>
</ol>
<h2 id="continuous-integration"><a class="header" href="#continuous-integration">Continuous Integration</a></h2>
<p>The simulator is designed to work in CI environments without hardware:</p>
<pre><code class="language-yaml"># .github/workflows/test.yml
name: Test

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rust-lang/setup-rust-toolchain@v1
      - name: Run tests
        run: cargo test --all-features
</code></pre>
<h2 id="troubleshooting-8"><a class="header" href="#troubleshooting-8">Troubleshooting</a></h2>
<h3 id="tests-timeout"><a class="header" href="#tests-timeout">Tests Timeout</a></h3>
<p>If timing-based tests timeout, increase tolerance:</p>
<pre><code class="language-rust">assert!(duration &gt;= Duration::from_millis(2500));
assert!(duration &lt; Duration::from_millis(2700)); // 200ms tolerance</code></pre>
<h3 id="event-count-mismatch"><a class="header" href="#event-count-mismatch">Event Count Mismatch</a></h3>
<p>Remember that <code>get_events()</code> clears the queue:</p>
<pre><code class="language-rust">let events1 = sim.get_events(); // Gets and clears
let events2 = sim.get_events(); // Empty, events were already consumed</code></pre>
<h3 id="velocity-detection"><a class="header" href="#velocity-detection">Velocity Detection</a></h3>
<p>Ensure velocities match expected ranges:</p>
<pre><code class="language-rust">// Soft: 0-40
// Medium: 41-80
// Hard: 81-127</code></pre>
<h2 id="integration-test-suites"><a class="header" href="#integration-test-suites">Integration Test Suites</a></h2>
<p>MIDIMon includes comprehensive integration test suites that verify complete feature sets without requiring physical hardware.</p>
<h3 id="event-processing-tests-ami-117"><a class="header" href="#event-processing-tests-ami-117">Event Processing Tests (AMI-117)</a></h3>
<p>Location: <code>tests/event_processing_tests.rs</code></p>
<p>Tests for aftertouch and pitch bend event processing:</p>
<p><strong>Aftertouch Tests (26 tests)</strong>:</p>
<ul>
<li>Full pressure range validation (0-127)</li>
<li>Continuous pressure variation</li>
<li>Boundary value testing (min/max)</li>
<li>Aftertouch with note press scenarios</li>
<li>Multi-channel aftertouch support</li>
</ul>
<p><strong>Pitch Bend Tests (26 tests)</strong>:</p>
<ul>
<li>Center position verification (8192)</li>
<li>Full 14-bit range testing (0-16383)</li>
<li>Positive and negative bend ranges</li>
<li>Smooth sweep simulations</li>
<li>Pitch bend with note combinations</li>
<li>Multi-channel pitch bend support</li>
</ul>
<pre><code class="language-bash"># Run event processing tests
cargo test --test event_processing_tests
</code></pre>
<h3 id="action-tests-ami-118"><a class="header" href="#action-tests-ami-118">Action Tests (AMI-118)</a></h3>
<p>Location: <code>tests/action_tests.rs</code></p>
<p>Tests for application launch and volume control actions:</p>
<p><strong>Launch Application Tests (14 tests)</strong>:</p>
<ul>
<li>Valid application path handling</li>
<li>Invalid path error handling</li>
<li>Paths with spaces</li>
<li>Process spawning verification</li>
<li>Permission denied scenarios</li>
<li>Concurrent process spawning</li>
<li>Platform-specific behavior detection</li>
</ul>
<p><strong>Volume Control Tests (14 tests)</strong>:</p>
<ul>
<li>Command detection (macOS, Linux, Windows)</li>
<li>Volume up/down command structure</li>
<li>Mute toggle command structure</li>
<li>Volume set command structure</li>
<li>Mock volume control execution</li>
<li>Shell command escaping</li>
</ul>
<pre><code class="language-bash"># Run action tests
cargo test --test action_tests
</code></pre>
<h3 id="action-orchestration-tests-ami-119"><a class="header" href="#action-orchestration-tests-ami-119">Action Orchestration Tests (AMI-119)</a></h3>
<p>Location: <code>tests/action_orchestration_tests.rs</code></p>
<p>Tests for complex action orchestration (38 tests):</p>
<p><strong>Sequence Actions (F16)</strong>:</p>
<ul>
<li>Action ordering verification</li>
<li>Empty sequence handling</li>
<li>Single action sequences</li>
<li>Sequences with delays</li>
<li>Error propagation in sequences</li>
</ul>
<p><strong>Delay Actions (F17)</strong>:</p>
<ul>
<li>Timing accuracy (50ms, 100ms, 500ms)</li>
<li>Zero delay handling</li>
<li>Multiple sequential delays</li>
<li>Timing precision validation (±10ms tolerance)</li>
</ul>
<p><strong>MouseClick Actions (F18)</strong>:</p>
<ul>
<li>Click simulation structure</li>
<li>Coordinate validation</li>
<li>Button type validation (left, right, middle)</li>
<li>Click sequences with delays</li>
</ul>
<p><strong>Repeat Actions (F19)</strong>:</p>
<ul>
<li>Repeat count verification</li>
<li>Repeat with delays</li>
<li>Zero and single repetitions</li>
<li>High-volume repeat handling (100+ iterations)</li>
</ul>
<p><strong>Conditional Actions (F20)</strong>:</p>
<ul>
<li>Application-based conditions</li>
<li>Time-based conditions (hour ranges)</li>
<li>Modifier key conditions</li>
<li>Mode-based conditions</li>
<li>Multiple condition combinations (AND/OR logic)</li>
<li>Complex conditional expressions</li>
</ul>
<pre><code class="language-bash"># Run action orchestration tests
cargo test --test action_orchestration_tests
</code></pre>
<h3 id="end-to-end-tests-ami-120"><a class="header" href="#end-to-end-tests-ami-120">End-to-End Tests (AMI-120)</a></h3>
<p>Location: <code>tests/e2e_tests.rs</code></p>
<p>Comprehensive E2E testing of the complete MIDIMon pipeline (MIDI Input → Event Processing → Mapping → Action Execution):</p>
<p><strong>Critical Workflows (20 tests)</strong>:</p>
<ul>
<li>Simple pad press → keystroke</li>
<li>Velocity-sensitive mapping (soft/medium/hard)</li>
<li>Long press detection (≥1000ms threshold)</li>
<li>Double-tap recognition (&lt;300ms window)</li>
<li>Chord detection (&lt;50ms window)</li>
<li>Mode switching via encoder</li>
<li>Mode-specific vs global mappings</li>
<li>Action sequences with delays</li>
<li>Conditional actions (app/time/mode)</li>
<li>Volume control via encoder</li>
</ul>
<p><strong>Performance &amp; Edge Cases (5 tests)</strong>:</p>
<ul>
<li>Timing latency verification (&lt;1ms)</li>
<li>Rapid note events (20+ events)</li>
<li>Invalid note range handling (0, 1, 126, 127)</li>
<li>Throughput testing (200 events &lt;10ms)</li>
<li>Memory stability (1000 events)</li>
</ul>
<pre><code class="language-bash"># Run all E2E tests
cargo test --test e2e_tests

# Expected: 37 tests passed
</code></pre>
<h3 id="test-coverage-summary"><a class="header" href="#test-coverage-summary">Test Coverage Summary</a></h3>
<p>Total test count: <strong>183 tests</strong></p>
<p>Breakdown by suite:</p>
<ul>
<li><code>integration_tests.rs</code>: 29 tests (basic event processing)</li>
<li><code>event_processing_tests.rs</code>: 26 tests (aftertouch &amp; pitch bend)</li>
<li><code>action_tests.rs</code>: 14 tests (launch &amp; volume control)</li>
<li><code>action_orchestration_tests.rs</code>: 38 tests (sequences &amp; conditionals)</li>
<li><code>e2e_tests.rs</code>: 37 tests (end-to-end critical workflows) ← <strong>NEW</strong></li>
<li><code>config_compatibility_test.rs</code>: 15 tests (config validation)</li>
<li><code>midi_simulator.rs</code>: 12 tests (simulator validation)</li>
<li>Additional unit tests: 12 tests (various modules)</li>
</ul>
<h3 id="running-all-integration-tests"><a class="header" href="#running-all-integration-tests">Running All Integration Tests</a></h3>
<pre><code class="language-bash"># Run all integration tests
cargo test --test integration_tests \
           --test event_processing_tests \
           --test action_tests \
           --test action_orchestration_tests

# Run all tests with coverage
cargo test --all-features
</code></pre>
<h3 id="writing-new-integration-tests"><a class="header" href="#writing-new-integration-tests">Writing New Integration Tests</a></h3>
<p>When adding new integration tests:</p>
<ol>
<li><strong>Use the MIDI simulator</strong> for all MIDI event generation</li>
<li><strong>Test edge cases</strong> (boundary values, timing variations)</li>
<li><strong>Include negative tests</strong> (error conditions, invalid inputs)</li>
<li><strong>Verify timing</strong> with tolerance (±10-35ms for CI stability)</li>
<li><strong>Document test purpose</strong> with clear comments</li>
<li><strong>Group related tests</strong> into logical test modules</li>
</ol>
<p>Example template:</p>
<pre><code class="language-rust">#[test]
fn test_feature_name() {
    let sim = MidiSimulator::new(0);

    // Setup: Generate test events
    sim.note_on(60, 80);

    // Execute: Perform action
    let events = sim.get_events();

    // Verify: Check results
    assert_eq!(events.len(), 1);
    assert_eq!(events[0][0] &amp; 0xF0, 0x90); // Note On
}</code></pre>
<h3 id="cicd-integration"><a class="header" href="#cicd-integration">CI/CD Integration</a></h3>
<p>All integration tests run automatically in GitHub Actions:</p>
<ul>
<li><strong>No hardware required</strong>: Uses MIDI simulator</li>
<li><strong>Fast execution</strong>: &lt;5 seconds total for all tests</li>
<li><strong>Timing tolerance</strong>: Increased for CI environments (±35ms)</li>
<li><strong>Platform coverage</strong>: Tests run on macOS, Linux, Windows</li>
</ul>
<h2 id="related-documentation-1"><a class="header" href="#related-documentation-1">Related Documentation</a></h2>
<ul>
<li><a href="development/../architecture/event-processing.html">Event Processing Architecture</a></li>
<li><a href="development/../reference/midi-events.html">MIDI Event Types</a></li>
<li><a href="development/../reference/actions.html">Action System</a></li>
<li><a href="development/../contributing.html">Contributing Guide</a></li>
</ul>
<h2 id="examples-1"><a class="header" href="#examples-1">Examples</a></h2>
<p>See the integration tests in <code>tests/integration_tests.rs</code> for complete examples of:</p>
<ul>
<li>Velocity detection tests</li>
<li>Long press simulation</li>
<li>Double-tap detection</li>
<li>Chord detection</li>
<li>Encoder simulation</li>
<li>Complex multi-event scenarios</li>
</ul>
<p>Additional examples in specialized test suites:</p>
<ul>
<li><code>tests/event_processing_tests.rs</code>: Aftertouch and pitch bend</li>
<li><code>tests/action_tests.rs</code>: Application launch and volume control</li>
<li><code>tests/action_orchestration_tests.rs</code>: Action sequences and conditionals</li>
</ul>
<h2 id="support"><a class="header" href="#support">Support</a></h2>
<p>For questions or issues with testing:</p>
<ul>
<li>Check existing integration tests for examples</li>
<li>Use the interactive CLI tool to experiment</li>
<li>Review the simulator source code in <code>tests/midi_simulator.rs</code></li>
<li>Open an issue on GitHub with test failure details</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="release-process"><a class="header" href="#release-process">Release Process</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-14"><a class="header" href="#coming-soon-14">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="development/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="common-issues-and-solutions"><a class="header" href="#common-issues-and-solutions">Common Issues and Solutions</a></h1>
<h2 id="overview-5"><a class="header" href="#overview-5">Overview</a></h2>
<p>This guide covers the most frequently encountered issues when using MIDIMon, along with step-by-step solutions. For detailed diagnostic procedures, see <a href="troubleshooting/diagnostics.html">Diagnostics Guide</a>.</p>
<h2 id="midi-device-not-found"><a class="header" href="#midi-device-not-found">MIDI Device Not Found</a></h2>
<h3 id="symptoms"><a class="header" href="#symptoms">Symptoms</a></h3>
<pre><code>Error: No MIDI input ports available
</code></pre>
<p>Or:</p>
<pre><code>Available MIDI input ports:
0: IAC Driver Bus 1
# Your device is missing from the list
</code></pre>
<h3 id="causes"><a class="header" href="#causes">Causes</a></h3>
<ul>
<li>USB cable not connected</li>
<li>Device not powered on</li>
<li>MIDI driver not installed (macOS/Windows)</li>
<li>Device in wrong mode (some controllers have multiple modes)</li>
<li>MIDI port disabled in system settings</li>
</ul>
<h3 id="solutions"><a class="header" href="#solutions">Solutions</a></h3>
<h4 id="1-check-physical-connection"><a class="header" href="#1-check-physical-connection">1. Check Physical Connection</a></h4>
<pre><code class="language-bash"># macOS: Check USB device enumeration
system_profiler SPUSBDataType | grep -i mikro
# or
system_profiler SPUSBDataType | grep -i midi

# Expected output:
# Maschine Mikro MK3:
#   Product ID: 0x1600
#   Vendor ID: 0x17cc (Native Instruments)
</code></pre>
<p><strong>If device not found</strong>:</p>
<ul>
<li>Try a different USB port</li>
<li>Try a different USB cable</li>
<li>Power cycle the device (unplug, wait 10 seconds, replug)</li>
<li>Check device is powered on (some controllers have power switches)</li>
</ul>
<h4 id="2-verify-midi-setup-macos"><a class="header" href="#2-verify-midi-setup-macos">2. Verify MIDI Setup (macOS)</a></h4>
<pre><code class="language-bash"># Open Audio MIDI Setup
open -a "Audio MIDI Setup"
</code></pre>
<p>In the <strong>MIDI Studio</strong> window (Window → Show MIDI Studio):</p>
<ul>
<li>Verify your device appears</li>
<li>Check it's not grayed out (indicates active connection)</li>
<li>If grayed out, right-click and select "Enable"</li>
</ul>
<p><strong>Reset MIDI configuration</strong> (if corrupted):</p>
<pre><code class="language-bash"># Quit Audio MIDI Setup first
rm ~/Library/Preferences/com.apple.audio.AudioMIDISetup.plist
rm ~/Library/Preferences/ByHost/com.apple.audio.AudioMIDISetup.*
# Reopen Audio MIDI Setup
</code></pre>
<h4 id="3-installreinstall-drivers"><a class="header" href="#3-installreinstall-drivers">3. Install/Reinstall Drivers</a></h4>
<p><strong>macOS/Windows</strong>:</p>
<ol>
<li>Download <a href="https://www.native-instruments.com/en/support/downloads/">Native Access</a></li>
<li>Sign in (free account)</li>
<li>Install drivers for your device</li>
<li>Restart computer after installation</li>
<li>Reconnect device</li>
</ol>
<p><strong>Linux</strong>:</p>
<ul>
<li>Most MIDI controllers work with built-in ALSA drivers</li>
<li>Install <code>alsa-utils</code>: <code>sudo apt install alsa-utils</code></li>
<li>List devices: <code>aconnect -l</code></li>
</ul>
<h4 id="4-test-with-system-tools"><a class="header" href="#4-test-with-system-tools">4. Test with System Tools</a></h4>
<p><strong>macOS</strong>:</p>
<pre><code class="language-bash"># List MIDI devices using system_profiler
system_profiler SPUSBDataType | grep -B 10 -A 10 MIDI

# Test with midimon diagnostic
cargo run --bin test_midi
</code></pre>
<p><strong>Linux</strong>:</p>
<pre><code class="language-bash"># List ALSA MIDI devices
aconnect -l

# Test with amidi
amidi -l
</code></pre>
<h4 id="5-check-port-numbers"><a class="header" href="#5-check-port-numbers">5. Check Port Numbers</a></h4>
<pre><code class="language-bash"># List all available ports
cargo run --release

# Try each port number
cargo run --bin midi_diagnostic 0
cargo run --bin midi_diagnostic 1
cargo run --bin midi_diagnostic 2
# ... press a pad/key on your controller to verify connection
</code></pre>
<h3 id="still-not-working"><a class="header" href="#still-not-working">Still Not Working?</a></h3>
<ol>
<li>Try a different computer (to rule out hardware failure)</li>
<li>Test with manufacturer's software (e.g., NI Controller Editor)</li>
<li>Check for firmware updates</li>
<li>Contact manufacturer support</li>
</ol>
<h2 id="leds-not-working-1"><a class="header" href="#leds-not-working-1">LEDs Not Working</a></h2>
<h3 id="symptoms-1"><a class="header" href="#symptoms-1">Symptoms</a></h3>
<ul>
<li>Pads press correctly but LEDs don't light up</li>
<li>LEDs flash once then go dark</li>
<li>Wrong pads lighting up</li>
<li>LEDs stuck on or flickering</li>
</ul>
<h3 id="causes-1"><a class="header" href="#causes-1">Causes</a></h3>
<ul>
<li>Input Monitoring permission not granted (macOS)</li>
<li>HID driver not installed</li>
<li>Profile/coordinate mapping issues</li>
<li>HID device already in use by another application</li>
<li>Incorrect LED scheme selected</li>
</ul>
<h3 id="solutions-1"><a class="header" href="#solutions-1">Solutions</a></h3>
<h4 id="1-grant-input-monitoring-permission-macos"><a class="header" href="#1-grant-input-monitoring-permission-macos">1. Grant Input Monitoring Permission (macOS)</a></h4>
<p><strong>Step-by-step</strong>:</p>
<ol>
<li>
<p>Run MIDIMon:</p>
<pre><code class="language-bash">cargo run --release 2
</code></pre>
</li>
<li>
<p>macOS will show a permission dialog</p>
</li>
<li>
<p>Click <strong>Open System Settings</strong></p>
</li>
<li>
<p>In <strong>Privacy &amp; Security</strong> → <strong>Input Monitoring</strong>:</p>
<ul>
<li>Find <code>midimon</code> or <code>Terminal</code> (if running via cargo)</li>
<li>Toggle switch to <strong>ON</strong></li>
<li>If switch is already ON, toggle OFF then ON again</li>
</ul>
</li>
<li>
<p>Restart MIDIMon:</p>
<pre><code class="language-bash">cargo run --release 2
</code></pre>
</li>
</ol>
<p><strong>Verify permission granted</strong>:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
<p>Look for:</p>
<pre><code>[DEBUG] HID device opened successfully
[DEBUG] LED controller initialized
</code></pre>
<p>If you see "Failed to open HID device", permission is not granted.</p>
<h4 id="2-test-led-hardware"><a class="header" href="#2-test-led-hardware">2. Test LED Hardware</a></h4>
<pre><code class="language-bash"># Run LED diagnostic tool
cargo run --bin led_diagnostic
</code></pre>
<p><strong>Expected output</strong>:</p>
<pre><code>✓ Device found: Maschine Mikro MK3
✓ HID device opened successfully
✓ Testing LED control...
✓ LED diagnostic complete
</code></pre>
<p><strong>Error output</strong>:</p>
<pre><code>✗ Failed to open HID device
</code></pre>
<p>If this fails, see <a href="troubleshooting/diagnostics.html">Diagnostics Guide</a> for HID troubleshooting.</p>
<h4 id="3-installverify-native-instruments-drivers"><a class="header" href="#3-installverify-native-instruments-drivers">3. Install/Verify Native Instruments Drivers</a></h4>
<p><strong>macOS/Windows</strong>:</p>
<ol>
<li>Open Native Access</li>
<li>Verify "Maschine" or controller-specific software is installed</li>
<li>Check for updates</li>
<li>Reinstall if necessary</li>
<li>Restart computer</li>
</ol>
<p><strong>Test after driver installation</strong>:</p>
<pre><code class="language-bash">cargo run --bin led_diagnostic
</code></pre>
<h4 id="4-try-different-led-schemes"><a class="header" href="#4-try-different-led-schemes">4. Try Different LED Schemes</a></h4>
<p>Some schemes might not work due to profile issues:</p>
<pre><code class="language-bash"># Try rainbow (doesn't require note mapping)
cargo run --release 2 --led rainbow

# Try static
cargo run --release 2 --led static

# Try reactive (default)
cargo run --release 2 --led reactive
</code></pre>
<p>If rainbow/static work but reactive doesn't, it's a profile/mapping issue.</p>
<h4 id="5-fix-coordinate-mapping-issues"><a class="header" href="#5-fix-coordinate-mapping-issues">5. Fix Coordinate Mapping Issues</a></h4>
<p><strong>Wrong pads lighting up</strong> indicates coordinate mapping problems.</p>
<p><strong>Solution</strong>: Use a device profile:</p>
<pre><code class="language-bash"># Auto-detect page
cargo run --release 2 --profile path/to/profile.ncmm3

# Force specific page
cargo run --release 2 --profile profile.ncmm3 --pad-page A
</code></pre>
<p>Create a profile using Native Instruments Controller Editor if you don't have one.</p>
<p>See <a href="troubleshooting/../DEVICE_PROFILES.html">Device Profiles Documentation</a> for complete guide.</p>
<h4 id="6-check-shared-device-access"><a class="header" href="#6-check-shared-device-access">6. Check Shared Device Access</a></h4>
<p>If Controller Editor is running simultaneously:</p>
<p><strong>macOS</strong>: MIDIMon uses shared device access (should work)</p>
<p><strong>Verify</strong>:</p>
<pre><code class="language-bash"># Check Cargo.toml includes:
hidapi = { version = "2.4", features = ["macos-shared-device"] }
</code></pre>
<p>If LEDs work when Controller Editor is closed but not when it's running:</p>
<ul>
<li>Update to latest MIDIMon version</li>
<li>Rebuild from source: <code>cargo build --release</code></li>
</ul>
<h3 id="advanced-debugging"><a class="header" href="#advanced-debugging">Advanced Debugging</a></h3>
<p>Enable debug logging and watch for LED updates:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2 --led reactive
</code></pre>
<p>Press pads and look for:</p>
<pre><code>[DEBUG] LED update: pad 0 -&gt; color 7 (Green) brightness 2
[DEBUG] HID write: 81 bytes
</code></pre>
<p>If you see LED updates logged but LEDs don't light:</p>
<ul>
<li>Hardware issue (try different USB port)</li>
<li>Firmware issue (update device firmware)</li>
<li>Driver issue (reinstall NI drivers)</li>
</ul>
<h2 id="events-not-triggering-1"><a class="header" href="#events-not-triggering-1">Events Not Triggering</a></h2>
<h3 id="symptoms-2"><a class="header" href="#symptoms-2">Symptoms</a></h3>
<ul>
<li>Pads press but no actions execute</li>
<li>Some pads work, others don't</li>
<li>LEDs work but actions don't fire</li>
<li>Actions trigger randomly or inconsistently</li>
</ul>
<h3 id="causes-2"><a class="header" href="#causes-2">Causes</a></h3>
<ul>
<li>Note numbers don't match config.toml</li>
<li>Wrong mode active</li>
<li>Trigger conditions not met (velocity, timing)</li>
<li>Config syntax errors</li>
<li>Event processing disabled</li>
</ul>
<h3 id="solutions-2"><a class="header" href="#solutions-2">Solutions</a></h3>
<h4 id="1-verify-note-numbers"><a class="header" href="#1-verify-note-numbers">1. Verify Note Numbers</a></h4>
<pre><code class="language-bash"># Find actual note numbers
cargo run --bin pad_mapper 2
</code></pre>
<p>Press each pad and write down the note numbers.</p>
<p><strong>Compare with config.toml</strong>:</p>
<pre><code class="language-toml">[[modes.mappings]]
[modes.mappings.trigger]
type = "Note"
note = 12  # Must match the actual note number from pad_mapper
</code></pre>
<p>If they don't match, update config.toml with correct note numbers.</p>
<h4 id="2-check-active-mode"><a class="header" href="#2-check-active-mode">2. Check Active Mode</a></h4>
<p>MIDIMon prints the current mode to console:</p>
<pre><code>Mode changed: Default -&gt; Developer
Currently in mode: Developer
</code></pre>
<p><strong>Verify you're in the expected mode</strong>:</p>
<ul>
<li>Check encoder hasn't switched modes accidentally</li>
<li>Verify mode-specific mappings are in the correct mode section</li>
<li>Try using global mappings for testing</li>
</ul>
<p><strong>Force to Default mode</strong>:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Reset to default mode"
[global_mappings.trigger]
type = "Note"
note = 0
[global_mappings.action]
type = "ModeChange"
mode = "Default"
</code></pre>
<h4 id="3-test-with-simple-mapping"><a class="header" href="#3-test-with-simple-mapping">3. Test with Simple Mapping</a></h4>
<p>Add a simple test mapping to verify basic functionality:</p>
<pre><code class="language-toml">[[global_mappings]]
description = "Test mapping - Should print to console"
[global_mappings.trigger]
type = "Note"
note = 0  # Bottom-left pad
[global_mappings.action]
type = "Shell"
command = "echo 'Mapping works!' &amp;&amp; say 'Mapping works'"
</code></pre>
<p>If this works, the issue is with specific trigger/action configuration.</p>
<h4 id="4-enable-debug-logging"><a class="header" href="#4-enable-debug-logging">4. Enable Debug Logging</a></h4>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
<p>Press pads and watch for:</p>
<p><strong>Good output</strong> (mapping working):</p>
<pre><code>[MIDI] NoteOn ch:0 note:12 vel:87
[DEBUG] Processed: Note(12) with velocity Medium
[DEBUG] Matched mapping: "Copy text" (mode: Default)
[DEBUG] Executing action: Keystroke(keys: "c", modifiers: ["cmd"])
✓ Action executed successfully
</code></pre>
<p><strong>Bad output</strong> (no match):</p>
<pre><code>[MIDI] NoteOn ch:0 note:12 vel:87
[DEBUG] Processed: Note(12) with velocity Medium
[DEBUG] No mapping matched for event
</code></pre>
<p>If no mapping matched:</p>
<ul>
<li>Note number mismatch</li>
<li>Wrong mode</li>
<li>Trigger conditions not met</li>
</ul>
<h4 id="5-check-velocitytiming-requirements"><a class="header" href="#5-check-velocitytiming-requirements">5. Check Velocity/Timing Requirements</a></h4>
<p><strong>VelocityRange</strong> triggers require specific velocity:</p>
<pre><code class="language-toml">[trigger]
type = "VelocityRange"
note = 12
min_velocity = 81  # Only triggers on HARD press (81-127)
max_velocity = 127
</code></pre>
<p><strong>Solution</strong>: Press harder or adjust velocity range:</p>
<pre><code class="language-toml">min_velocity = 0   # Accept any velocity
max_velocity = 127
</code></pre>
<p><strong>LongPress</strong> triggers require holding:</p>
<pre><code class="language-toml">[trigger]
type = "LongPress"
note = 12
hold_duration_ms = 2000  # Must hold for 2 seconds
</code></pre>
<p><strong>Solution</strong>: Hold longer or reduce threshold:</p>
<pre><code class="language-toml">hold_duration_ms = 500  # Only 0.5 seconds
</code></pre>
<p><strong>DoubleTap</strong> requires two quick taps:</p>
<pre><code class="language-toml">[trigger]
type = "DoubleTap"
note = 12
double_tap_timeout_ms = 300  # Must tap twice within 300ms
</code></pre>
<p><strong>Solution</strong>: Tap faster or increase timeout:</p>
<pre><code class="language-toml">double_tap_timeout_ms = 500  # 0.5 seconds between taps
</code></pre>
<h4 id="6-validate-config-syntax"><a class="header" href="#6-validate-config-syntax">6. Validate Config Syntax</a></h4>
<pre><code class="language-bash"># Check for TOML syntax errors
cargo check

# Or use online validator
# https://www.toml-lint.com/
</code></pre>
<p>Common syntax errors:</p>
<ul>
<li>Missing quotes around strings</li>
<li>Wrong bracket type (<code>[]</code> vs <code>[[]]</code>)</li>
<li>Typos in field names</li>
<li>Missing required fields</li>
</ul>
<h4 id="7-test-midi-events"><a class="header" href="#7-test-midi-events">7. Test MIDI Events</a></h4>
<p>Verify your device is sending events:</p>
<pre><code class="language-bash">cargo run --bin midi_diagnostic 2
</code></pre>
<p>Press pads - you should see:</p>
<pre><code>[NoteOn]  ch:0 note:12 vel:87
[NoteOff] ch:0 note:12 vel:0
</code></pre>
<p><strong>If no events appear</strong>:</p>
<ul>
<li>MIDI connection issue (see "MIDI Device Not Found" above)</li>
<li>Device in wrong mode</li>
<li>Device needs reset (power cycle)</li>
</ul>
<h3 id="still-not-working-1"><a class="header" href="#still-not-working-1">Still Not Working?</a></h3>
<p>Create a minimal test config:</p>
<pre><code class="language-bash">cat &gt; test-config.toml &lt;&lt; 'EOF'
[[modes]]
name = "Test"

[[modes.mappings]]
description = "Test"
[modes.mappings.trigger]
type = "Note"
note = 0
[modes.mappings.action]
type = "Shell"
command = "say 'test works'"
EOF

cargo run --release 2 --config test-config.toml
</code></pre>
<p>Press pad 0. If you hear "test works", the system is functioning.</p>
<h2 id="profile-detection-issues"><a class="header" href="#profile-detection-issues">Profile Detection Issues</a></h2>
<h3 id="symptoms-3"><a class="header" href="#symptoms-3">Symptoms</a></h3>
<ul>
<li>"Failed to load profile" error</li>
<li>Wrong pads lighting up</li>
<li>LEDs work without profile but not with profile</li>
<li>Auto-page detection not working</li>
</ul>
<h3 id="causes-3"><a class="header" href="#causes-3">Causes</a></h3>
<ul>
<li>Profile file not found</li>
<li>Invalid XML format</li>
<li>Wrong pad page active</li>
<li>Note numbers not in profile</li>
<li>Profile path has spaces or special characters</li>
</ul>
<h3 id="solutions-3"><a class="header" href="#solutions-3">Solutions</a></h3>
<h4 id="1-verify-profile-file-exists"><a class="header" href="#1-verify-profile-file-exists">1. Verify Profile File Exists</a></h4>
<pre><code class="language-bash"># Check file exists
ls -la path/to/profile.ncmm3

# Try absolute path
cargo run --release 2 --profile "$HOME/Downloads/profile.ncmm3"

# Escape spaces in path
cargo run --release 2 --profile "My\ Profile.ncmm3"
</code></pre>
<h4 id="2-validate-profile-xml"><a class="header" href="#2-validate-profile-xml">2. Validate Profile XML</a></h4>
<p>Open the .ncmm3 file in a text editor and verify it's valid XML:</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;DeviceProfile&gt;
  &lt;DeviceProperties&gt;
    &lt;Name&gt;My Profile&lt;/Name&gt;
    &lt;Type&gt;MASCHINE_MIKRO_MK3&lt;/Type&gt;
  &lt;/DeviceProperties&gt;

  &lt;Mapping&gt;
    &lt;PageList&gt;
      &lt;Page name="Pad Page A"&gt;
        &lt;!-- ... --&gt;
      &lt;/Page&gt;
    &lt;/PageList&gt;
  &lt;/Mapping&gt;
&lt;/DeviceProfile&gt;
</code></pre>
<p><strong>Common issues</strong>:</p>
<ul>
<li>Missing <code>&lt;?xml</code> declaration</li>
<li>Unclosed tags</li>
<li>Invalid characters</li>
<li>Corrupted file</li>
</ul>
<p><strong>Fix</strong>: Re-export from Controller Editor or use a backup.</p>
<h4 id="3-force-specific-pad-page"><a class="header" href="#3-force-specific-pad-page">3. Force Specific Pad Page</a></h4>
<p>Auto-detection might fail if notes overlap between pages:</p>
<pre><code class="language-bash"># Instead of auto-detect
cargo run --release 2 --profile profile.ncmm3

# Force page A
cargo run --release 2 --profile profile.ncmm3 --pad-page A

# Try each page
for page in A B C D E F G H; do
    echo "Testing page $page"
    cargo run --release 2 --profile profile.ncmm3 --pad-page $page
    sleep 5
    killall midimon
done
</code></pre>
<h4 id="4-create-new-profile"><a class="header" href="#4-create-new-profile">4. Create New Profile</a></h4>
<p>If profile is corrupted:</p>
<ol>
<li>Open <strong>Native Instruments Controller Editor</strong></li>
<li>Select <strong>Maschine Mikro MK3</strong></li>
<li>Create a simple profile:
<ul>
<li>Page A: Notes 12-27 (chromatic)</li>
<li>Page B: Notes 36-51 (drums)</li>
</ul>
</li>
<li>Save as <code>test-profile.ncmm3</code></li>
<li>Test: <code>cargo run --release 2 --profile test-profile.ncmm3</code></li>
</ol>
<h4 id="5-debug-profile-loading"><a class="header" href="#5-debug-profile-loading">5. Debug Profile Loading</a></h4>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2 --profile profile.ncmm3
</code></pre>
<p>Look for:</p>
<pre><code>[DEBUG] Loading profile: profile.ncmm3
[DEBUG] Profile loaded: My Profile (MASCHINE_MIKRO_MK3)
[DEBUG] Found 8 pad pages
[DEBUG] Page A: 16 pads mapped (notes 12-27)
</code></pre>
<p><strong>If you see errors</strong>:</p>
<pre><code>[ERROR] Failed to parse profile: XML error at line 42
[ERROR] Profile validation failed: Missing required element
</code></pre>
<p>Fix the profile XML or create a new one.</p>
<h4 id="6-verify-note-numbers-match-profile"><a class="header" href="#6-verify-note-numbers-match-profile">6. Verify Note Numbers Match Profile</a></h4>
<pre><code class="language-bash"># Run pad mapper
cargo run --bin pad_mapper 2
</code></pre>
<p>Press pads and verify the notes are in your profile.</p>
<p>If note 50 is pressed but your profile only has notes 12-27, no LED will light.</p>
<p><strong>Solution</strong>: Either:</p>
<ul>
<li>Update profile to include note 50</li>
<li>Change hardware to send notes 12-27 (in Controller Editor)</li>
</ul>
<h2 id="platform-specific-issues"><a class="header" href="#platform-specific-issues">Platform-Specific Issues</a></h2>
<h3 id="macos-permission-dialogs-keep-appearing"><a class="header" href="#macos-permission-dialogs-keep-appearing">macOS: Permission Dialogs Keep Appearing</a></h3>
<p><strong>Cause</strong>: Binary changes (recompiling) invalidates permissions</p>
<p><strong>Solution</strong>: Grant permission to Terminal.app instead:</p>
<ol>
<li>System Settings → Privacy &amp; Security → Input Monitoring</li>
<li>Add <code>Terminal</code> (or your terminal emulator)</li>
<li>Run via <code>cargo run</code> - permission persists across rebuilds</li>
</ol>
<p><strong>Alternative</strong>: Code-sign the binary:</p>
<pre><code class="language-bash">codesign --force --deep --sign - target/release/midimon
</code></pre>
<h3 id="macos-cannot-be-opened-because-the-developer-cannot-be-verified"><a class="header" href="#macos-cannot-be-opened-because-the-developer-cannot-be-verified">macOS: "Cannot be opened because the developer cannot be verified"</a></h3>
<p><strong>Solution</strong>:</p>
<pre><code class="language-bash"># Remove quarantine attribute
xattr -d com.apple.quarantine target/release/midimon

# Or allow in System Settings
# Right-click binary → Open → Allow
</code></pre>
<h3 id="linux-permission-denied-usbhid-access"><a class="header" href="#linux-permission-denied-usbhid-access">Linux: Permission Denied (USB/HID Access)</a></h3>
<p><strong>Cause</strong>: User not in <code>plugdev</code> group or missing udev rules</p>
<p><strong>Solution</strong>:</p>
<ol>
<li>Add udev rules:</li>
</ol>
<pre><code class="language-bash">sudo tee /etc/udev/rules.d/50-midimon.rules &lt;&lt; 'EOF'
# Native Instruments Maschine Mikro MK3
SUBSYSTEM=="usb", ATTRS{idVendor}=="17cc", ATTRS{idProduct}=="1600", MODE="0666", GROUP="plugdev"
SUBSYSTEM=="usb", ATTRS{bInterfaceClass}=="01", ATTRS{bInterfaceSubClass}=="03", MODE="0666", GROUP="plugdev"
EOF

sudo udevadm control --reload-rules
sudo udevadm trigger
</code></pre>
<ol start="2">
<li>Add user to plugdev:</li>
</ol>
<pre><code class="language-bash">sudo usermod -a -G plugdev $USER
</code></pre>
<ol start="3">
<li>
<p>Log out and back in</p>
</li>
<li>
<p>Test:</p>
</li>
</ol>
<pre><code class="language-bash">cargo run --release 2
</code></pre>
<h3 id="windows-midi-device-not-recognized"><a class="header" href="#windows-midi-device-not-recognized">Windows: MIDI Device Not Recognized</a></h3>
<p><strong>Cause</strong>: Driver not installed or generic USB driver used</p>
<p><strong>Solution</strong>:</p>
<ol>
<li>Open Device Manager</li>
<li>Look for "MIDI Device" or your controller under "Sound, video and game controllers"</li>
<li>Right-click → Update Driver</li>
<li>Choose manufacturer driver (not generic USB)</li>
<li>Or install via Native Access</li>
</ol>
<h2 id="performance-issues"><a class="header" href="#performance-issues">Performance Issues</a></h2>
<h3 id="high-cpu-usage"><a class="header" href="#high-cpu-usage">High CPU Usage</a></h3>
<p><strong>Symptom</strong>: MIDIMon using &gt;10% CPU</p>
<p><strong>Causes</strong>:</p>
<ul>
<li>Debug logging enabled</li>
<li>Animated LED scheme with high update rate</li>
<li>Shell actions running slowly</li>
<li>Event processing loop not optimizing</li>
</ul>
<p><strong>Solutions</strong>:</p>
<ol>
<li>
<p>Disable debug logging:</p>
<pre><code class="language-bash"># Don't use DEBUG=1 in production
cargo run --release 2
</code></pre>
</li>
<li>
<p>Use simpler LED scheme:</p>
<pre><code class="language-bash"># Instead of animated schemes
cargo run --release 2 --led reactive  # or off
</code></pre>
</li>
<li>
<p>Optimize shell actions:</p>
<pre><code class="language-bash"># Avoid long-running commands in mappings
# Bad:
command = "sleep 10 &amp;&amp; echo done"

# Good:
command = "echo done &amp;"  # Background process
</code></pre>
</li>
<li>
<p>Build release mode:</p>
<pre><code class="language-bash"># Debug builds are 20-30% slower
cargo build --release
./target/release/midimon 2
</code></pre>
</li>
</ol>
<h3 id="high-latency-delayed-response"><a class="header" href="#high-latency-delayed-response">High Latency (Delayed Response)</a></h3>
<p><strong>Symptom</strong>: Actions trigger 50-100ms+ after pad press</p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>Use release build (not debug)</li>
<li>Check system load (Activity Monitor/Task Manager)</li>
<li>Close unnecessary applications</li>
<li>Check MIDI buffer settings in Audio MIDI Setup (macOS)</li>
</ol>
<p><strong>Verify latency</strong>:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
<p>Watch timestamps:</p>
<pre><code>[16:32:45.123] NoteOn received
[16:32:45.124] Action executed  # Should be &lt;2ms
</code></pre>
<p>If &gt;10ms, investigate system performance.</p>
<h2 id="getting-additional-help"><a class="header" href="#getting-additional-help">Getting Additional Help</a></h2>
<p>If your issue isn't covered here:</p>
<ol>
<li>Check <a href="troubleshooting/diagnostics.html">Diagnostics Guide</a> for detailed troubleshooting</li>
<li>Enable debug logging: <code>DEBUG=1 cargo run --release 2</code></li>
<li>Run diagnostic tools:
<pre><code class="language-bash">cargo run --bin midi_diagnostic 2
cargo run --bin led_diagnostic
cargo run --bin test_midi
</code></pre>
</li>
<li>Collect information:
<ul>
<li>macOS/Linux/Windows version</li>
<li>MIDIMon version: <code>cargo --version</code></li>
<li>Device model</li>
<li>Error messages (full output)</li>
<li>Debug log output</li>
</ul>
</li>
<li>File an issue on GitHub with collected information</li>
</ol>
<hr />
<p><strong>Last Updated</strong>: November 11, 2025
<strong>Status</strong>: Actively maintained</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="faq"><a class="header" href="#faq">FAQ</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-15"><a class="header" href="#coming-soon-15">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="troubleshooting/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="diagnostic-tools-and-procedures"><a class="header" href="#diagnostic-tools-and-procedures">Diagnostic Tools and Procedures</a></h1>
<h2 id="overview-6"><a class="header" href="#overview-6">Overview</a></h2>
<p>MIDIMon includes a comprehensive suite of diagnostic tools for debugging connectivity, event processing, LED control, and configuration issues. This guide covers each tool in detail and provides systematic troubleshooting procedures.</p>
<h2 id="quick-diagnostic-checklist"><a class="header" href="#quick-diagnostic-checklist">Quick Diagnostic Checklist</a></h2>
<p>Before diving deep, run through this quick checklist:</p>
<pre><code class="language-bash"># 1. Check USB/MIDI connectivity
cargo run --bin test_midi

# 2. Verify MIDI events are received
cargo run --bin midi_diagnostic 2

# 3. Test LED/HID access
cargo run --bin led_diagnostic

# 4. Find note numbers
cargo run --bin pad_mapper 2

# 5. Enable debug logging
DEBUG=1 cargo run --release 2
</code></pre>
<p>If all five succeed, the hardware and drivers are working correctly.</p>
<h2 id="diagnostic-tool-reference"><a class="header" href="#diagnostic-tool-reference">Diagnostic Tool Reference</a></h2>
<h3 id="1-test_midi---midi-port-testing"><a class="header" href="#1-test_midi---midi-port-testing">1. test_midi - MIDI Port Testing</a></h3>
<p><strong>Purpose</strong>: Verify MIDI connectivity, enumerate all available ports, test basic MIDI communication.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin test_midi
</code></pre>
<p><strong>What it does</strong>:</p>
<ol>
<li>Lists all MIDI input ports</li>
<li>Lists all MIDI output ports</li>
<li>Attempts to open port 2 (default)</li>
<li>Waits for a MIDI event (5-second timeout)</li>
<li>Reports success or failure</li>
</ol>
<p><strong>Expected output</strong> (working):</p>
<pre><code>MIDI Port Test
==============

Available input ports:
0: USB MIDI Device
1: IAC Driver Bus 1
2: Maschine Mikro MK3 - Input
3: Digital Keyboard

Available output ports:
0: USB MIDI Device
1: IAC Driver Bus 1
2: Maschine Mikro MK3 - Output

Testing port 2 (input)...
✓ Successfully opened port: Maschine Mikro MK3 - Input

Waiting for MIDI event... (5 second timeout)
✓ Received MIDI event: NoteOn ch:0 note:12 vel:87

Connection test: PASSED
All MIDI functionality working correctly.
</code></pre>
<p><strong>Error output</strong> (device not found):</p>
<pre><code>Available input ports:
0: IAC Driver Bus 1
# Device missing!

Testing port 2 (input)...
✗ Error: Port index 2 out of range (only 1 ports available)

Connection test: FAILED
</code></pre>
<p><strong>Interpreting results</strong>:</p>
<ul>
<li><strong>Device not listed</strong>: USB/driver issue (see <a href="troubleshooting/common-issues.html#midi-device-not-found">Common Issues - MIDI Device Not Found</a>)</li>
<li><strong>Timeout on event</strong>: Device connected but not sending data
<ul>
<li>Check device is in MIDI mode (not HID-only mode)</li>
<li>Verify pads/keys are functional</li>
<li>Try different port number</li>
</ul>
</li>
<li><strong>"Permission denied"</strong>: User permission issue (Linux)
<ul>
<li>Add user to <code>audio</code> or <code>plugdev</code> group</li>
<li>Check udev rules</li>
</ul>
</li>
</ul>
<p><strong>When to use</strong>:</p>
<ul>
<li>First step in any MIDI troubleshooting</li>
<li>After connecting a new device</li>
<li>After driver installation</li>
<li>Verifying port numbers before running midimon</li>
</ul>
<h3 id="2-midi_diagnostic---midi-event-monitor"><a class="header" href="#2-midi_diagnostic---midi-event-monitor">2. midi_diagnostic - MIDI Event Monitor</a></h3>
<p><strong>Purpose</strong>: Real-time visualization of all MIDI events for debugging event detection and mapping issues.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin midi_diagnostic &lt;PORT&gt;

# Example
cargo run --bin midi_diagnostic 2
</code></pre>
<p><strong>What it does</strong>:</p>
<ul>
<li>Opens specified MIDI port</li>
<li>Listens for all MIDI events</li>
<li>Displays events in human-readable format</li>
<li>Shows channel, note/cc number, velocity/value</li>
<li>Runs until Ctrl+C</li>
</ul>
<p><strong>Output format</strong>:</p>
<pre><code>Connected to MIDI port 2: Maschine Mikro MK3 - Input
Listening for MIDI events... (Ctrl+C to exit)

[16:32:45] [NoteOn]  ch:0 note:12 vel:87
[16:32:45] [NoteOff] ch:0 note:12 vel:0
[16:32:46] [NoteOn]  ch:0 note:13 vel:64
[16:32:46] [NoteOff] ch:0 note:13 vel:0
[16:32:47] [CC]      ch:0 cc:1 value:64
[16:32:48] [PitchBend] ch:0 value:8192
[16:32:49] [Aftertouch] ch:0 note:12 pressure:48
</code></pre>
<p><strong>Event types shown</strong>:</p>
<ul>
<li>
<p><strong>NoteOn</strong>: Note pressed</p>
<ul>
<li><code>ch</code>: MIDI channel (0-15)</li>
<li><code>note</code>: Note number (0-127)</li>
<li><code>vel</code>: Velocity (0-127)</li>
</ul>
</li>
<li>
<p><strong>NoteOff</strong>: Note released</p>
<ul>
<li><code>vel</code> is usually 0, some devices use release velocity</li>
</ul>
</li>
<li>
<p><strong>CC</strong> (Control Change): Knob, slider, encoder</p>
<ul>
<li><code>cc</code>: Controller number (0-127)</li>
<li><code>value</code>: Value (0-127)</li>
</ul>
</li>
<li>
<p><strong>PitchBend</strong>: Touch strip, pitch wheel</p>
<ul>
<li><code>value</code>: Bend amount (0-16383, center=8192)</li>
</ul>
</li>
<li>
<p><strong>Aftertouch</strong>: Pressure sensitivity</p>
<ul>
<li><code>note</code>: Which note (if polyphonic)</li>
<li><code>pressure</code>: Pressure value (0-127)</li>
</ul>
</li>
<li>
<p><strong>ProgramChange</strong>: Program/patch change</p>
<ul>
<li><code>program</code>: Program number (0-127)</li>
</ul>
</li>
</ul>
<p><strong>Use cases</strong>:</p>
<ol>
<li>
<p><strong>Verify MIDI events are being sent</strong>:</p>
<pre><code class="language-bash">cargo run --bin midi_diagnostic 2
# Press pads - you should see NoteOn/NoteOff events
</code></pre>
</li>
<li>
<p><strong>Find note numbers for config</strong>:</p>
<pre><code class="language-bash">cargo run --bin midi_diagnostic 2
# Press pad → note:12 → use 12 in config.toml
</code></pre>
</li>
<li>
<p><strong>Debug why mappings aren't triggering</strong>:</p>
<pre><code class="language-bash"># Compare MIDI diagnostic output with config.toml
# If you see note:25 but config has note:12, they don't match
</code></pre>
</li>
<li>
<p><strong>Verify velocity ranges</strong>:</p>
<pre><code class="language-bash">cargo run --bin midi_diagnostic 2
# Soft tap:  vel:32  (0-40 range)
# Medium:    vel:68  (41-80 range)
# Hard hit:  vel:105 (81-127 range)
</code></pre>
</li>
<li>
<p><strong>Check encoder/knob CC numbers</strong>:</p>
<pre><code class="language-bash">cargo run --bin midi_diagnostic 2
# Turn encoder → [CC] ch:0 cc:1 value:65
# Use cc:1 in EncoderTurn trigger
</code></pre>
</li>
</ol>
<p><strong>Troubleshooting with midi_diagnostic</strong>:</p>
<p><strong>Problem</strong>: No events appear when pressing pads</p>
<p><strong>Solutions</strong>:</p>
<ul>
<li>Wrong port number (try 0, 1, 2, 3, etc.)</li>
<li>Device not sending MIDI (check device settings)</li>
<li>USB cable issue (try different cable)</li>
<li>Driver issue (reinstall drivers)</li>
</ul>
<p><strong>Problem</strong>: Wrong note numbers appearing</p>
<p><strong>Cause</strong>: Device is on different pad page or has custom profile</p>
<p><strong>Solution</strong>: Either:</p>
<ul>
<li>Change device to expected page</li>
<li>Update config.toml with actual note numbers</li>
<li>Use <code>--profile</code> flag with correct profile</li>
</ul>
<p><strong>Problem</strong>: Events appear but with unexpected values</p>
<p><strong>Example</strong>: Expecting ch:0 but seeing ch:1</p>
<p><strong>Solution</strong>: Update trigger channel in config:</p>
<pre><code class="language-toml">[trigger]
type = "Note"
note = 12
channel = 1  # Add channel specification
</code></pre>
<h3 id="3-led_diagnostic---ledhid-testing"><a class="header" href="#3-led_diagnostic---ledhid-testing">3. led_diagnostic - LED/HID Testing</a></h3>
<p><strong>Purpose</strong>: Test LED control and HID device access for troubleshooting lighting issues.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin led_diagnostic
</code></pre>
<p><strong>What it does</strong>:</p>
<ol>
<li>Searches for HID device (Maschine Mikro MK3)</li>
<li>Attempts to open HID device</li>
<li>Tests LED control by cycling through all pads</li>
<li>Displays each step's success/failure</li>
</ol>
<p><strong>Expected output</strong> (working):</p>
<pre><code>LED Diagnostic Tool
==================

Searching for Maschine Mikro MK3...
✓ Device found: Maschine Mikro MK3 (VID:17cc PID:1600)
  Serial: XXXXXXXX
  Manufacturer: Native Instruments
  Product: Maschine Mikro MK3

Opening HID device...
✓ HID device opened successfully
✓ Device supports shared access

Testing LED control...
- Lighting pad 0 (Red Bright)... ✓
- Lighting pad 1 (Orange Bright)... ✓
- Lighting pad 2 (Yellow Bright)... ✓
- Lighting pad 3 (Green Bright)... ✓
- Lighting pad 4 (Blue Bright)... ✓
- Lighting pad 5 (Purple Bright)... ✓
[... continues for all 16 pads ...]

Testing patterns...
✓ Rainbow pattern
✓ All pads lit (White)
✓ All pads cleared

LED Diagnostic: PASSED
All LED functionality working correctly.
</code></pre>
<p><strong>Error output</strong> (permission denied - macOS):</p>
<pre><code>Searching for Maschine Mikro MK3...
✓ Device found: Maschine Mikro MK3 (VID:17cc PID:1600)

Opening HID device...
✗ Failed to open HID device
  Error: Permission denied (os error 13)

  Possible causes:
  1. Input Monitoring permission not granted
  2. Device already in exclusive use
  3. Native Instruments drivers not installed

  Solutions:
  1. Grant Input Monitoring permission:
     System Settings → Privacy &amp; Security → Input Monitoring
     Enable Terminal or midimon

  2. Close other applications using the device:
     - Native Instruments Controller Editor
     - Maschine software
     - Other MIDI software

  3. Install NI drivers:
     Download Native Access and install Maschine drivers

LED Diagnostic: FAILED
</code></pre>
<p><strong>Error output</strong> (device not found):</p>
<pre><code>Searching for Maschine Mikro MK3...
✗ Device not found

Checked for:
- Vendor ID: 0x17cc (Native Instruments)
- Product ID: 0x1600 (Maschine Mikro MK3)

Possible causes:
1. Device not connected
2. Wrong USB port or cable
3. Device powered off
4. HID driver not installed

Solutions:
1. Check USB connection:
   system_profiler SPUSBDataType | grep -i mikro

2. Try different USB port/cable

3. Power cycle device (unplug, wait 10s, replug)

LED Diagnostic: FAILED
</code></pre>
<p><strong>Interpreting results</strong>:</p>
<ul>
<li><strong>Device found, opened, LEDs working</strong>: All HID/LED functionality OK</li>
<li><strong>Device found but won't open</strong>: Permission or driver issue</li>
<li><strong>Device not found</strong>: USB/hardware issue</li>
<li><strong>Opens but LEDs don't light</strong>: Coordinate mapping or hardware issue</li>
</ul>
<p><strong>When to use</strong>:</p>
<ul>
<li>LEDs not working in main application</li>
<li>After granting Input Monitoring permission (verify it worked)</li>
<li>After installing NI drivers (verify driver installation)</li>
<li>Testing LED hardware functionality</li>
<li>Before reporting LED bugs</li>
</ul>
<h3 id="4-led_tester---interactive-led-control"><a class="header" href="#4-led_tester---interactive-led-control">4. led_tester - Interactive LED Control</a></h3>
<p><strong>Purpose</strong>: Manual control of individual LEDs for testing coordinate mapping and hardware.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin led_tester
</code></pre>
<p><strong>Interactive mode</strong>:</p>
<pre><code>LED Tester - Interactive Mode
==============================
Device: Maschine Mikro MK3 (VID:17cc PID:1600)
Status: Connected

Commands:
  on &lt;pad&gt; &lt;color&gt; &lt;brightness&gt;   Turn on specific LED
  off &lt;pad&gt;                       Turn off specific LED
  all &lt;color&gt; &lt;brightness&gt;        Set all LEDs
  clear                           Clear all LEDs
  rainbow                         Show rainbow pattern
  test                            Cycle through all pads
  coords                          Show pad coordinate mapping
  help                            Show this help
  quit                            Exit

Pad numbers: 0-15
Colors: red, orange, yellow, green, blue, purple, magenta, white
Brightness: 0 (off), 1 (dim), 2 (normal), 3 (bright)

&gt;
</code></pre>
<p><strong>Example session</strong>:</p>
<pre><code>&gt; on 0 red 3
✓ Pad 0: Red Bright

&gt; on 1 green 2
✓ Pad 1: Green Normal

&gt; all blue 1
✓ All pads: Blue Dim

&gt; rainbow
✓ Rainbow pattern displayed

&gt; test
Testing all pads (press Ctrl+C to stop)...
Pad 0... Pad 1... Pad 2... [continues]

&gt; coords
Pad Coordinate Mapping:
Pad Index -&gt; LED Position

Physical Layout (bottom-up):
12  13  14  15  &lt;- Top row
 8   9  10  11
 4   5   6   7
 0   1   2   3  &lt;- Bottom row

LED Buffer (top-down):
 0   1   2   3  &lt;- Top (buffer 0-3)
 4   5   6   7
 8   9  10  11
12  13  14  15  &lt;- Bottom (buffer 12-15)

Mapping Table:
  Pad  0 -&gt; LED 12    Pad  8 -&gt; LED  4
  Pad  1 -&gt; LED 13    Pad  9 -&gt; LED  5
  Pad  2 -&gt; LED 14    Pad 10 -&gt; LED  6
  Pad  3 -&gt; LED 15    Pad 11 -&gt; LED  7
  Pad  4 -&gt; LED  8    Pad 12 -&gt; LED  0
  Pad  5 -&gt; LED  9    Pad 13 -&gt; LED  1
  Pad  6 -&gt; LED 10    Pad 14 -&gt; LED  2
  Pad  7 -&gt; LED 11    Pad 15 -&gt; LED  3

&gt; clear
✓ All LEDs cleared

&gt; quit
Goodbye!
</code></pre>
<p><strong>Use cases</strong>:</p>
<ol>
<li>
<p><strong>Test individual pad LEDs</strong>:</p>
<pre><code>&gt; on 0 white 3
# Bottom-left pad should light up bright white
</code></pre>
</li>
<li>
<p><strong>Verify coordinate mapping</strong>:</p>
<pre><code>&gt; coords
# Shows physical layout vs LED buffer
&gt; on 0 red 3
# Verify bottom-left pad lights (should be LED buffer position 12)
</code></pre>
</li>
<li>
<p><strong>Test all colors</strong>:</p>
<pre><code>&gt; on 0 red 3
&gt; on 1 orange 3
&gt; on 2 yellow 3
&gt; on 3 green 3
&gt; on 4 blue 3
&gt; on 5 purple 3
</code></pre>
</li>
<li>
<p><strong>Brightness testing</strong>:</p>
<pre><code>&gt; on 0 white 0   # Off
&gt; on 0 white 1   # Dim
&gt; on 0 white 2   # Normal
&gt; on 0 white 3   # Bright
</code></pre>
</li>
</ol>
<p><strong>When to use</strong>:</p>
<ul>
<li>Debugging coordinate mapping issues</li>
<li>Testing specific pad LEDs (identify dead LEDs)</li>
<li>Understanding LED coordinate system</li>
<li>Verifying color/brightness encoding</li>
</ul>
<h3 id="5-pad_mapper---note-number-discovery"><a class="header" href="#5-pad_mapper---note-number-discovery">5. pad_mapper - Note Number Discovery</a></h3>
<p><strong>Purpose</strong>: Identify MIDI note numbers for physical pads to use in config.toml.</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">cargo run --bin pad_mapper &lt;PORT&gt;

# Example
cargo run --bin pad_mapper 2
</code></pre>
<p><strong>What it does</strong>:</p>
<ul>
<li>Opens MIDI port</li>
<li>Listens for NoteOn events</li>
<li>Displays note number and velocity for each press</li>
<li>Continues until Ctrl+C</li>
</ul>
<p><strong>Output</strong>:</p>
<pre><code>Pad Mapper - Find Note Numbers for Your Controller
===================================================
Connected to port 2: Maschine Mikro MK3 - Input

Press pads in order (bottom-left to top-right) and write down note numbers.
Ctrl+C to exit when done.

Pad pressed: Note 12 (velocity: 87)
Pad pressed: Note 13 (velocity: 64)
Pad pressed: Note 14 (velocity: 92)
Pad pressed: Note 15 (velocity: 73)
Pad pressed: Note 8  (velocity: 55)
Pad pressed: Note 9  (velocity: 81)
[continues as you press pads...]
</code></pre>
<p><strong>Recommended workflow</strong>:</p>
<ol>
<li>
<p><strong>Run pad_mapper</strong>:</p>
<pre><code class="language-bash">cargo run --bin pad_mapper 2
</code></pre>
</li>
<li>
<p><strong>Draw a grid</strong> on paper:</p>
<pre><code>[ ] [ ] [ ] [ ]  &lt;- Top row
[ ] [ ] [ ] [ ]
[ ] [ ] [ ] [ ]
[ ] [ ] [ ] [ ]  &lt;- Bottom row
</code></pre>
</li>
<li>
<p><strong>Press each pad</strong> starting bottom-left, moving right:</p>
<ul>
<li>Press bottom-left → write down note number (e.g., 12)</li>
<li>Press next pad right → write down note number (e.g., 13)</li>
<li>Continue for all 16 pads</li>
</ul>
</li>
<li>
<p><strong>Result</strong>:</p>
<pre><code>[12][13][14][15]  &lt;- Top row
[ 8][ 9][10][11]
[ 4][ 5][ 6][ 7]
[ 0][ 1][ 2][ 3]  &lt;- Bottom row
</code></pre>
<p>Wait, those look wrong! That's because your device might be on a different page or have a custom profile. The numbers you write down are the ones to use in config.toml.</p>
</li>
<li>
<p><strong>Update config.toml</strong> with actual note numbers:</p>
<pre><code class="language-toml">[[modes.mappings]]
description = "Bottom-left pad"
[modes.mappings.trigger]
type = "Note"
note = 0  # Or whatever number you wrote down
</code></pre>
</li>
</ol>
<p><strong>Use cases</strong>:</p>
<ul>
<li>Initial setup of a new device</li>
<li>Creating config.toml for the first time</li>
<li>Verifying note numbers after changing device profile</li>
<li>Debugging why specific pads don't work</li>
</ul>
<p><strong>Tips</strong>:</p>
<ul>
<li>Press pads gently and consistently (velocity affects detection)</li>
<li>Write down numbers immediately (easy to forget)</li>
<li>Take a photo of your paper grid for reference</li>
<li>Some controllers send different notes on different "pages" or "banks"</li>
</ul>
<h2 id="advanced-debugging-with-debug1"><a class="header" href="#advanced-debugging-with-debug1">Advanced Debugging with DEBUG=1</a></h2>
<p>Enable verbose debug logging to see internal event processing:</p>
<p><strong>Syntax</strong>:</p>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2
</code></pre>
<h3 id="debug-output-format"><a class="header" href="#debug-output-format">Debug Output Format</a></h3>
<p><strong>MIDI Events</strong>:</p>
<pre><code>[16:32:45.123] [MIDI] NoteOn ch:0 note:12 vel:87
[16:32:45.124] [MIDI] NoteOff ch:0 note:12 vel:0
</code></pre>
<p><strong>Event Processing</strong>:</p>
<pre><code>[DEBUG] Processing NoteOn: note=12 vel=87
[DEBUG] Detected velocity range: Medium (41-80)
[DEBUG] Stored note 12 in press tracker (time: 16:32:45.123)
</code></pre>
<p><strong>Mapping Engine</strong>:</p>
<pre><code>[DEBUG] Checking 24 mappings in mode 'Default'
[DEBUG] Matched mapping: "Copy text" (trigger: Note(12))
[DEBUG] Compiled action: Keystroke { keys: "c", modifiers: ["cmd"] }
</code></pre>
<p><strong>Action Execution</strong>:</p>
<pre><code>[DEBUG] Executing Keystroke action
[DEBUG] Pressing key: C
[DEBUG] Holding modifiers: [Cmd]
[DEBUG] Releasing key: C
✓ Action executed successfully (1.2ms)
</code></pre>
<p><strong>LED Updates</strong>:</p>
<pre><code>[DEBUG] LED update request: pad=0 color=Green brightness=2
[DEBUG] Mapped pad 0 -&gt; LED position 12
[DEBUG] HID buffer: [80 00 00 ... 1D ... 00] (81 bytes)
[DEBUG] HID write successful (4 bytes written)
</code></pre>
<p><strong>Mode Changes</strong>:</p>
<pre><code>[DEBUG] Mode change requested: next
[DEBUG] Current mode: 0 (Default)
[DEBUG] Switching to mode: 1 (Developer)
[INFO] Mode changed: Default -&gt; Developer
</code></pre>
<p><strong>Timers and State</strong>:</p>
<pre><code>[DEBUG] Long press timer started: note=12 threshold=2000ms
[DEBUG] Note released after 1523ms (threshold: 2000ms)
[DEBUG] Long press NOT triggered (held too short)
</code></pre>
<pre><code>[DEBUG] Double-tap window started: note=12 timeout=300ms
[DEBUG] Second tap detected within 287ms
[DEBUG] Double-tap triggered: note=12
</code></pre>
<pre><code>[DEBUG] Chord detection: notes=[12, 13, 14] timeout=100ms
[DEBUG] All notes pressed within 47ms
[DEBUG] Chord triggered: [12, 13, 14]
</code></pre>
<h3 id="interpreting-debug-output"><a class="header" href="#interpreting-debug-output">Interpreting Debug Output</a></h3>
<h4 id="problem-mapping-not-triggering"><a class="header" href="#problem-mapping-not-triggering">Problem: Mapping not triggering</a></h4>
<p><strong>Look for</strong>:</p>
<pre><code>[DEBUG] No mapping matched for event: Note(12)
</code></pre>
<p><strong>Possible causes</strong>:</p>
<ul>
<li>Note number mismatch (check pad_mapper output)</li>
<li>Wrong mode (check current mode in debug output)</li>
<li>Trigger conditions not met (velocity, timing)</li>
</ul>
<p><strong>Solution</strong>: Compare debug output with config.toml</p>
<hr />
<h4 id="problem-action-not-executing"><a class="header" href="#problem-action-not-executing">Problem: Action not executing</a></h4>
<p><strong>Look for</strong>:</p>
<pre><code>[DEBUG] Matched mapping: "Test"
[ERROR] Failed to execute action: Command not found
</code></pre>
<p><strong>Cause</strong>: Action configuration error (e.g., invalid shell command)</p>
<p><strong>Solution</strong>: Fix action in config.toml</p>
<hr />
<h4 id="problem-leds-not-updating"><a class="header" href="#problem-leds-not-updating">Problem: LEDs not updating</a></h4>
<p><strong>Look for</strong>:</p>
<pre><code>[DEBUG] LED update request: pad=0
[ERROR] HID write failed: Device not open
</code></pre>
<p><strong>Cause</strong>: HID device not accessible</p>
<p><strong>Solution</strong>: Check permissions, run led_diagnostic</p>
<hr />
<h2 id="usb-connection-verification"><a class="header" href="#usb-connection-verification">USB Connection Verification</a></h2>
<h3 id="macos-3"><a class="header" href="#macos-3">macOS</a></h3>
<p><strong>Check USB device enumeration</strong>:</p>
<pre><code class="language-bash"># List all USB devices
system_profiler SPUSBDataType

# Filter for your device
system_profiler SPUSBDataType | grep -i mikro

# More detailed output
system_profiler SPUSBDataType | grep -B 10 -A 10 "Mikro"
</code></pre>
<p><strong>Expected output</strong>:</p>
<pre><code>Maschine Mikro MK3:
  Product ID: 0x1600
  Vendor ID: 0x17cc  (Native Instruments)
  Version: 1.00
  Serial Number: XXXXXXXX
  Speed: Up to 12 Mb/s
  Manufacturer: Native Instruments
  Location ID: 0x14200000 / 5
  Current Available (mA): 500
  Current Required (mA): 100
  Extra Operating Current (mA): 0
</code></pre>
<p><strong>Check for device disappearance</strong>:</p>
<pre><code class="language-bash"># Monitor USB devices
log stream --predicate 'eventMessage contains "USB"' --level info
</code></pre>
<p>Then plug/unplug device - you should see connection events.</p>
<h3 id="linux-2"><a class="header" href="#linux-2">Linux</a></h3>
<p><strong>Check USB devices</strong>:</p>
<pre><code class="language-bash"># List USB devices
lsusb

# Filter for Native Instruments (VID: 17cc)
lsusb | grep 17cc

# Detailed info
lsusb -v -d 17cc:1600
</code></pre>
<p><strong>Check dmesg for USB events</strong>:</p>
<pre><code class="language-bash"># Show recent USB events
dmesg | grep -i usb | tail -20

# Monitor in real-time
dmesg -w | grep -i usb
</code></pre>
<p><strong>Check ALSA MIDI</strong>:</p>
<pre><code class="language-bash"># List ALSA MIDI devices
aconnect -l

# Or
amidi -l
</code></pre>
<h3 id="windows-2"><a class="header" href="#windows-2">Windows</a></h3>
<p><strong>Device Manager</strong>:</p>
<ol>
<li>Open Device Manager (Win+X → Device Manager)</li>
<li>Expand "Sound, video and game controllers"</li>
<li>Look for your MIDI device</li>
<li>Right-click → Properties → Check status</li>
</ol>
<p><strong>Check MIDI devices via PowerShell</strong>:</p>
<pre><code class="language-powershell">Get-PnpDevice -Class MEDIA | Format-Table -AutoSize
</code></pre>
<h2 id="interpreting-error-messages"><a class="header" href="#interpreting-error-messages">Interpreting Error Messages</a></h2>
<h3 id="common-error-patterns"><a class="header" href="#common-error-patterns">Common Error Patterns</a></h3>
<h4 id="no-midi-input-ports-available"><a class="header" href="#no-midi-input-ports-available">"No MIDI input ports available"</a></h4>
<p><strong>Meaning</strong>: No MIDI devices detected at all</p>
<p><strong>Debug steps</strong>:</p>
<ol>
<li><code>system_profiler SPUSBDataType | grep -i usb</code></li>
<li><code>cargo run --bin test_midi</code></li>
<li>Check USB connection</li>
<li>Verify drivers installed</li>
</ol>
<hr />
<h4 id="failed-to-open-hid-device"><a class="header" href="#failed-to-open-hid-device">"Failed to open HID device"</a></h4>
<p><strong>Meaning</strong>: Device found but can't access HID interface</p>
<p><strong>Debug steps</strong>:</p>
<ol>
<li>Check permissions (Input Monitoring on macOS)</li>
<li><code>cargo run --bin led_diagnostic</code></li>
<li>Close other applications using device</li>
<li>Reinstall NI drivers</li>
</ol>
<hr />
<h4 id="toml-parse-error-at-line-x"><a class="header" href="#toml-parse-error-at-line-x">"TOML parse error at line X"</a></h4>
<p><strong>Meaning</strong>: Syntax error in config.toml</p>
<p><strong>Debug steps</strong>:</p>
<ol>
<li>Open config.toml in editor</li>
<li>Go to line X</li>
<li>Check for:
<ul>
<li>Missing quotes</li>
<li>Wrong brackets</li>
<li>Typos in field names</li>
</ul>
</li>
<li>Validate at https://www.toml-lint.com/</li>
</ol>
<hr />
<h4 id="missing-field-type-in-trigger"><a class="header" href="#missing-field-type-in-trigger">"Missing field 'type' in trigger"</a></h4>
<p><strong>Meaning</strong>: Invalid config structure</p>
<p><strong>Debug steps</strong>:</p>
<ol>
<li>Find the mapping missing <code>type</code></li>
<li>Add <code>type</code> field:
<pre><code class="language-toml">[trigger]
type = "Note"  # Add this
note = 12
</code></pre>
</li>
</ol>
<hr />
<h4 id="permission-denied-os-error-13"><a class="header" href="#permission-denied-os-error-13">"Permission denied (os error 13)"</a></h4>
<p><strong>Meaning</strong>: Insufficient permissions</p>
<p><strong>macOS</strong>: Grant Input Monitoring permission</p>
<p><strong>Linux</strong>: Add user to <code>plugdev</code> group and create udev rules</p>
<p><strong>Windows</strong>: Run as Administrator (not recommended for regular use)</p>
<hr />
<h2 id="systematic-troubleshooting-procedure"><a class="header" href="#systematic-troubleshooting-procedure">Systematic Troubleshooting Procedure</a></h2>
<p>When something doesn't work, follow this systematic approach:</p>
<h3 id="level-1-hardware-connectivity"><a class="header" href="#level-1-hardware-connectivity">Level 1: Hardware Connectivity</a></h3>
<pre><code class="language-bash"># 1. Check USB enumeration
system_profiler SPUSBDataType | grep -i mikro

# 2. Test MIDI ports
cargo run --bin test_midi

# 3. Monitor MIDI events
cargo run --bin midi_diagnostic 2
</code></pre>
<p><strong>If Level 1 fails</strong>: Hardware or driver issue (see <a href="troubleshooting/common-issues.html">Common Issues</a>)</p>
<h3 id="level-2-software-connectivity"><a class="header" href="#level-2-software-connectivity">Level 2: Software Connectivity</a></h3>
<pre><code class="language-bash"># 4. Test HID access
cargo run --bin led_diagnostic

# 5. Find note numbers
cargo run --bin pad_mapper 2

# 6. Run with debug logging
DEBUG=1 cargo run --release 2
</code></pre>
<p><strong>If Level 2 fails</strong>: Permission or configuration issue</p>
<h3 id="level-3-configuration-validation"><a class="header" href="#level-3-configuration-validation">Level 3: Configuration Validation</a></h3>
<pre><code class="language-bash"># 7. Validate config syntax
cargo check

# 8. Test with minimal config
cat &gt; test.toml &lt;&lt; 'EOF'
[[modes]]
name = "Test"
[[modes.mappings]]
description = "Test"
[modes.mappings.trigger]
type = "Note"
note = 0
[modes.mappings.action]
type = "Shell"
command = "say test"
EOF

cargo run --release 2 --config test.toml

# 9. Compare note numbers
# pad_mapper output vs config.toml
</code></pre>
<p><strong>If Level 3 fails</strong>: Config syntax or mapping issue</p>
<h3 id="level-4-deep-debugging"><a class="header" href="#level-4-deep-debugging">Level 4: Deep Debugging</a></h3>
<pre><code class="language-bash"># 10. Enable trace-level logging
RUST_LOG=trace cargo run --release 2

# 11. Check for resource exhaustion
# Activity Monitor (macOS) / Task Manager (Windows)

# 12. Test on different computer
# (isolates hardware vs software issues)
</code></pre>
<h2 id="performance-profiling"><a class="header" href="#performance-profiling">Performance Profiling</a></h2>
<h3 id="response-time-analysis"><a class="header" href="#response-time-analysis">Response Time Analysis</a></h3>
<pre><code class="language-bash">DEBUG=1 cargo run --release 2 2&gt;&amp;1 | grep -E 'NoteOn|executed'
</code></pre>
<p><strong>Measure latency</strong>:</p>
<pre><code>[16:32:45.123456] NoteOn
[16:32:45.124789] Action executed (1.3ms)
</code></pre>
<p>Latency = 1.3ms (excellent, &lt;5ms is good)</p>
<h3 id="cpu-usage-monitoring"><a class="header" href="#cpu-usage-monitoring">CPU Usage Monitoring</a></h3>
<p><strong>macOS</strong>:</p>
<pre><code class="language-bash"># Monitor CPU in real-time
top | grep midimon

# Or use Activity Monitor GUI
open -a "Activity Monitor"
</code></pre>
<p><strong>Expected CPU usage</strong>:</p>
<ul>
<li>Idle: &lt;1%</li>
<li>Active (pad presses): 2-5%</li>
<li>With animated LEDs: 3-7%</li>
</ul>
<p><strong>If &gt;10%</strong>: Performance issue (check debug logging enabled)</p>
<h3 id="memory-usage"><a class="header" href="#memory-usage">Memory Usage</a></h3>
<pre><code class="language-bash"># macOS
ps aux | grep midimon

# Expected RSS: 5-10 MB
</code></pre>
<p><strong>If &gt;50MB</strong>: Memory leak (file a bug report)</p>
<h2 id="logs-and-diagnostics-output"><a class="header" href="#logs-and-diagnostics-output">Logs and Diagnostics Output</a></h2>
<h3 id="redirecting-output"><a class="header" href="#redirecting-output">Redirecting Output</a></h3>
<p><strong>Save all output</strong>:</p>
<pre><code class="language-bash">cargo run --release 2 &gt; midimon.log 2&gt;&amp;1
</code></pre>
<p><strong>Save only errors</strong>:</p>
<pre><code class="language-bash">cargo run --release 2 2&gt; midimon.err
</code></pre>
<p><strong>Separate stdout and stderr</strong>:</p>
<pre><code class="language-bash">cargo run --release 2 &gt; midimon.out 2&gt; midimon.err
</code></pre>
<h3 id="analyzing-logs"><a class="header" href="#analyzing-logs">Analyzing Logs</a></h3>
<p><strong>Count events</strong>:</p>
<pre><code class="language-bash">grep -c "NoteOn" midimon.log
</code></pre>
<p><strong>Find errors</strong>:</p>
<pre><code class="language-bash">grep -i error midimon.log
grep -i failed midimon.log
</code></pre>
<p><strong>Extract timings</strong>:</p>
<pre><code class="language-bash">grep "Action executed" midimon.log | sed 's/.*(\(.*\)ms).*/\1/'
</code></pre>
<h2 id="see-also-10"><a class="header" href="#see-also-10">See Also</a></h2>
<ul>
<li><a href="troubleshooting/common-issues.html">Common Issues</a> - Quick solutions to frequent problems</li>
<li><a href="troubleshooting/../reference/cli-commands.html">CLI Commands</a> - Complete command reference</li>
<li><a href="troubleshooting/../configuration/overview.html">Configuration Overview</a> - Config syntax validation</li>
</ul>
<hr />
<p><strong>Last Updated</strong>: November 11, 2025
<strong>Diagnostic Tool Version</strong>: 0.1.0</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="performance-3"><a class="header" href="#performance-3">Performance</a></h1>
<blockquote>
<p><strong>Note</strong>: This section is under development and will be completed in Phase 1 (Q1 2025).</p>
<p>For now, please refer to:</p>
<ul>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/blob/main/CLAUDE.md">CLAUDE.md</a></li>
<li><a href="https://github.com/amiable-dev/midimon/discussions">GitHub Discussions</a></li>
</ul>
</blockquote>
<h2 id="coming-soon-16"><a class="header" href="#coming-soon-16">Coming Soon</a></h2>
<p>This page will cover:</p>
<ul>
<li>TBD</li>
</ul>
<hr />
<p><strong>Help Wanted</strong>: We're looking for contributors to help write documentation. See <a href="troubleshooting/../development/contributing.html">Contributing Guide</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="changelog"><a class="header" href="#changelog">Changelog</a></h1>
<p>See the main <a href="https://github.com/amiable-dev/midimon/blob/main/CHANGELOG.md">CHANGELOG.md</a> in the repository.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="roadmap"><a class="header" href="#roadmap">Roadmap</a></h1>
<p>See the main <a href="https://github.com/amiable-dev/midimon/blob/main/ROADMAP.md">ROADMAP.md</a> in the repository.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="community-1"><a class="header" href="#community-1">Community</a></h1>
<p>Join the MIDIMon community:</p>
<ul>
<li><strong>GitHub Discussions</strong>: <a href="https://github.com/amiable-dev/midimon/discussions">https://github.com/amiable-dev/midimon/discussions</a></li>
<li><strong>Issues</strong>: <a href="https://github.com/amiable-dev/midimon/issues">https://github.com/amiable-dev/midimon/issues</a></li>
<li><strong>Discord</strong>: Coming soon!</li>
</ul>
<p>See <a href="https://github.com/amiable-dev/midimon/blob/main/GOVERNANCE.md">GOVERNANCE.md</a> for community structure.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="support-1"><a class="header" href="#support-1">Support</a></h1>
<p>See the main <a href="https://github.com/amiable-dev/midimon/blob/main/SUPPORT.md">SUPPORT.md</a> for getting help.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
